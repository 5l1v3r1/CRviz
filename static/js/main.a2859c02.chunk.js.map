{"version":3,"sources":["features/header/Header.module.css","features/drag-drop-utils/AvailableFieldList.module.css","features/comparison-selector/ComparisonSelector.module.css","features/search/SearchControls.module.css","domain/controls.js","features/header/crlogo.png","features/visualization/Visualization.module.css","features/dataset-controls/DatasetControls.module.css","epics/upload-dataset-epic.js","features/header/Header.js","features/drag-drop-utils/SelectedField.js","features/drag-drop-utils/SelectedFieldList.js","features/drag-drop-utils/AvailableField.js","features/drag-drop-utils/AvailableFieldList.js","features/drag-drop-utils/DropTarget.js","features/hierarchy-selector/HierarchySelector.js","epics/diff-dataset-epic.js","features/comparison-selector/ComparisonSelector.js","features/misc-controls/FieldSelect.js","features/misc-controls/MiscControls.js","epics/search-dataset-epic.js","features/search/SearchControls.js","features/visualization/d3-viz/pack-grid.js","features/visualization/d3-viz/pack-with-label.js","features/visualization/d3-viz/to-hierarchy.js","features/visualization/d3-viz/datum-key.js","features/visualization/d3-viz/class-name.js","features/visualization/d3-viz/append-circles.js","features/visualization/d3-viz/setup-zoom.js","features/visualization/d3-viz/setup-tooltip.js","features/visualization/d3-viz/color-scheme.js","features/visualization/d3-viz/setup-legend.js","features/visualization/d3-viz/setup-annotations.js","features/visualization/d3-viz.js","features/visualization/Visualization.js","epics/refresh-dataset-epic.js","features/dataset-controls/DatasetSelector.js","features/dataset-controls/DatasetUpload.js","features/dataset-controls/DatasetDownload.js","features/dataset-controls/DatasetRefresh.js","features/dataset-controls/DatasetTimedRefresh.js","features/dataset-controls/export.js","features/dataset-controls/DatasetControls.js","features/slider-utils/slider-components.js","features/dataset-controls/DatasetSlider.js","App.js","registerServiceWorker.js","domain/filter.js","domain/root-reducer.js","epics/filter-dataset-epic.js","epics/root-epic.js","configure-store.js","index.js","domain/error.js","epics/index-dataset-epic.js","domain/dataset.js","App.module.css","features/misc-controls/MiscControls.module.css","epics/fetch-dataset-epic.js","features/drag-drop-utils/SelectedFieldList.module.css","epics/load-dataset-epic.js"],"names":["module","exports","header","logo","appName","infoIcon","infoPopup","tagline","listContainer","draggableContainer","dragForeignContainer","isDraggingOver","field","dragForeign","groupBy","fieldName","dupeContainer","searchControls","searchContainer","search","label","setControls","createAction","setStartDataset","setEndDataset","setHierarchyConfig","showNodes","useDarkTheme","colorBy","showBusy","reducer","handleActions","_handleActions","Object","_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__","state","_ref","payload","hierarchyConfig","shouldShowNodes","darkTheme","start","end","_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__","_ref2","_ref3","_ref4","_ref5","_ref6","_ref7","_ref8","selectControls","controls","viz","delta","plus","minus","nag","fadein","dataControls","dataControlHeader","selectorContainer","uploadContainer","selector","fileUpload","utilityContainer","fileDownload","urlRefreshContainer","datasetSourceContainer","urlRefresh","urlContainer","urlRefreshTime","modal","modalMain","centerSpan","sliderContainer","sliderSelectedScale","slider","sliderScale","sliderThumb","sliderThumbMin","sliderThumbMax","slot","scaleMark","slotScale","line","lineSelected","uploadDataset","fromReader","owner","name","shortName","includeData","includeControls","file","Observable","create","observer","source","reader","window","FileReader","addEventListener","next","result","complete","error","readAsText","fromJson","content","JSON","parse","uploadDatasetEpic","action$","store","ofType","toString","pipe","mergeMap","action","debounceTime","map","CSVconvert","loadDataset","catchError","SyntaxError","newErr","Error","of","setError","Header","showInfo","hideTooltip","_this","setState","showTooltip","react_default","a","createElement","className","style","href","target","rel","src","alt","id","onMouseEnter","this","onMouseLeave","index_es","icon","faInfoCircle","react_portal_tooltip_lib_default","active","position","parent","tooltipTimeout","process","React","Component","Field","_classNames","initialItemText","subsequentItemText","displayName","dragIndex","animated","provided","assign","draggable","ref","innerRef","draggableProps","dragHandleProps","classNames","defineProperty","placeholder","SelectedField","_ref$count","count","index","draggableId","react_beautiful_dnd_esm","type","snapshot","SelectedFieldList","lastFields","toAnimate","props","fields","_this2","_this$props","values","getFieldId","droppableId","dragState","draggingOver","droppableProps","droppable","List","destination","length","differenceWith","eqBy","findIndex","isEmpty","drag_drop_utils_SelectedField","key","isNil","path","from","to","Math","min","max","defaultProps","AvailableField","objectSpread","transform","isDragging","AvailableFieldList","isDraggingForeign","sortBy","getCount","drag_drop_utils_AvailableField","concat","withPlaceholder","faTrashAlt","curry","contains","DropTarget","isDropDisabled","_classNames2","dropTarget","SELECTED_FIELD_LIST_ID","DROP_TARGET_ID","HierarchySelector","onDragStart","dragStart","onDragUpdate","dragUpdate","onDragEnd","dropResult","updateHierarchy","removeField","fieldId","newIndex","configuration","findFieldIndex","find","removeOld","identity","remove","addNew","insert","updatedHierarchy","compose","availableFields","filter","f","groupable","marginBottom","drag_drop_utils_SelectedFieldList","selectedFieldListStyle","drag_drop_utils_DropTarget","drag_drop_utils_AvailableFieldList","availableFieldListStyle","list","matchId","equals","mapDispatchToProps","connect","selectMergedConfiguration","selectMergedValues","generateDiff","startOwner","startDs","dataset","endOwner","endDs","diffs","added","changed","removed","ei","si","CRVIZ","i","differences","diffDatasetEpic","switchMap","setDatasetDiff","KEY_FIELD_LIST_ID","IGNORED_FIELD_LIST_ID","KEY_TARGET_ID","IGNORED_TARGET_ID","ComparisonSelector","showDupeTooltip","updateKeyFields","keyFields","updateIgnoreFields","ignoredFields","getUpdatedFields","fieldsToUpdate","updatedKeys","setKeyFields","updateDiff","updatedIgnored","setIgnoredFields","keyIndex","ignoredIndex","toDiff","startUuid","endUuid","ignore","diffDataset","hideDupeTooltip","keyInfo","hasDupes","reduce","total","current","duplicateCount","usedFields","faDumpsterFire","color","ki","ownProps","datasets","selectDatasets","keys","keyCount","isNaN","uniqueKeyCount","getKeyFields","getIgnoredFields","fieldToString","join","prop","stringToField","string","split","propEq","FieldSelect","value","onChange","evt","dispatch","container","checkboxContainer","switch","checked","htmlFor","switchLabel","fieldSelect","misc_controls_FieldSelect","searchDataset","performSearch","data","results","toFind","queryString","indices","searchIndices","hash","idxResults","toLowerCase","temp","Set","toConsumableArray","forEach","ds","el","_isSearchResult","r","res","push","searchDatasetEpic","tap","setSearchResults","is","QueryParseError","defaultState","hasSearch","Search","handleQueryStringChange","e","handleKeyPress","handleSearch","onKeyPress","onClick","title","faSearch","clearSearch","faTimesCircle","getSearchIndices","getSearchResults","eachWithIndex","addIndex","placeRows","rows","middleOut","maxRadii","maxRadius","ys","coordinatesForRadii","xs","row","node","j","x","y","apply","c","radii","diameters","first","add","coords","slicedToArray","lastRadius","currentRadius","last","aperture","above","reject","_","below","pickOdd","reverse","toRows","circles","splitEvery","ceil","sqrt","packGrid","enclosingCircle","packEnclose","radiusLeaf","radius","children","getLabelSize","labelRatio","packChildren","packSiblings","maxLabelRatio","padding","k","nonleafChildren","child","height","labelSize","paddingSize","enclosingRadius","translateChild","labelY","labelWidth","pow","packWithLabel","options","size","pack","root","eachBefore","eachAfter","d","arguments","undefined","nestHierarchy","nest","countSearchResults","_searchResultCount","countAdded","_addedCount","_isAdded","countChanged","_changedCount","_isChanged","countRemoved","_removedCount","_isRemoved","entriesToHierarchy","fieldValue","entries","group","chain","getLeaves","_containsGroups","entry","head","tail","prev","containsGroups","toHierarchy","nesting","d3Hierarchy","datumKey","datum","depth","uid","getLabelShape","top","startAngle","PI","acos","endAngle","shape","arc","closePath","scaleAndTrimToLabelWidth","initialFontScale","maxTextWidth","arcAngle","sin","getLabelWidth","maxTextHeight","boxHeight","getBBox","width","fontScale","labelText","heightScale","abs","select","nodes","text","lengthToTrimTo","trunc","substr","attr","appendCircles","nodeRoot","packedData","labelRoot","descendants","leaves","selectAll","exit","nodesEnter","enter","append","classed","merge","order","newLabelGroups","newLabelShapes","newLabels","each","newAggregations","newTotalText","aggregations","hideSmall","tooSmall","viewBound","boundWidth","boundHeight","nodeBound","boundOverlap","bound0","bound1","setupZoom","zoomRoot","transformRoot","zoomTo","zoomToTransform","zoomTransform","zoomBehavior","zoom","on","event","d3Event","call","viewPadding","rootR","rootX","rootY","scaleExtent","translateExtent","floor","bound","animate","zoomIdentity","scale","translate","transition","duration","offsetTop","offsetLeft","tooltip","innerHTML","cont","pairs","setupTooltip","boundingRect","getBoundingClientRect","left","colorScheme","extendColorScheme","extraLayers","extraColors","times","currentLayer","previous","hcl","neighbor","hScale","scaleLinear","domain","range","h","cScale","scalePow","exponent","lScale","l","updateLegend","legend","colorMap","toggleValue","items","toPairs","itemsEnter","disabled","_ref9","_ref11","createStylesheet","coloring","styleEnter","html","_ref13","_ref14","_ref14$","colorNodes","_ref15","getValue","coloredField","isColoringGroup","_ref16","_ref18","colorAnnotations","_ref19","annotations","_ref20","setupLegend","legendConfig","update","either","uniq","configs","zip","fromPairs","memoizeKey","angle","baseAngle","getEdgePositionX","memoizeWith","cos","getEdgePositionY","setupAnnotations","annotationRoot","leafRadius","annotationsEnter","newChangeIcon","annotation","newRingMenu","newBgCircles","newX","newTotalContainer","dk","glyph","showHide","ancestors","item","empty","newAddedContainer","childGlyphs","newAddedText","newChangedContainer","newChangedText","newRemovedContainer","newRemovedText","allEqProps","o1","o2","allPass","eqProps","makeHierarchy","sort","composeComparators","b","localeCompare","comparators","reduceWhile","comparator","findAncestor","hierarchy","findChild","reduced","d3Viz","rootNode","svg","clientWidth","clientHeight","labels","countLabels","selectedNode","nextProps","dataUpdated","sizeUpdated","legendUpdated","repack","resetAnnotations","rerender","resetLegend","resetZoom","ResizeSensor","debounce","_appendCircles","selected","zoomToNode","Visualization","ReactDOM","findDOMNode","updateFromProps","styles","PureComponent","selectDatasetIntersection","startUid","endUid","getQueryString","startRefresh","stopRefresh","refreshDatasetEpic","url","interval","timer","setIsFetching","isFetching","fetchDataset","takeUntil","eqUrl","DatasetSelector","DatasetUpload","inputId","ownerUuid","display","files","faUpload","DatasetDownload","download","faDownload","DatasetRefresh","faRedoAlt","DatasetTimedRefresh","timerIsRunning","onIntervalChange","onStartClick","onStopClick","faSyncAlt","faStopCircle","getDataToExport","exportData","sanitizeForExport","clonedeep","uuidv4","require","CUSTOM_DATASET","UPLOAD_DATASET","authTypes","scheme","host","location","hostname","port","indexOf","String","parseInt","POSEIDON_DATASET","Modal","setAppElement","DatasetControls","classCallCheck","possibleConstructorReturn","getPrototypeOf","resetDataset","setDataset","uuid","selectedFile","fetchAndSetDataset","username","password","token","authHeader","buildAuthHeader","toURL","onSelected","removeDataset","removeSearchIndex","showUrlEntry","showUpload","authScheme","refreshInterval","refreshTimerRunning","setStartOrEnd","onUpload","onUrlChange","onTokenChange","onUsernameChange","onPasswordChange","onUrlOk","onUrlCancel","onUploadOk","onUploadCancel","getDownloadUrl","fullDatasets","urlObject","URL","webkitURL","json","stringify","blob","Blob","createObjectURL","onRefresh","onTimedRefreshStart","onTimedRefreshStop","removeDatasetEntry","onTimedRefreshIntervalChanged","numInt","canDownload","canRefresh","err","TypeError","removable","faMinusCircle","dataset_controls_DatasetSelector","dataset_controls_DatasetDownload","dataset_controls_DatasetRefresh","dataset_controls_DatasetTimedRefresh","faCog","lastUpdated","toLocaleDateString","toLocaleTimeString","lib_default","isOpen","onRequestClose","contentLabel","at","Token","userName","faCheck","faTimes","dataset_controls_DatasetUpload","configHasChanged","Date","selectDataset","getIsFetching","getLastUpdated","railOuterStyle","borderRadius","cursor","railInnerStyle","pointerEvents","backgroundColor","SliderRail","getRailProps","react","Handle","_ref2$domain","_ref2$handle","handle","percent","getHandleProps","WebkitTapHighlightColor","zIndex","role","aria-valuemin","aria-valuemax","aria-valuenow","boxShadow","Track","getTrackProps","Tick","tick","format","marginTop","fontSize","textAlign","marginLeft","DatasetSlider","labelMode","onDragEnter","preventDefault","onDragOver","dataTransfer","setData","onDrop","getData","Number","points","setStartUuid","setEndUuid","onSlotClick","onHandleClick","onUpdate","formatTicks","t","defaultValues","p","margin","react_compound_slider_es","mode","step","rootStyle","handles","right","tracks","ticks","IMPORT","EXPORT","defaultOptions","App","showData","showGrouping","showFiltering","uuids","datasetAdded","showOptions","exportName","componentWillReceiveProps","uniqueUuids","getUniqueDatasetList","u","uuidsFromState","uuidsFromProps","uniqueOwners","has","toggleShowData","showComparison","toggleShowComparison","toggleShowGrouping","toggleShowFiltering","onErrorClose","clearError","resetControls","showImportOptions","showExportOptions","setOptions","processOptions","exportNameChange","cancelOptions","addDatasetEntry","newItem","includes","newUuids","splice","_classNames3","_classNames4","_classNames5","_classNames6","_classNames7","_classNames8","_classNames9","_classNames10","_classNames11","datasetCount","hasDataset","appContainer","hideControls","header_Header","faHome","accordionHeader","faAngleDoubleDown","faAngleDoubleUp","section","hidden","dataset_controls_DatasetControls","faPlus","SearchControls","hierarchySection","hierarchy_selector_HierarchySelector","misc_controls_MiscControls","dimSection","comparison_selector_ComparisonSelector","footerContainer","faFileImport","faFileExport","emptyDataset","canvas","visualization_Visualization","cx","cy","dataset_controls_DatasetSlider","justifySpan","faDizzy","message","activityIndicatorContainer","react_spinners","sizeUnit","loading","shouldShowBusy","getError","isLocalhost","Boolean","match","registerValidSW","swUrl","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","console","log","catch","setFilter","clearFilter","filterString","isValid","compileExpression","combineReducers","filterDataset","applyFilter","filtered","filterDatasetEpic","setFilteredDataset","rootEpic","combineEpics","loadDatasetEpic","fetchDatasetEpic","indexDatasetEpic","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","initialState","middleware","createEpicMiddleware","createStore","rootReducer","applyMiddleware","run","configureStore","render","es","src_App","document","getElementById","origin","fetch","response","status","headers","get","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker","lunr","buildIndices","searchResults","searchReducer","_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_0__","rsowner","hasOwnProperty","generateIndex","configurationFor","flat","cfg","flattened","CRVIZ_SEARCH_KEY","getValueByPath","flattenDataset","idx","object","buildIndicesSuccess","defaultItemState","hashFields","getHashFields","allFields","applyHashes","obj","hashKey","addHashKey","Array","isArray","addHashWithoutIgnored","searchKey","addSearchKey","_HASH_KEY","uniqueKeys","fieldsFor","overrides","paths","pathsIn","_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_3__","override","_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_2__","configureDataset","initialConfig","_applyHashes","valuesFor","setDatasets","removeFilteredDataset","removeDatasetDiff","_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__","newDiff","_ref10","_selectDatasets","_applyHashes2","_ref12","_selectMergedConfiguration","_applyHashes3","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","done","some","return","vals","v","valSet","_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__","s","_HASH_WITHOUT_IGNORED","switch-inner","Buffer","__webpack_require__","__webpack_exports__","redux_actions__WEBPACK_IMPORTED_MODULE_0__","redux_observable__WEBPACK_IMPORTED_MODULE_1__","rxjs__WEBPACK_IMPORTED_MODULE_2__","rxjs_ajax__WEBPACK_IMPORTED_MODULE_3__","rxjs_operators__WEBPACK_IMPORTED_MODULE_4__","rxjs_operators__WEBPACK_IMPORTED_MODULE_5__","rxjs_operators__WEBPACK_IMPORTED_MODULE_6__","rxjs_operators__WEBPACK_IMPORTED_MODULE_7__","domain_error__WEBPACK_IMPORTED_MODULE_8__","_load_dataset_epic__WEBPACK_IMPORTED_MODULE_9__","getScheme","Authorization","ajax","rxAjax","crossDomain","responseType","groupByEnter","dragHandle","rxjs_operators__WEBPACK_IMPORTED_MODULE_3__","ramda__WEBPACK_IMPORTED_MODULE_6__","ramda__WEBPACK_IMPORTED_MODULE_7__","_index_dataset_epic__WEBPACK_IMPORTED_MODULE_8__","domain_error__WEBPACK_IMPORTED_MODULE_9__","domain_dataset__WEBPACK_IMPORTED_MODULE_10__","domain_controls__WEBPACK_IMPORTED_MODULE_11__","lines","trim","delimiter","hdr","delims","delim","finddelim","jsonstring","colnames","formatPayload","initialName","initialShortName","final","ValidationError","prototype"],"mappings":"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","file":"static/js/main.a2859c02.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"Header_header__15j4c\",\"logo\":\"Header_logo__1XArl\",\"appName\":\"Header_appName__2Yv_S\",\"infoIcon\":\"Header_infoIcon__39h1E\",\"infoPopup\":\"Header_infoPopup__1SjWm\",\"tagline\":\"Header_tagline__3GO5z\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"listContainer\":\"AvailableFieldList_listContainer__36HdH\",\"draggableContainer\":\"AvailableFieldList_draggableContainer__1jpWJ\",\"dragForeignContainer\":\"AvailableFieldList_dragForeignContainer__qUoBZ\",\"isDraggingOver\":\"AvailableFieldList_isDraggingOver__jXTLo\",\"field\":\"AvailableFieldList_field__1IO-f\",\"dragForeign\":\"AvailableFieldList_dragForeign__1vOCf\",\"groupBy\":\"AvailableFieldList_groupBy__1kSPM\",\"fieldName\":\"AvailableFieldList_fieldName__33I5k\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"infoPopup\":\"ComparisonSelector_infoPopup__240Ac\",\"dupeContainer\":\"ComparisonSelector_dupeContainer__3C0-X\",\"infoIcon\":\"ComparisonSelector_infoIcon__3NchJ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"searchControls\":\"SearchControls_searchControls__380ec\",\"searchContainer\":\"SearchControls_searchContainer__3RTnY\",\"search\":\"SearchControls_search__3qDXJ\",\"label\":\"SearchControls_label__71Clh\"};","import { createAction, handleActions } from \"redux-actions\";\n\nconst defaultState = {\n  hierarchyConfig: [], // Array of fields to group by.\n  shouldShowNodes: true, // Whether to show individual nodes\n  darkTheme: false, // Whether to use dark theme\n  colorBy: null, // The field for which to color the devices/groupings by.\n  start: null, // The uuid of the dataset to use as the starting point for comparison\n  end: null, // The uuid of the dataset to use as the end point for comparison\n  showBusy: false, //display the activity icon\n};\n\n// ACTIONS\n\nconst setControls = createAction(\"SET_CONTROLS\");\nconst setStartDataset = createAction(\"SET_START_DATASET\");\nconst setEndDataset = createAction(\"SET_END_DATASET\");\nconst setHierarchyConfig = createAction(\"SET_HIERARCHY_CONFIG\");\nconst showNodes = createAction(\"SHOW_NODES\");\nconst useDarkTheme = createAction(\"USE_DARK_THEME\");\nconst colorBy = createAction(\"COLOR_BY\");\nconst showBusy = createAction(\"SHOW_BUSY\");\n\nconst reducer = handleActions(\n  {\n    [setControls]: (state, { payload }) =>{\n      const hierarchyConfig = payload.hierarchyConfig || state.hierarchyConfig;\n      const shouldShowNodes = ('shouldShowNodes' in payload) ? !!payload.shouldShowNodes : state.shouldShowNodes;\n      const darkTheme = ('darkTheme' in payload) ? !!payload.darkTheme : state.darkTheme;\n      const colorBy = payload.colorBy || state.colorBy;\n      const start = payload.start || state.start;\n      const end = payload.end || state.end;\n      const showBusy = ('showBusy' in payload) ? !!payload.showBusy : state.showBusy;\n      return { \n        ...state,\n        hierarchyConfig: hierarchyConfig,\n        shouldShowNodes: shouldShowNodes,\n        darkTheme: darkTheme,\n        colorBy: colorBy,\n        start: start,\n        end: end,\n        showBusy: showBusy,\n      }\n    },\n    [setStartDataset]: (state, { payload }) => ({ ...state, start: payload }),\n    [setEndDataset]: (state, { payload }) => ({ ...state, end: payload }),\n    [setHierarchyConfig]: (state, { payload }) => ({ ...state, hierarchyConfig: payload }),\n    [showNodes]: (state, { payload }) => ({ ...state, shouldShowNodes: !!payload }), // Convert payload to boolean for easier debugging\n    [useDarkTheme]: (state, { payload }) => ({ ...state, darkTheme: !!payload }), // Convert payload to boolean for easier debugging\n    [colorBy]: (state, { payload }) => ({ ...state, colorBy: payload }),\n    [showBusy]: (state, { payload }) => ({ ...state, showBusy: !!payload }),\n  },\n  defaultState\n);\n\nconst selectControls = (state) => state.controls;\n\nexport default reducer;\nexport { setControls, setHierarchyConfig, showNodes, colorBy, useDarkTheme, selectControls, setStartDataset, setEndDataset, showBusy };\n","module.exports = \"data:image/png;base64,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\"","// extracted by mini-css-extract-plugin\nmodule.exports = {\"viz\":\"Visualization_viz__3VNKp\",\"delta\":\"Visualization_delta__1VBcx\",\"plus\":\"Visualization_plus__3RYhX\",\"minus\":\"Visualization_minus__Xc-kq\",\"nag\":\"Visualization_nag__IglHw\",\"fadein\":\"Visualization_fadein__3i5Vd\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dataControls\":\"DatasetControls_dataControls__1C_oE\",\"dataControlHeader\":\"DatasetControls_dataControlHeader__M1Y_F\",\"selectorContainer\":\"DatasetControls_selectorContainer__2nmta\",\"uploadContainer\":\"DatasetControls_uploadContainer__jUCTm\",\"selector\":\"DatasetControls_selector__2We24\",\"fileUpload\":\"DatasetControls_fileUpload__Gh_NX\",\"label\":\"DatasetControls_label__erBn9\",\"utilityContainer\":\"DatasetControls_utilityContainer__3J6Cj\",\"fileDownload\":\"DatasetControls_fileDownload__2Kg7m\",\"urlRefreshContainer\":\"DatasetControls_urlRefreshContainer__3bBD3\",\"datasetSourceContainer\":\"DatasetControls_datasetSourceContainer__30ylz\",\"urlRefresh\":\"DatasetControls_urlRefresh__2CHTE\",\"urlContainer\":\"DatasetControls_urlContainer__2VTWM\",\"urlRefreshTime\":\"DatasetControls_urlRefreshTime__2xMdM\",\"modal\":\"DatasetControls_modal__jdZ5v\",\"modalMain\":\"DatasetControls_modalMain__1QrQI\",\"centerSpan\":\"DatasetControls_centerSpan__owgfw\",\"sliderContainer\":\"DatasetControls_sliderContainer__Jh2f5\",\"sliderSelectedScale\":\"DatasetControls_sliderSelectedScale__3JlNa\",\"slider\":\"DatasetControls_slider__1d372\",\"sliderScale\":\"DatasetControls_sliderScale__2amAl\",\"sliderThumb\":\"DatasetControls_sliderThumb__QDuM1\",\"sliderThumbMin\":\"DatasetControls_sliderThumbMin__vJPNc\",\"sliderThumbMax\":\"DatasetControls_sliderThumbMax__1oeoU\",\"slot\":\"DatasetControls_slot__1gnzO\",\"scaleMark\":\"DatasetControls_scaleMark__1kqtT\",\"slotScale\":\"DatasetControls_slotScale__2jOq8\",\"line\":\"DatasetControls_line__1dPZF\",\"lineSelected\":\"DatasetControls_lineSelected__2tN_e\"};","import { createAction } from \"redux-actions\";\nimport { Observable, of } from \"rxjs\";\nimport { catchError, debounceTime, mergeMap, map } from 'rxjs/operators';\n\nimport { setError } from \"domain/error\"\n\nimport { loadDataset, CSVconvert } from './load-dataset-epic';\n\n// ACTIONS\nconst uploadDataset = createAction(\"UPLOAD_DATASET\");\n\n// EPIC\nconst uploadDatasetEpic = (action$, store) => {\n  return action$\n    .ofType(uploadDataset.toString()).pipe(\n      mergeMap((action) => {\n        const owner = action.payload.owner;\n        const name = action.payload.name;\n        const shortName = action.payload.shortName;\n        const file = action.payload.file;\n        const includeData = ('includeData' in action.payload) ? action.payload.includeData : true;\n        const includeControls = ('includeControls' in action.payload) ? action.payload.includeControls: false; \n        return fromReader(owner, name, shortName, includeData, includeControls, file).pipe(\n            debounceTime(500)\n            ,map(CSVconvert)\n            ,map(fromJson)\n            ,map(loadDataset)\n            ,catchError((error) => {\n              if (error instanceof SyntaxError) {\n                const newErr = new Error(\"Invalid JSON.\");\n                return of(setError(newErr));\n              } else {\n                /* istanbul ignore next */\n                throw error;\n              }\n            })\n          )\n      })\n    );\n};\n\n/**\n * Little function to create an observable to read local files.\n * RxJS DOM v5 doesn't have it!?\n */\nconst fromReader = (owner, name, shortName, includeData, includeControls, file) => {\n  return Observable.create((observer) => {\n    const source = file.name;\n    const reader = new window.FileReader();\n\n    reader.addEventListener('load', () => {\n      observer.next({ 'owner': owner, 'name': name, 'shortName': shortName, 'source': source, 'includeData':includeData,\n                      'includeControls': includeControls, 'file': reader.result });\n      observer.complete();\n    });\n\n    reader.addEventListener('error', () => {\n      observer.error(reader.error);\n      observer.complete();\n    });\n\n    reader.readAsText(file)\n  });\n}\n\nconst fromJson = (payload) =>{\n  const owner = payload.owner;\n  const name = payload.name;\n  const shortName = payload.shortName;\n  const source = payload.source;\n  const content = JSON.parse(payload.file);\n  const includeData = ('includeData' in payload) ? payload.includeData : true;\n  const includeControls = ('includeControls' in payload) ? payload.includeControls: false;\n\n  return {\n    'owner': owner,\n    'name': name,\n    'shortName': shortName,\n    'source': source,\n    'content': content, \n    'includeData': includeData,\n    'includeControls': includeControls,\n  };\n}\n\nexport default uploadDatasetEpic;\nexport { uploadDataset, fromJson };\n","import React from 'react';\nimport ToolTip from 'react-portal-tooltip'\n\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faInfoCircle } from \"@fortawesome/free-solid-svg-icons\";\n\nimport logo from './crlogo.png';\nimport style from './Header.module.css';\n\nclass Header extends React.Component {\n\n\tstate ={\n\t\tshowInfo: false\n\t}\n\n\thideTooltip = () => {\n\t\tthis.setState({\n\t\t\tshowInfo: false\n\t\t})\n\t}\n\n\tshowTooltip = () =>  {\n\t\tthis.setState({\n\t\t\tshowInfo: true\n\t\t})\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div className={ style.header }>\n\t\t\t  <a href=\"http://www.cyberreboot.org/\" target=\"_blank\" rel=\"noopener noreferrer\">\n\t\t\t  \t<img src={ logo } className={ style.logo } alt='Cyber Reboot' />\n\t\t\t  </a>\n\t\t\t  <span className={ style.appName }>CRviz</span>\n\t\t\t  <span className={ style.infoIcon }>\n\t\t\t\t<label id=\"showInfo\" onMouseEnter={this.showTooltip} onMouseLeave={this.hideTooltip}>\n\t\t\t      <FontAwesomeIcon icon={faInfoCircle} />\n\t\t\t    </label>\n\t\t\t    <ToolTip active={this.state.showInfo} position=\"bottom\" parent=\"#showInfo\" tooltipTimeout={250}>\n\t\t\t      <div className={ style.infoPopup }>\n\t\t\t        About CRviz:<br/>\n\t\t\t        Home: <a href=\"https://www.cyberreboot.org/projects/crviz/\">https://www.cyberreboot.org/projects/crviz/</a><br/>\n\t\t\t        Version: { process.env.REACT_APP_VERSION } <br/>\n\t\t\t        Copyright © 2017-2018 IQT Labs LLC.\n\t\t\t      </div>\n\t\t\t    </ToolTip>\n\t    \t  </span>\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nexport default Header;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport { Draggable } from \"react-beautiful-dnd\";\n\nimport classNames from \"classnames\";\n\nfunction SelectedField({\n  style,\n  initialItemText,\n  subsequentItemText,\n  displayName,\n  count = 0,\n  index,\n  draggableId,\n  dragIndex,\n  animated\n}) {\n  return (\n    <Draggable draggableId={draggableId} type=\"Field\" index={index}>\n      {\n        (provided, snapshot) => {\n        return (\n          <Field\n            style={style}\n            initialItemText={initialItemText}\n            subsequentItemText={subsequentItemText}\n            displayName={displayName + \" (\" + count + \")\"}\n            dragIndex={dragIndex}\n            provided={provided}\n            animated={animated}\n          />\n        );\n      }}\n    </Draggable>\n  );\n}\n\nfunction Field({ style, initialItemText, subsequentItemText, displayName, dragIndex, animated, provided }) {\n  return (\n    <div>\n      <div\n        className={style.draggable}\n        ref={provided.innerRef}\n        {...provided.draggableProps}\n        {...provided.dragHandleProps}\n      >\n        <div className={style.field}>\n          <span\n            className={classNames({\n              [style.groupBy]: true,\n              [style.animated]: animated\n            })}\n          >\n            {dragIndex === 0 ? initialItemText : subsequentItemText}\n          </span>\n          <span className={style.fieldName}>{displayName}</span>\n        </div>\n      </div>\n\n      {provided.placeholder}\n    </div>\n  );\n}\n\nSelectedField.propTypes = {\n  style: PropTypes.shape({\n    draggable: PropTypes.string.isRequired,\n    field: PropTypes.string.isRequired,\n    groupBy: PropTypes.string.isRequired,\n    fieldName: PropTypes.string.isRequired\n  }),\n  displayName: PropTypes.string.isRequired,\n  index: PropTypes.number.isRequired,\n  draggableId: PropTypes.string.isRequired,\n  dragIndex: PropTypes.number.isRequired,\n  animated: PropTypes.bool.isRequired\n};\n\nexport default SelectedField;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { findIndex, eqBy, differenceWith, isEmpty, isNil, path } from \"ramda\";\n\nimport { Droppable } from \"react-beautiful-dnd\";\n\nimport SelectedField from \"./SelectedField\";\n\nclass SelectedFieldList extends React.Component {\n  state = {\n    lastFields: [],\n    toAnimate: null\n  };\n\n  componentDidMount() {\n    this.setState({\n      lastFields: this.props.fields\n    });\n  }\n\n  static getDerivedStateFromProps(props, state){\n    const { getFieldId } = props;\n\n    // Find newly inserted item, if any\n    let toAnimate = differenceWith(\n      eqBy(getFieldId),\n      props.fields,\n      state.lastFields\n    )[0];\n\n    if (toAnimate) {\n      // Only animate item that are not inserted at the bottom using AffordanceDroppable\n      const newIndex = findIndex(eqBy(getFieldId, toAnimate), props.fields);\n      toAnimate = newIndex < state.lastFields.length ? toAnimate : null;\n    }\n\n    return {\n      lastFields: props.fields,\n      toAnimate: toAnimate\n    };\n  }\n\n  render() {\n    const { style, initialItemText, subsequentItemText, fields, values, getFieldId, droppableId, dragState } = this.props;\n\n    const draggingOver = isDraggingOver(droppableId, dragState);\n    return (\n      <div className={style.listContainer}>\n        <Droppable droppableId={droppableId} type=\"Field\">\n          {\n            (provided, snapshot) => {\n            return (\n              <div\n                ref={provided.innerRef}\n                {...provided.droppableProps}\n                className={style.droppable}\n              >\n                <List\n                  style={style}\n                  initialItemText={initialItemText}\n                  subsequentItemText={subsequentItemText}\n                  fields={fields}\n                  values={values}\n                  getFieldId={getFieldId}\n                  droppableId={droppableId}\n                  dragState={dragState}\n                  toAnimate={this.state.toAnimate}\n                />\n\n                {draggingOver &&\n                  dragState.destination.index !== fields.length &&\n                  provided.placeholder}\n              </div>\n            );\n          }}\n        </Droppable>\n      </div>\n    );\n  }\n}\n\nfunction List({\n  fields,\n  values,\n  getFieldId,\n  style,\n  initialItemText,\n  subsequentItemText,\n  droppableId,\n  dragState,\n  toAnimate\n}) {\n  if (isEmpty(fields)) {\n    return null;\n  }\n  return fields.map((field, index) => {\n    const id = getFieldId(field);\n    const animated = toAnimate && getFieldId(field) === getFieldId(toAnimate);\n    const count = values[id].length\n    return (\n      <SelectedField\n        style={style}\n        initialItemText={initialItemText}\n        subsequentItemText={subsequentItemText}\n        draggableId={id}\n        key={id}\n        displayName={field.displayName}\n        count={count}\n        index={index}\n        dragIndex={dragIndex(droppableId, dragState, index)}\n        animated={animated || false}\n      />\n    );\n  });\n}\n\nconst isDraggingOver = (droppableId, dragState) => {\n  return (\n    !isNil(dragState) &&\n    path([\"destination\", \"droppableId\"], dragState) === droppableId\n  );\n};\n\n/**\n * Calculate the potential indices during drag based on the current dragState.\n *\n * This is used to update the groupBy label on the fly.\n */\nconst dragIndex = (droppableId, dragState, index) => {\n  if (!isDraggingOver(droppableId, dragState)) {\n    return index;\n  }\n\n  const { source, destination } = dragState;\n\n  const from = source.index;\n  const to = destination.index;\n\n  // When inserting, bump down everything below the new index\n  if (source.droppableId !== destination.droppableId) {\n    return index >= to ? index + 1 : index;\n  }\n\n  // For an item that is being dragged, the new index is the destination index.\n  if (index === from) {\n    return to;\n  }\n  // Items not between the source and destination indices are not affected\n  if (index < Math.min(from, to) || index > Math.max(from, to)) {\n    return index;\n  }\n\n  if (from < to) {\n    // If moving down, bump up everything in between\n    return index - 1;\n  } else {\n    // Otherwise, bump down everything in between\n    return index + 1;\n  }\n};\n\nSelectedFieldList.defaultProps = {\n  fields: []\n};\n\nSelectedFieldList.propTypes = {\n  fields: PropTypes.array,\n  droppableId: PropTypes.string.isRequired,\n  getFieldId: PropTypes.func.isRequired,\n\n  style: PropTypes.shape({\n    listContainer: PropTypes.string.isRequired,\n    draggable: PropTypes.string.isRequired,\n    field: PropTypes.string.isRequired,\n    groupBy: PropTypes.string.isRequired\n  })\n};\n\nexport default SelectedFieldList;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Draggable } from \"react-beautiful-dnd\";\n\nfunction AvailableField({ style, displayName, index, draggableId }) {\n  return (\n    <Draggable draggableId={draggableId} type=\"Field\" index={index}>\n      {(provided, snapshot) => {\n        return (\n          <span className={style.draggableContainer}>\n            <span\n              className={style.field}\n              ref={provided.innerRef}\n              {...provided.draggableProps}\n              {...provided.dragHandleProps}\n              style={{\n                ...provided.draggableProps.style,\n                // Disable animation of items moving out of the way when\n                // dragging. It implies the list is sortable, and it doesn't\n                // work well with multiline list anyway.\n                transform: snapshot.isDragging\n                  ? provided.draggableProps.style.transform\n                  : \"none\"\n              }}\n            >\n              {displayName}\n            </span>\n          </span>\n        );\n      }}\n    </Draggable>\n  );\n}\n\nconst StyleProps = PropTypes.shape({\n  draggableContainer: PropTypes.string.isRequired,\n  field: PropTypes.string.isRequired,\n});\n\nAvailableField.propTypes = {\n  style: StyleProps.isRequired,\n  displayName: PropTypes.string.isRequired,\n  index: PropTypes.number.isRequired,\n  draggableId: PropTypes.string.isRequired\n};\n\nexport default AvailableField;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport classNames from \"classnames\";\n\nimport { isEmpty, contains, map, sortBy, curry } from \"ramda\";\n\nimport { Droppable } from \"react-beautiful-dnd\";\n\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faTrashAlt } from \"@fortawesome/free-solid-svg-icons\";\n\nimport AvailableField from \"./AvailableField\";\n\nfunction AvailableFieldList({\n  style,\n  fields,\n  values,\n  getFieldId,\n  droppableId,\n  dragState\n}) {\n  return (\n    <Droppable droppableId={droppableId} type=\"Field\">\n      {(provided, snapshot) => {\n        const dragForeign = isDraggingForeign(dragState, fields, getFieldId);\n\n        return (\n          <div\n            className={classNames(style.listContainer, {\n              [style.dragForeign]: dragForeign,\n              [style.isDraggingOver]: snapshot.isDraggingOver\n            })}\n            ref={provided.innerRef}\n            {...provided.droppableProps}\n          >\n            {!isEmpty(fields) &&\n              sortBy(getCount(getFieldId, values), fields).map((field, index) => {\n                const id = getFieldId(field);\n                const count = values[id].length || 0;\n                return (\n                  <AvailableField\n                    style={style}\n                    key={id}\n                    draggableId={id}\n                    displayName={`${field.displayName} (${count})`}\n                    index={index}\n                    withPlaceholder={false}\n                  />\n                );\n              })}\n\n            {dragForeign && (\n              <div className={style.dragForeignContainer}>\n                <span>\n                  <FontAwesomeIcon icon={faTrashAlt} />\n                </span>\n              </div>\n            )}\n          </div>\n        );\n      }}\n    </Droppable>\n  );\n}\n\nconst getCount = curry((getFieldId, values, field) => {\n  return values[getFieldId(field)].length;\n});\n\nconst isDraggingForeign = (dragState, fields, getFieldId) => {\n  return (\n    dragState &&\n    dragState.draggableId &&\n    !contains(dragState.draggableId, map(getFieldId, fields))\n  );\n};\n\nAvailableFieldList.defaultProps = {\n  fields: []\n};\n\nconst StyleProps = PropTypes.shape({\n  listContainer: PropTypes.string.isRequired,\n  field: PropTypes.string.isRequired,\n  fieldName: PropTypes.string.isRequired\n});\n\nAvailableFieldList.propTypes = {\n  style: StyleProps.isRequired,\n  fields: PropTypes.array,\n  values: PropTypes.object,\n  getFieldId: PropTypes.func.isRequired,\n  droppableId: PropTypes.string.isRequired\n};\n\nexport default AvailableFieldList;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nimport classNames from \"classnames\";\nimport { Droppable } from \"react-beautiful-dnd\";\n\n/**\n * Droppable component to use as a dummy drop target next to SelectedFieldList.\n * This droppable doesn't contain any draggable.\n *\n * Note: this cannot be used nested inside SelectedFieldList, because they need\n * to accept the same type, and react-beautiful-dnd doesn't allow that.\n */\nfunction DropTarget({ style, initialItemText, subsequentItemText, droppableId, isDropDisabled, fields }) {\n  return (\n    <div\n      className={classNames({\n        [style.listContainer]: true,\n        [style.isDropDisabled]: isDropDisabled\n        })}>\n      <div className={style.draggable}>\n        <div className={style.field}>\n          <span className={style.groupBy}>\n            { fields.length === 0 ? initialItemText : subsequentItemText }\n          </span>\n\n          <Droppable\n            isDropDisabled={ isDropDisabled }\n            droppableId={droppableId}\n            type=\"Field\">\n\n            {(provided, snapshot) => {\n              return (\n                <span\n                  ref={provided.innerRef}\n                  {...provided.droppableProps}\n                  className={\n                    classNames({\n                      [style.dropTarget]: true,\n                      [style.isDraggingOver]: snapshot.isDraggingOver\n                    })}\n                >\n                    Drop attribute here\n                </span>\n              )\n            }}\n          </Droppable>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nDropTarget.propTypes = {\n  style: PropTypes.shape({\n    isDropDisabled: PropTypes.string.isRequired,\n    dropTarget: PropTypes.string.isRequired,\n    isDraggingOver: PropTypes.string.isRequired,\n\n    // The classes below should be identical to the styling of SelectedFieldList\n    // to make both layout the same.\n    listContainer: PropTypes.string.isRequired,\n    draggable: PropTypes.string.isRequired,\n    field: PropTypes.string.isRequired,\n    groupBy: PropTypes.string.isRequired,\n  }),\n\n  droppableId: PropTypes.string.isRequired,\n  isDropDisabled: PropTypes.bool.isRequired,\n  fields: PropTypes.array.isRequired\n}\n\n\nexport default DropTarget;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\n\nimport { DragDropContext} from 'react-beautiful-dnd';\n\nimport {\n  compose,\n  differenceWith,\n  eqBy,\n  equals,\n  find,\n  findIndex,\n  identity,\n  insert,\n  isEmpty,\n  isNil,\n  path,\n  remove\n} from \"ramda\";\n\nimport { selectMergedConfiguration, selectMergedValues, getFieldId } from \"domain/dataset\";\nimport { setHierarchyConfig, selectControls, showNodes } from \"domain/controls\";\n\nimport SelectedFieldList from 'features/drag-drop-utils/SelectedFieldList';\nimport AvailableFieldList from 'features/drag-drop-utils/AvailableFieldList';\nimport DropTarget from 'features/drag-drop-utils/DropTarget';\n\nimport availableFieldListStyle from 'features/drag-drop-utils/AvailableFieldList.module.css';\nimport selectedFieldListStyle from 'features/drag-drop-utils/SelectedFieldList.module.css';\n\nconst SELECTED_FIELD_LIST_ID = 'SelectedFieldList';\nconst AVAILABLE_FIELD_LIST_ID = 'AvailableFieldList';\nconst DROP_TARGET_ID = 'DropTarget';\n\nclass HierarchySelector extends React.Component {\n\n  state = {\n    dragState: null\n  }\n\n  onDragStart = (dragStart) => {\n    this.setState({\n      dragState: dragStart\n    });\n  }\n\n  onDragUpdate = (dragUpdate) => {\n    this.setState({\n      dragState: dragUpdate\n    })\n  }\n\n  onDragEnd = (dropResult) => {\n    const { draggableId, destination } = dropResult;\n    this.setState({ dragState: null })\n\n    if (destination === null) {\n      return;\n    } else if (destination.droppableId === SELECTED_FIELD_LIST_ID) {\n      this.updateHierarchy(draggableId, destination.index)\n    } else if (destination.droppableId === (DROP_TARGET_ID)) {\n      this.updateHierarchy(draggableId, this.props.controls.hierarchyConfig.length);\n    } else {\n      this.removeField(draggableId);\n    }\n  }\n\n  updateHierarchy = (fieldId, newIndex) => {\n    const { fields } = this.props.configuration;\n    const { hierarchyConfig } = this.props.controls;\n\n    const index = findFieldIndex(hierarchyConfig, fieldId);\n    if (index === newIndex) { return; }\n\n    const hasId = (id) => (field) => getFieldId(field) === id;\n    const field = find(hasId(fieldId), fields)\n\n    const removeOld = isNil(index) ? identity : remove(index, 1);\n    const addNew = insert(newIndex, field);\n    const updatedHierarchy = compose(addNew, removeOld)(hierarchyConfig)\n\n    this.props.setHierarchyConfig(updatedHierarchy)\n  }\n\n  removeField = (fieldId) => {\n    const { hierarchyConfig } = this.props.controls;\n    const { setHierarchyConfig } = this.props;\n    const index = findFieldIndex(hierarchyConfig, fieldId);\n\n    if (index !== null) {\n      setHierarchyConfig(remove(index, 1, hierarchyConfig ))\n    }\n\n    if(this.props.controls.hierarchyConfig.length === 0 ){\n      this.props.showNodes(true);\n    }\n  }\n\n  render() {\n    if (this.props.configuration === null) {\n      return null;\n    }\n\n    const hierarchyConfig = this.props.controls.hierarchyConfig;\n    if (isEmpty(this.props.configuration.fields)) {\n      return null;\n    }\n\n    const availableFields = differenceWith(\n      eqBy(getFieldId),\n      this.props.configuration.fields.filter((f) => f.groupable),\n      hierarchyConfig\n    );\n\n    const values = this.props.values;\n\n    const dragState = this.state.dragState;\n\n    return (\n      <div>\n        <DragDropContext\n          onDragStart={ this.onDragStart }\n          onDragUpdate={ this.onDragUpdate }\n          onDragEnd={ this.onDragEnd }>\n\n          <div style={{ marginBottom: '2rem' }}>\n            <SelectedFieldList\n              style={ selectedFieldListStyle }\n              initialItemText=\"Group By\"\n              subsequentItemText=\"Then By\"\n              fields={ hierarchyConfig }\n              values={ values }\n              droppableId={ SELECTED_FIELD_LIST_ID }\n              getFieldId={ getFieldId }\n              dragState={ dragState }\n            />\n\n          <DropTarget\n            style={ selectedFieldListStyle }\n            initialItemText=\"Group By\"\n            subsequentItemText=\"Then By\"\n            isDropDisabled={ path(['source', 'droppableId'], dragState) === SELECTED_FIELD_LIST_ID }\n            droppableId= { DROP_TARGET_ID }\n            fields={ this.props.controls.hierarchyConfig }\n          />\n        </div>\n\n          <AvailableFieldList\n            style={ availableFieldListStyle }\n            fields={ availableFields }\n            values={ values }\n            droppableId={ AVAILABLE_FIELD_LIST_ID }\n            getFieldId={ getFieldId }\n            dragState={ this.state.dragState }\n          />\n\n        </DragDropContext>\n      </div>\n    );\n  }\n}\n\nHierarchySelector.propTypes = {\n  configuration: PropTypes.shape({\n    fields: PropTypes.array.isRequired\n  }),\n  controls: PropTypes.shape({\n    hierarchyConfig: PropTypes.array.isRequired\n  }),\n  showNodes: PropTypes.func.isRequired\n};\n\nconst findFieldIndex = (list, fieldId) => {\n  const matchId = compose(equals(fieldId), getFieldId)\n  const index = findIndex(matchId, list)\n  return index === -1 ? null : index;\n}\n\nconst mapStateToProps = (state) => ({\n  configuration: selectMergedConfiguration(state),\n  values: selectMergedValues(state),\n  controls: selectControls(state)\n});\n\nconst mapDispatchToProps = {\n  setHierarchyConfig,\n  showNodes\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(HierarchySelector);\n","import { ofType } from 'redux-observable';\nimport { of } from \"rxjs\";\nimport { switchMap, map } from 'rxjs/operators';\n\nimport { setDatasetDiff } from \"domain/dataset\";\n\nconst DIFF_DATASET = \"DIFF_DATASET\";\n\nconst diffDataset = (payload) => ({'type': DIFF_DATASET, 'payload': payload })\n\nconst diffDatasetEpic = (action$, store) => {\n  return action$.pipe(\n      ofType(DIFF_DATASET)\n      ,switchMap(({ payload }) => {\n        return of(payload).pipe(\n        \tmap(generateDiff)\n          ,map((payload) =>\n            setDatasetDiff(payload)\n          )\n        );\n      })\n    );\n};\n\n\nconst generateDiff = (payload) => {\n  const startOwner = payload.start.owner;\n  const startDs = payload.start.dataset;\n  const endOwner = payload.end.owner;\n  const endDs = payload.end.dataset;\n\n  let diffs = {\n  \tadded: [],\n  \tchanged:[],\n  \tremoved:[]\n  };\n  diffs.added = diffs.added.concat(endDs.filter(ei => startDs.findIndex(si => si.CRVIZ[\"_HASH_KEY\"] === ei.CRVIZ[\"_HASH_KEY\"]) === -1).map(i => i.CRVIZ[\"_HASH_KEY\"]));\n  diffs.removed = diffs.removed.concat(startDs.filter(si => endDs.findIndex(ei => ei.CRVIZ[\"_HASH_KEY\"] === si.CRVIZ[\"_HASH_KEY\"]) === -1).map(i => i.CRVIZ[\"_HASH_KEY\"]));\n\n  diffs.changed = diffs.changed.concat(\n  \tendDs.filter(\n  \t\tei => startDs.findIndex(\n  \t\t\tsi => si.CRVIZ[\"_HASH_KEY\"] === ei.CRVIZ[\"_HASH_KEY\"] &&\n  \t\t\t\t\t\tsi.CRVIZ[\"_HASH_WITHOUT_IGNORED\"] !== ei.CRVIZ[\"_HASH_WITHOUT_IGNORED\"]\n  \t\t) !== -1\n  \t).map(i => i.CRVIZ[\"_HASH_KEY\"])\n  );\n\n  //console.log(\"diffs to return: %o\", diffs);\n  const result = {\n  \t'start': startOwner,\n  \t'end': endOwner,\n  \t'differences': diffs\n  }\n  return result;\n};\n\nexport default diffDatasetEpic;\n\nexport { diffDataset };","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\n\nimport { DragDropContext} from 'react-beautiful-dnd';\nimport ToolTip from 'react-portal-tooltip'\nimport {\n  compose,\n  differenceWith,\n  eqBy,\n  equals,\n  find,\n  findIndex,\n  identity,\n  insert,\n  isEmpty,\n  isNil,\n  path,\n  remove\n} from \"ramda\";\n\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faDumpsterFire } from \"@fortawesome/free-solid-svg-icons\";\n\nimport { \n  selectMergedConfiguration, selectMergedValues, getFieldId, selectDatasets,\n  setKeyFields, getKeyFields, setIgnoredFields, getIgnoredFields\n} from \"domain/dataset\";\nimport { diffDataset } from \"epics/diff-dataset-epic\";\n\nimport SelectedFieldList from 'features/drag-drop-utils/SelectedFieldList';\nimport AvailableFieldList from 'features/drag-drop-utils/AvailableFieldList';\nimport DropTarget from 'features/drag-drop-utils/DropTarget';\n\nimport availableFieldListStyle from 'features/drag-drop-utils/AvailableFieldList.module.css';\nimport selectedFieldListStyle from 'features/drag-drop-utils/SelectedFieldList.module.css';\nimport style from './ComparisonSelector.module.css';\n\nconst KEY_FIELD_LIST_ID = 'KeyFieldList';\nconst IGNORED_FIELD_LIST_ID = 'IgnoredFieldList';\nconst AVAILABLE_FIELD_LIST_ID = 'AvailableFieldList';\nconst KEY_TARGET_ID = 'KeyTarget';\nconst IGNORED_TARGET_ID = 'IgnoredTarget';\n\nclass ComparisonSelector extends React.Component {\n\n  state = {\n    dragState: null,\n    showDupeTooltip: false\n  }\n\n  onDragStart = (dragStart) => {\n    this.setState({\n      dragState: dragStart\n    });\n  }\n\n  onDragUpdate = (dragUpdate) => {\n    this.setState({\n      dragState: dragUpdate\n    })\n  }\n\n  onDragEnd = (dropResult) => {\n    const { draggableId, destination } = dropResult;\n    this.setState({ dragState: null })\n\n    if (destination === null) {\n      return;\n    } else if (destination.droppableId === KEY_FIELD_LIST_ID) {\n      this.updateKeyFields(draggableId, destination.index)\n    } else if (destination.droppableId === (KEY_TARGET_ID)) {\n      this.updateKeyFields(draggableId, this.props.keyFields.length);\n    } else if (destination.droppableId === IGNORED_FIELD_LIST_ID) {\n      this.updateIgnoreFields(draggableId, destination.index)\n    } else if (destination.droppableId === (IGNORED_TARGET_ID)) {\n      this.updateIgnoreFields(draggableId, this.props.ignoredFields.length);\n    } else {\n      this.removeField(draggableId);\n    }\n  }\n\n  getUpdatedFields = (fieldId, newIndex, fieldsToUpdate) =>{\n  \tconst { fields } = this.props.configuration;\n\n  \tconst index = findFieldIndex(fieldsToUpdate, fieldId);\n    if (index === newIndex) { return; }\n\n    const hasId = (id) => (field) => getFieldId(field) === id;\n    const field = find(hasId(fieldId), fields)\n\n    const removeOld = isNil(index) ? identity : remove(index, 1);\n    const addNew = insert(newIndex, field);\n    const updatedFields = compose(addNew, removeOld)(fieldsToUpdate);\n\n    return updatedFields;\n  }\n\n  updateKeyFields = (fieldId, newIndex) =>{\n    const keyFields = this.props.keyFields;\n    const ignoredFields = this.props.ignoredFields;\n\n    const updatedKeys = this.getUpdatedFields(fieldId, newIndex, keyFields);\n    \n    if(updatedKeys){\n    \tthis.props.setKeyFields(updatedKeys);\n      this.updateDiff(updatedKeys, ignoredFields);\n    }\n  }\n\n  updateIgnoreFields = (fieldId, newIndex) =>{\n    const keyFields = this.props.keyFields;\n    const ignoredFields = this.props.ignoredFields;\n\n    const updatedIgnored = this.getUpdatedFields(fieldId, newIndex, ignoredFields);\n\n    if(updatedIgnored){\n    \tthis.props.setIgnoredFields(updatedIgnored);\n      this.updateDiff(keyFields, updatedIgnored);\n\t  }\n  }\n\n  removeField = (fieldId) => {\n    const keyFields = this.props.keyFields;\n    const keyIndex = findFieldIndex(keyFields, fieldId);\n\n    const ignoredFields = this.props.ignoredFields;\n    const ignoredIndex = findFieldIndex(ignoredFields, fieldId);\n\n    let updatedKeys = null;\n    let updatedIgnored = null;\n\n    if (keyIndex !== null) {\n      updatedKeys = remove(keyIndex, 1, keyFields );\n      this.props.setKeyFields(updatedKeys);\n    }\n\n    if (ignoredIndex !== null) {\n      updatedIgnored = remove(ignoredIndex, 1, ignoredFields );\n      this.props.setIgnoredFields(updatedIgnored);      \n    }\n\n    if(updatedKeys || updatedIgnored){\n      this.updateDiff(updatedKeys || keyFields, updatedIgnored || ignoredFields);\n    }\n  }\n\n  updateDiff = (keyFields, ignoredFields) => {\n    if(this.props.start && this.props.end){\n      const toDiff ={\n        'start': {\n          'owner': this.props.startUuid,\n          'dataset': this.props.start\n        },\n        'end':{\n          'owner': this.props.endUuid,\n          'dataset': this.props.end\n        },\n        'configuration': this.props.configuration,\n        'key': keyFields,\n        'ignore': ignoredFields,\n      }\n\n      this.props.diffDataset(toDiff);\n    }\n  }\n\n  showDupeTooltip = () => {\n    this.setState({\n      showDupeTooltip: true\n    })\n  }\n\n  hideDupeTooltip = () => {\n    this.setState({\n      showDupeTooltip: false\n    })\n  }\n\n  render() {\n    if (this.props.configuration === null) {\n      return null;\n    }\n    const keyInfo = this.props.keyInfo;\n    const hasDupes = keyInfo.reduce((total, current) => total + current.duplicateCount, 0);\n    const keyFields = this.props.keyFields;\n    const ignoredFields = this.props.ignoredFields;\n    const usedFields = keyFields ? keyFields.concat(ignoredFields) : [];\n\n    if (isEmpty(this.props.configuration.fields)) {\n      return null;\n    }\n\n    const availableFields = differenceWith(\n      eqBy(getFieldId),\n      this.props.configuration.fields.filter((f) => f.groupable),\n      usedFields\n    );\n\n    const values = this.props.values;\n\n    const dragState = this.state.dragState;\n\n    return (\n      <div>\n        <div className={style.dupeContainer}>\n          {!!hasDupes &&\n            <span className={ style.infoIcon }>\n              <div id=\"showDupeInfo\" onMouseEnter={this.showDupeTooltip} onMouseLeave={this.hideDupeTooltip}>\n                <FontAwesomeIcon icon={faDumpsterFire} color=\"#cc0000\" />\n              </div>\n              <ToolTip active={this.state.showDupeTooltip} position=\"bottom\" parent=\"#showDupeInfo\" tooltipTimeout={250}>\n                <div className={ style.infoPopup }>\n                  Keying on the selected field(s) results in duplicate keys.<br/>\n                  {keyInfo.map( (ki) => {\n                    return(\n                      <div>\n                        <strong>{ki.name} </strong> &mdash; {ki.duplicateCount} duplicates <br/>\n                      </div>\n                      );\n                  })}\n                  This may lead to inaccurate change data being shown. Please\n                  verify your key and underlying data. \n                </div>\n              </ToolTip>\n            </span>\n          }\n        </div>\n        <DragDropContext\n          onDragStart={ this.onDragStart }\n          onDragUpdate={ this.onDragUpdate }\n          onDragEnd={ this.onDragEnd }>\n\n          <div style={{ marginBottom: '2rem' }}>\n          \n            <SelectedFieldList\n              style={ selectedFieldListStyle }\n              initialItemText=\"Key On\"\n              subsequentItemText=\"And\"\n              fields={ keyFields }\n              values={ values }\n              droppableId={ KEY_FIELD_LIST_ID }\n              getFieldId={ getFieldId }\n              dragState={ dragState }\n            />\n\n          <DropTarget\n            style={ selectedFieldListStyle }\n            initialItemText=\"Key On\"\n              subsequentItemText=\"And\"\n            isDropDisabled={ path(['source', 'droppableId'], dragState) === KEY_FIELD_LIST_ID }\n            droppableId= { KEY_TARGET_ID }\n            fields={ this.props.keyFields }\n          />\n        </div>\n\n        <div style={{ marginBottom: '2rem' }}>\n            <SelectedFieldList\n              style={ selectedFieldListStyle }\n              initialItemText=\"Ignore\"\n              subsequentItemText=\"And\"\n              fields={ ignoredFields }\n              values={ values }\n              droppableId={ IGNORED_FIELD_LIST_ID }\n              getFieldId={ getFieldId }\n              dragState={ dragState }\n            />\n\n          <DropTarget\n            style={ selectedFieldListStyle }\n            initialItemText=\"Ignore\"\n            subsequentItemText=\"And\"\n            isDropDisabled={ path(['source', 'droppableId'], dragState) === IGNORED_FIELD_LIST_ID }\n            droppableId= { IGNORED_TARGET_ID }\n            fields={ this.props.ignoredFields }\n          />\n        </div>\n\n          <AvailableFieldList\n            style={ availableFieldListStyle }\n            fields={ availableFields }\n            values={ values }\n            droppableId={ AVAILABLE_FIELD_LIST_ID }\n            getFieldId={ getFieldId }\n            dragState={ this.state.dragState }\n          />\n\n        </DragDropContext>\n      </div>\n    );\n  }\n}\n\nComparisonSelector.propTypes = {\n  startUuid: PropTypes.string,\n  start: PropTypes.array,\n  endUuid: PropTypes.string,\n  end: PropTypes.array,\n  keyInfo: PropTypes.array.isRequired,\n  keyFields: PropTypes.array.isRequired,\n  ignoredFields: PropTypes.array.isRequired,\n  configuration: PropTypes.shape({\n    fields: PropTypes.array.isRequired\n  }),\n};\n\nconst findFieldIndex = (list, fieldId) => {\n  const matchId = compose(equals(fieldId), getFieldId)\n  const index = findIndex(matchId, list)\n  return index === -1 ? null : index;\n}\n\nconst mapStateToProps = (state, ownProps) => {\n  const datasets = selectDatasets(state);\n  const keyInfo = Object.keys(datasets).map(key => \n    ({ \n      'owner': key, \n      'name': datasets[key].name, \n      'keyCount': isNaN(datasets[key].keyCount) ? 0 : datasets[key].keyCount,\n      'uniqueKeyCount': isNaN(datasets[key].uniqueKeyCount) ? 0 : datasets[key].uniqueKeyCount,\n      'duplicateCount': isNaN(datasets[key].keyCount - datasets[key].uniqueKeyCount) ? 0 : datasets[key].keyCount - datasets[key].uniqueKeyCount }));\n\n  return{\n    start: datasets[ownProps.startUuid],\n    end: datasets[ownProps.endUuid],\n    keyInfo: keyInfo,\n    keyFields: getKeyFields(state),\n    ignoredFields: getIgnoredFields(state),\n    configuration: selectMergedConfiguration(state),\n    values: selectMergedValues(state)\n  }\n};\n\nconst mapDispatchToProps = {\n  setKeyFields,\n  setIgnoredFields,\n  diffDataset\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ComparisonSelector);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport {\n  sortBy,\n  curry,\n  compose,\n  join,\n  split,\n  find,\n  propEq,\n  prop,\n  isNil\n} from \"ramda\";\n\nfunction FieldSelect({\n  fields,\n  values,\n  getFieldId,\n  value,\n  onChange,\n  className,\n  name\n}) {\n\n  return (\n    <div className={className}>\n      <label className=\"select\">\n        <select\n          \n          name={name}\n          onChange={(evt) => onChange(stringToField(fields, evt.target.value))}\n          value={isNil(value) ? \"\" : fieldToString(value)}\n        >\n          <option value=\"\">&mdash;None&mdash;</option>\n          {sortBy(getCount(getFieldId, values), fields).map((field) => {\n            const key = getFieldId(field);\n            return (\n              <option key={key} value={key}>\n                {field.displayName} ({values[getFieldId(field)].length})\n              </option>\n            );\n          })}\n        </select>\n      </label>\n    </div>\n  );\n}\n\nconst getCount = curry((getFieldId, values, field) => {\n  return values[getFieldId(field)].length;\n});\n\nconst FieldShape = PropTypes.shape({\n  path: PropTypes.array.isRequired,\n  displayName: PropTypes.string.isRequired\n});\n\nFieldSelect.propTypes = {\n  fields: PropTypes.arrayOf(FieldShape).isRequired,\n  value: FieldShape,\n  onChange: PropTypes.func.isRequired,\n  className: PropTypes.string,\n  name: PropTypes.string\n};\n\nconst fieldToString = compose(join(\".\"), prop(\"path\"));\n\nconst stringToField = (fields, string) => {\n  const path = split(\".\", string);\n  return find(propEq(\"path\", path), fields);\n};\n\nexport default FieldSelect;\n","import React from \"react\";\nimport { connect } from \"react-redux\";\n\nimport {\n  showNodes,\n  useDarkTheme,\n  colorBy,\n  selectControls\n} from \"domain/controls\";\nimport { selectMergedConfiguration, selectMergedValues, getFieldId } from \"domain/dataset\";\n\nimport FieldSelect from \"./FieldSelect\";\n\nimport style from \"./MiscControls.module.css\";\n\nfunction MiscControls(props) {\n  const {\n  controls,\n  configuration,\n  values,\n  showNodes,\n  colorBy,\n  } = props;\n  const fields = configuration.fields.filter((f) => f.groupable);\n  const darkThemeChanged = (checked) => {\n    props.useDarkTheme(checked)\n  };\n  return (\n    <div className={style.container}>\n      <div className={`${style.checkboxContainer} input-group`}>\n        <div className={ style.switch }>\n          <input\n            type=\"checkbox\"\n            id=\"show-node-check\"\n            checked={controls.shouldShowNodes}\n            onChange={(evt) => showNodes(evt.target.checked)}\n          />\n          <label htmlFor=\"show-node-check\" className={ style.switchLabel }>\n          </label>\n        </div>\n        <label >Show nodes</label>\n      </div>\n\n      <div className={`${style.checkboxContainer} input-group`}>\n        <div className={ style.switch }>\n          <input\n            type=\"checkbox\"\n            id=\"dark-theme-check\"\n            checked={controls.darkTheme}\n            onChange={(evt) => darkThemeChanged(evt.target.checked)}\n          />\n          <label htmlFor=\"dark-theme-check\" className={ style.switchLabel }> \n          </label>\n        </div>\n        <label>Use dark theme</label>\n      </div>\n\n      <div className={`input-group ${style.colorBy}`}>\n        <label htmlFor=\"colorBy\">Color by</label>\n        <div className={style.fieldSelect}>\n          <FieldSelect\n            name=\"colorBy\"\n            className={style.selector}\n            onChange={colorBy}\n            fields={fields}\n            values={values}\n            getFieldId={getFieldId}\n            value={controls.colorBy}\n          />\n        </div>\n      </div>\n    </div>\n  );\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    controls: selectControls(state),\n    configuration: selectMergedConfiguration(state),\n    values: selectMergedValues(state)\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    showNodes: (shouldShowNodes) => dispatch(showNodes(shouldShowNodes)),\n    useDarkTheme: (darkTheme) => dispatch(useDarkTheme(darkTheme)),\n    colorBy: (field) => dispatch(colorBy(field))\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MiscControls);\n","import { is } from \"ramda\";\nimport { createAction } from \"redux-actions\";\nimport { ofType } from 'redux-observable';\nimport { of } from \"rxjs\";\nimport { mergeMap, map, tap, catchError } from 'rxjs/operators';\nimport { QueryParseError } from 'lunr';\n\nimport { setError } from \"domain/error\"\nimport { setSearchResults} from \"./index-dataset-epic\";\n\nconst searchDataset = createAction(\"SEARCH_DATASET\");\n\nconst searchDatasetEpic = (action$, store) => {\n  return action$.pipe(\n      ofType(searchDataset.toString())\n      ,mergeMap(({ payload }) => {\n        return of(payload).pipe(\n            tap(performSearch)\n            ,map((payload) =>\n              setSearchResults({\n                queryString: payload.queryString,\n                results: payload.results || []\n              })\n            )\n            ,catchError((error) => {\n              if (is(QueryParseError, error)) {\n                return of(setError(error));\n              } else {\n                /* istanbul ignore next */\n                throw error;\n              }\n            })\n          );\n      })\n    );\n};\n\nconst performSearch = (data) => {\n  data.results = [];\n  var toFind = data.queryString || '';\n  const indices = data.searchIndices;\n  var results = [];\n  if(indices && toFind){\n    for(var hash in indices){\n      const idx = indices[hash];\n      const idxResults = idx.search(toFind.toLowerCase());\n      const temp = new Set([...results, ...idxResults]);\n      results = [...temp];\n    }\n  }\n\n  Object.keys(data.datasets).forEach((key) => {\n    const ds = data.datasets[key].dataset;\n    ds.forEach((el) => { \n      el.CRVIZ._isSearchResult = false;\n    })\n    results.forEach((r) => {\n      const res = ds.find(i => i.CRVIZ[\"_SEARCH_KEY\"] === r.ref);\n      if(res){\n        res.CRVIZ._isSearchResult = true;\n        data.results.push(res);\n      }\n    });\n  });\n};\n\nexport default searchDatasetEpic;\n\nexport { searchDataset };\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\n\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faSearch,  faTimesCircle} from \"@fortawesome/free-solid-svg-icons\";\n\nimport { selectDatasets, selectMergedConfiguration } from \"domain/dataset\";\n\nimport { getSearchIndices, getSearchResults } from \"epics/index-dataset-epic\";\nimport { searchDataset } from \"epics/search-dataset-epic\";\n\nimport style from \"./SearchControls.module.css\";\n\nconst defaultState = {\n  queryString: '',\n  searchIndices: [],\n  hasSearch: false\n}\n\nclass Search extends React.Component {\n\n  state = defaultState\n\n  handleSearch(){\n    this.setState({\n      hasSearch: this.state.queryString !== ''\n    });\n    var data = {\n      datasets: this.props.datasets,\n      configuration: this.props.configuration,\n      searchIndices: this.props.searchIndices,\n      queryString: this.state.queryString,\n      results: this.props.results\n    }\n    \n    this.props.searchDataset(data);\n  }\n\n  clearSearch(){\n    this.setState(defaultState, function() {\n      this.handleSearch();\n    });\n  }\n\n  handleQueryStringChange = (e) =>{\n        this.setState({\n          queryString: e.target.value\n        });\n  }\n\n  handleKeyPress = (e) => {\n    if(e.key === 'Enter'){\n      this.handleSearch();\n    }\n  }\n\n  render() {\n    return (\n      <div className={style.searchContainer}>\n        <span className={ style.search }>\n          <input\n            type=\"search\"\n            id=\"search-string\"\n            placeholder=\"Search\"\n            value={this.state.queryString}\n            onChange={this.handleQueryStringChange}\n            onKeyPress={this.handleKeyPress}\n          />\n\n          <label htmlFor=\"search-string\" className=\"button circular\" onClick={() => this.handleSearch()} title=\"Search\">\n            <FontAwesomeIcon icon={faSearch} />\n          </label>\n        </span>\n        { this.state.hasSearch &&\n          <span>\n            <label id=\"search-results\"> {this.props.results.length} Results found </label>\n            <label htmlFor=\"search-results\" className=\"button circular\" onClick={() => this.clearSearch()}>\n              <FontAwesomeIcon icon={faTimesCircle} />\n              </label>\n          </span>\n        }\n      </div>\n    );\n  }\n}\n\nSearch.propTypes = {\n  datasets: PropTypes.object,\n  configuration: PropTypes.object,\n  searchIndex: PropTypes.object,\n  queryString: PropTypes.string,\n  results: PropTypes.array,\n  searchDataset: PropTypes.func.isRequired\n};\n\nconst mapStateToProps = (state, ownProps) => {\n  return {\n    datasets: selectDatasets(state),\n    configuration: selectMergedConfiguration(state),\n    searchIndices: getSearchIndices(state),\n    queryString: state.search.queryString,\n    results: getSearchResults(state)\n  };\n}\n\nconst mapDispatchToProps = {\n  searchDataset,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Search);\n","import {\n  add,\n  addIndex,\n  aperture,\n  concat,\n  forEach,\n  map,\n  last,\n  prop,\n  reject,\n  reverse,\n  splitEvery,\n  reduce\n} from \"ramda\";\n\nimport { packEnclose } from \"d3-hierarchy\";\n\n/**\n * Pack circles into rows and columns.\n */\nconst packGrid = (circles) => {\n  const rows = toRows(circles);\n  placeRows(rows);\n\n  // Recenter everything over the origin\n  var enclosingCircle = packEnclose(circles);\n  forEach((c) => {\n    c.x -= enclosingCircle.x;\n    c.y -= enclosingCircle.y\n  }, circles);\n};\n\nconst eachWithIndex = addIndex(forEach);\n\n/**\n * Assign x and y coordinates to rows of circles\n */\nconst placeRows = (rows) => {\n  rows = middleOut(map(middleOut, rows));\n\n  const maxRadii = map(maxRadius, rows);\n  const ys = coordinatesForRadii(maxRadii);\n  const xs = map(coordinatesForRadii, map(map(prop('r')), rows));\n\n  return eachWithIndex(\n    (row, i) =>\n      eachWithIndex((node, j) => {\n        node.x = xs[i][j];\n        node.y = ys[i];\n      }, row),\n    rows\n  );\n};\n\nconst maxRadius = (row) => {\n  return Math.max(...row.map((c) => c.r));\n};\n\n// Calculate the coordinates for the given list of radii\n// such that circles of these radii sit on the same line without colliding.\n// The circles are distributed evenly over the origin.\nconst coordinatesForRadii = (radii) => {\n  const diameters = map((r) => r * 2, radii)\n  const size = reduce(add, 0, diameters);\n\n  const first = 0 - size / 2 + radii[0]; // Calculate the first coordinate\n\n  return reduce((coords, [lastRadius, currentRadius]) => {\n    return [...coords, last(coords) + lastRadius + currentRadius];\n  }, [first], aperture(2, radii))\n};\n\n\nconst pickEven = (list) => addIndex(reject)((_, i) => i % 2 === 0, list);\nconst pickOdd = (list) => addIndex(reject)((_, i) => i % 2 !== 0, list);\n\n/**\n/ Re-order items from the middle out, alternating in direction.\n/\n/ Example:\n/ middleOut([1, 2, 3, 4, 5]) //=> [4, 2, 1, 3, 5]\n*/\nconst middleOut = (rows) => {\n  const above = pickEven(rows);\n  const below = pickOdd(rows);\n  return concat(reverse(above), below);\n};\n\nconst toRows = (circles) => {\n  return splitEvery(Math.ceil(Math.sqrt(circles.length)), circles);\n};\n\nexport default packGrid;\n","import { packEnclose } from \"d3-hierarchy\";\nimport packGrid from \"./pack-grid\";\n\n/**\n * An adaptation of the circle packing algorithm to reserve spacing at the\n * bottom of each non-leaf circle for labeling.\n */\nconst packWithLabel = () => {\n  let options = {\n    // Radius funcion\n    // See d3.pack.radius\n    radius: null,\n\n    // Layout size\n    // See d3.pack.size\n    size: [1, 1],\n\n    // Padding constant/function\n    // See d3.pack.padding\n    padding: () => 0,\n\n    // A number in [0, 1) that determine the portion of the circle that is\n    // reserved for label.\n    //\n    // To ensure label display are consistent between siblings, all siblings\n    // circles use the label size of the largest circle.\n    labelRatio: 0.25,\n\n    // But we ensure smaller circle doesn't look like Ben Solo with its high\n    // waisted pant.\n    maxLabelRatio: 0.40,\n\n    // The packing method for packing siblings node.\n    // By default use the packGrid method. Can be set to use D3's packSiblings\n    // method instead.\n    packSiblings: packGrid\n  };\n\n  /**\n   * @param root - A D3 hierarchy object\n   * @return A `pack` object similar to `d3.pack` but with additional options (see above)\n   */\n  const pack = (root) => {\n    root.x = options.size[0] / 2;\n    root.y = options.size[1] / 2;\n    const { radius, size, labelRatio, maxLabelRatio, packSiblings } = options;\n    const padding =\n      typeof options.padding === \"function\" ? options.padding : () => options.padding;\n\n    if (radius) {\n      root\n        .eachBefore(radiusLeaf(radius))\n        .eachAfter(packChildren(packSiblings, labelRatio, maxLabelRatio, padding, 0.5))\n        .eachBefore(translateChild(1));\n    } else {\n      // If radius is not specified, set each leaf node's radius based on its\n      // value, then resize the entire layout to fit options.size\n      root\n        .eachBefore(radiusLeaf((d) => Math.sqrt(d.value)))\n        .eachAfter(packChildren(packSiblings, labelRatio, maxLabelRatio, () => 0, 1))\n        .eachAfter(\n          packChildren(\n            packSiblings,\n            labelRatio,\n            maxLabelRatio,\n            padding,\n            root.r / Math.min(...size)\n          )\n        )\n        .eachBefore(translateChild(Math.min(...size) / (2 * root.r)));\n    }\n\n    return root;\n  };\n\n  /**\n   * Create an option method for each of the option above.\n   * Calling the method without arguments returns the current value.\n   * Calling the method with argument sets the option.\n   *\n   * Example:\n   * var pack = packWithLabel(root)\n   *              .radius(() => 20)\n   * pack.radius() //=> () => 20.\n   */\n  Object.keys(options).forEach((key) => {\n    pack[key] = (...values) => {\n\n      if (values.length === 0) {\n        return options[key];\n      }\n      options[key] = values[0];\n      return pack;\n    };\n  });\n\n  return pack;\n};\n\nconst radiusLeaf = (radius) => {\n  return (node) => {\n    if (!node.children) {\n      node.r = Math.max(radius(node), 0);\n    }\n  };\n};\n\nconst getLabelSize = (labelRatio) => (node) => {\n  return 2 * node.r * labelRatio / (1 - labelRatio);\n};\n\n/**\n * Pack children of a node, then set the node's radius to enclose all the children\n */\nconst packChildren = (packSiblings, labelRatio, maxLabelRatio, padding, k) => (node) => {\n  if (!node.children) {\n    return;\n  }\n\n  const children = node.children;\n\n  const nonleafChildren = children.filter((child) => child.height > 0);\n\n  // Calculate the label size of the largest non-leaf children\n  // and expand their radii accordingly to make space for label.\n  if (nonleafChildren.length > 0) {\n    const labelSize = Math.max(...nonleafChildren.map(getLabelSize(labelRatio)))\n\n    nonleafChildren.forEach((node) => {\n      node.labelSize = Math.min(labelSize, getLabelSize(maxLabelRatio)(node));\n      node.r += node.labelSize / 2;\n\n\n    });\n  }\n\n  const paddingSize = padding(node) * k || 0;\n\n  // Padding is implemented by adding it to the children's radii, pack,\n  // then returning the radii to their original value.\n  if (paddingSize) {\n    children.forEach((child) => (child.r += paddingSize));\n  }\n  packSiblings(children);\n  const enclosingRadius = packEnclose(children).r;\n\n  if (paddingSize) {\n    children.forEach((child) => (child.r -= paddingSize));\n  }\n\n  node.r = enclosingRadius + paddingSize;\n};\n\n// Set the the node's children's positions to be inside the node and above the\n// space reserved for labeling.\nconst translateChild = (k) => (node) => {\n  const parent = node.parent;\n  node.r *= k;\n\n  if (node.labelSize) {\n    node.labelSize *= k;\n    node.labelY = node.r - node.labelSize / 2;\n    node.labelWidth = 2 * Math.sqrt(node.r ** 2 - node.labelY ** 2);\n  }\n\n  if (parent) {\n    node.x = parent.x + k * node.x;\n    node.y = parent.y + k * node.y;\n    if (parent.labelSize) {\n      node.y -= parent.labelSize / 2;\n    }\n  }\n};\n\nexport default packWithLabel;","import { chain, head, tail, map, reduce, path, isNil } from \"ramda\";\nimport { nest } from \"d3-collection\";\nimport { hierarchy as d3Hierarchy } from \"d3-hierarchy\";\n\n/**\n * Convert an array of nodes into a D3 hierarchy\n *\n * @param [array] data - an array of data\n * @hierarchy [array] - an array of objects in the shape of\n * {\n *   displayName: string,\n *   path: array[string]\n * }\n */\n\nconst toHierarchy = (data, hierarchyConfig) => {\n  const nesting = nestHierarchy(hierarchyConfig).entries(data);\n  const result = entriesToHierarchy(\"root\", null, hierarchyConfig, nesting);\n  return d3Hierarchy(result);\n};\n\n/**\n * Create the D3 nest function that will nest data given the hierarchyConfig.\n */\nconst nestHierarchy = (hierarchyConfig) => {\n  return reduce(\n    (nest, field) => {\n      return nest.key((d) => path(field.path, d));\n    },\n    nest(),\n    hierarchyConfig\n  );\n};\n\nconst countSearchResults = (children) => {\n  if(isNil(children)){\n    return 0;\n  }\n\n  var result = 0;\n\n  for(var c in children){\n    if(!('CRVIZ' in children[c])){\n      children[c]['CRVIZ'] = {};\n    }\n    result += (children[c].CRVIZ._searchResultCount || 0) + (children[c].CRVIZ._isSearchResult || 0) +\n              (\n                !isNil(children[c].values)\n                  ? countSearchResults(children[c].values) : 0\n              );\n  }\n\n  return result;\n};\n\nconst countAdded = (children) => {\n  if(isNil(children)){\n    return 0;\n  }\n\n  var result = 0;\n\n  for(var c in children){\n    if(!('CRVIZ' in children[c])){\n      children[c]['CRVIZ'] = {};\n    }\n    result += (children[c].CRVIZ._addedCount || 0) + (children[c].CRVIZ._isAdded || 0) +\n              (\n                !isNil(children[c].values)\n                  ? countAdded(children[c].values) : 0\n              );\n  }\n\n  return result;\n};\n\nconst countChanged = (children) => {\n  if(isNil(children)){\n    return 0;\n  }\n\n  var result = 0;\n\n  for(var c in children){\n    if(!('CRVIZ' in children[c])){\n      children[c]['CRVIZ'] = {};\n    }\n    result += (children[c].CRVIZ._changedCount || 0) + (children[c].CRVIZ._isChanged || 0) +\n              (\n                !isNil(children[c].values)\n                  ? countChanged(children[c].values) : 0\n              );\n  }\n\n  return result;\n};\n\nconst countRemoved = (children) => {\n  if(isNil(children)){\n    return 0;\n  }\n\n  var result = 0;\n\n  for(var c in children){\n    if(!('CRVIZ' in children[c])){\n      children[c]['CRVIZ'] = {};\n    }\n    result += (children[c].CRVIZ._removedCount || 0) + (children[c].CRVIZ._isRemoved || 0) +\n              (\n                !isNil(children[c].values)\n                  ? countRemoved(children[c].values) : 0\n              );\n  }\n\n  return result;\n};\n\n\nconst childrenAreLeaves = (group) =>{\n  return group.reduce((prev, current) => {\n    const containsGroups = current.CRVIZ ?  current.CRVIZ._containsGroups : false;\n    return prev && !containsGroups && !current.values\n  }, true);\n}\n\n/**\n * Convert nest entries into the format accepted by d3.hierarchy\n */\nconst entriesToHierarchy = (fieldValue, field, hierarchyConfig, entries) => {\n  if (fieldValue === 'Unknown') {\n    const children = chain(getLeaves, entries)\n    return {\n      fieldValue,\n      field,\n      children: children,\n      CRVIZ:{ \n        _containsGroups: false,\n        _searchResultCount: countSearchResults(entries),\n        _addedCount: countAdded(entries),\n        _changedCount: countChanged(entries),\n        _removedCount: countRemoved(entries),\n      }\n    }\n  }\n\n  const children =  map((entry) => {\n    if (entry.values) {\n      return entriesToHierarchy(\n        entry.key,\n        head(hierarchyConfig),\n        tail(hierarchyConfig),\n        entry.values\n      );\n    } else {\n      return entry;\n    }\n  }, entries);\n  return {\n    fieldValue,\n    field,\n    children: children,\n    CRVIZ:{ \n      _containsGroups: !childrenAreLeaves(entries),\n      _searchResultCount: countSearchResults(entries),\n      _addedCount: countAdded(entries),\n      _changedCount: countChanged(entries),\n      _removedCount: countRemoved(entries),\n    }\n  };\n};\n\nconst getLeaves = (entry) => {\n  if (entry.values) {\n    return chain(getLeaves, entry.values)\n  } else {\n    return [entry]\n  }\n}\n\nexport default toHierarchy;\n","\n/**\n * Return a string that can be used to check if two data are the same.\n*/\nconst datumKey = (datum) => {\n  if (datum.depth === 0) {\n    return 'root';\n  } else if (datum.height > 0) {\n    return [\n      datumKey(datum.parent),\n      datum.data.field.path.join(\".\"),\n      datum.data.fieldValue\n    ].join(\".\");\n  } else {\n    return datum.data.uid;\n  }\n};\n\nexport default datumKey;\n","const className = (name) => `viz-${name}`;\n\nexport default className;","import { select } from \"d3\";\nimport { path } from \"d3-path\";\n\nimport datumKey from \"./datum-key\";\nimport className from \"./class-name\";\n\nconst appendCircles = ({ nodeRoot, labelRoot, packedData, showNodes, hasSearch }) => {\n  const data = packedData.descendants();\n  const firstLeaf = packedData.leaves()[0];\n  const leafRadius = firstLeaf.r || 0;\n  const fontScale = ((2*leafRadius)/16) *100;\n\n  const nodes = nodeRoot\n    .selectAll(`g.${className(\"node\")}`)\n    .data(data, datumKey);\n\n  nodes.exit().remove();  \n\n  const nodesEnter = nodes.enter().append(\"g\").classed(className(\"node\"), true);\n  nodesEnter\n    .merge(nodes)\n    .attr('data-key', datumKey)\n    .classed(className(\"rootNode\"), (d) => d.depth === 0)\n    .classed(className(\"groupingNode\"), (d) => d.depth > 0 && d.height > 0)\n    .classed(className(\"containsSearchResult\"), (d) => hasSearch && d.data.CRVIZ._searchResultCount > 0 && d.depth > 0 && d.height > 0)\n    .classed(className(\"containsNoSearchResult\"), (d) => hasSearch && d.data.CRVIZ._searchResultCount === 0 && d.depth > 0 && d.height > 0)\n    .classed(className(\"searchResult\"), (d) => hasSearch && d.data.CRVIZ._isSearchResult && d.depth > 0 && d.height === 0)\n    .classed(className(\"isChanged\"), (d) => d.data.CRVIZ._isChanged && d.depth > 0 && d.height === 0)\n    .classed(className(\"isAdded\"), (d) => d.data.CRVIZ._isAdded && d.depth > 0 && d.height === 0)\n    .classed(className(\"isRemoved\"), (d) => d.data.CRVIZ._isRemoved && d.depth > 0 && d.height === 0)\n    .classed(className(\"searchExcluded\"), (d) => hasSearch && !d.data.CRVIZ._isSearchResult && d.depth > 0 && d.height === 0)\n    .classed(className(\"leafNode\"), (d) => d.height === 0)\n    .attr(\"transform\", (d) => `translate(${[d.x, d.y].join(\",\")})`)\n    .attr(\"display\", (d) => !showNodes && d.height === 0 ? 'none' : null)\n    .order();\n\n  const circles = nodes.select(\"circle\").merge(nodesEnter.append(\"circle\"));\n\n  circles.attr(\"r\", (d) => d.r);\n\n  const newLabelGroups = nodesEnter.append(\"g\").classed(className('label-group'), true);\n  const newLabelShapes = newLabelGroups.append(\"path\");\n  const newLabels = newLabelGroups.append('text').classed(className('label'), true);\n\n  const labelShapes = nodes.select(`g.${className('label-group')}`).select('path');\n  labelShapes\n  .merge(newLabelShapes)\n    .filter((d) => d.labelSize)\n    .attr(\"class\", className(\"labelShape\"))\n    .attr(\"d\", getLabelShape);\n\n  const labels = nodes.select(`g.${className('label-group')}`).select('text');\n  const mergedLabels = labels\n  .merge(newLabels)\n    .filter((d) => d.labelSize)\n    .style('font-size', (d, i, nodes) => (3 * d.height * fontScale) + \"%\")\n    .attr('y', (d) => d.r - (d.labelSize/2))\n    .text((d) => d.data.fieldValue);\n\n  mergedLabels.each( (d, i, nodes) => {\n    scaleAndTrimToLabelWidth(nodes[i], d, 3 * d.height * fontScale);\n  })\n\n  const newGroupingNodes = nodesEnter.filter((d) => d.height === 1);\n  const newAggregations = newGroupingNodes\n    .append(\"g\")\n    .classed(className(\"aggregation\"), true)\n    .attr(\"display\", (d) => showNodes ? 'none' : null);\n  const newTotalContainer = newAggregations\n    .append('g')\n      .classed(className(\"total-container\"), true);\n  // newTotalContainer\n  //   .append('g')\n  //     .classed(className(\"node\"), true)\n  //   .append('circle')\n  //     .attr('r', (d) => leafRadius)\n  //     .attr('cx', (d) => 0)\n  //     .attr('cy', (d) => 0);\n\n  const newTotalText = newTotalContainer\n  .append(\"text\")\n    .classed(className(\"annotation-text\"), true)\n    .style('font-size', (d) => (3 * d.height * fontScale) +\"%\")\n    .attr('x', (d) => 0)\n    .attr('y', (d) => 0)\n    .text((d) => !isNaN(d.value) ? d.value : \"0\");\n\n  const aggregations = nodeRoot.selectAll(`g.${className(\"aggregation\")}`).data(data, datumKey);\n  aggregations\n  .merge(newAggregations)\n    .attr(\"display\", (d, i, nodes) => showNodes || d.data.CRVIZ._containsGroups ? 'none' : null);\n\n  aggregations\n  .select(`g.${className(\"total-container\")}`)\n  .select('text')\n  .merge(newTotalText)\n    .text((d) => !isNaN(d.value) ? d.value : \"0\");\n\n  //const groupData = packedData.descendants().filter((d) => d.height > 0 && d,height > 0);\n  //appendAggregations(nodeRoot, groupData, showNodes, leafRadius, fontScale);\n\n  return [\n    nodes.merge(nodesEnter),\n  ];\n};\n\n/**\n * Calculate the d attribute of a path element representing the shape of the\n * label area (the partial circles at the bottom of the grouping nodes)\n */\nconst getLabelShape = (d) => {\n  const top = d.r - d.labelSize;\n  const radius = d.r;\n\n  const startAngle = Math.PI / 2 + Math.acos(top / radius);\n  const endAngle = Math.PI / 2 - Math.acos(top / radius);\n\n  const shape = path();\n  shape.arc(0, 0, radius, startAngle, endAngle, true);\n  shape.closePath();\n\n  return shape.toString();\n}\n\nconst getLabelWidth = (datum) =>{\n  const top = datum.r - datum.labelSize;\n  const radius = datum.r;\n\n  const startAngle = Math.PI / 2 + Math.acos(top / radius);\n  const endAngle = Math.PI / 2 - Math.acos(top / radius);\n  const arcAngle = startAngle - endAngle;\n\n  //length of a chord across a circle with angle theta\n  //is calculated as:\n  // 2*radius * sin(theta/2)\n  return 2*radius*Math.sin(arcAngle/2);\n}\n\nconst scaleAndTrimToLabelWidth = (node, datum, initialFontScale) => {\n  const maxTextWidth = 0.80 * getLabelWidth(datum);\n  const maxTextHeight = 0.80 * datum.labelSize;\n  const minFontScale = 10;\n  const maxFontScale = 125;\n\n  let boxWidth = node.getBBox().width;\n  let boxHeight = node.getBBox().height;\n  let fontScale = 100;\n  let labelText = datum.data.fieldValue;\n\n  //scale to height\n   if ((boxHeight > maxTextHeight)){\n    const heightScale = 1-Math.abs((boxHeight - maxTextHeight)/boxHeight);\n    fontScale = Math.max(minFontScale, heightScale * initialFontScale);\n    select(node)\n      .style('font-size', (d, i, nodes) => fontScale + \"%\")\n      .text(labelText);\n  } else if(boxHeight < 0.75 * maxTextHeight){\n    const heightScale = 1 + Math.abs((boxHeight - maxTextHeight)/maxTextHeight);\n    fontScale = Math.min(maxFontScale, heightScale * initialFontScale);\n    select(node)\n      .style('font-size', (d, i, nodes) => fontScale + \"%\")\n      .text(labelText);\n  }\n \n  boxWidth = node.getBBox().width;\n  //trim to width\n  if(boxWidth > maxTextWidth)\n  {\n    const lengthToTrimTo = Math.trunc(0.75*labelText.length);\n    labelText = labelText.substr(0, lengthToTrimTo) + \"...\"\n    select(node)\n    .attr('textLength', maxTextWidth)\n    .attr('lengthAdjust', \"spacingAndGlyphs\")\n    .text(labelText);\n  }\n}\n\n// const appendAggregations = (nodeRoot, groupData, showNodes, leafRadius, fontScale) =>{\n\n//   const groupingNodes = nodeRoot\n//     .selectAll(`g.${className(\"groupingNode\")}`);\n//   const aggregations = groupingNodes\n//     .select(`g.${className(\"aggregation\")}`)\n//     .data(groupData, datumKey);\n\n//   //aggregations.exit().remove();\n\n//   const newAggregations = groupingNodes.enter()\n//   .append(\"g\")\n//     .classed(className(\"aggregation\"), true)\n//     .attr(\"display\", (d) => showNodes ? 'none' : null);\n\n\n\n//   const newTotalContainer = newAggregations\n//     .append('g')\n//       .classed(className(\"total-container\"), true);\n//   newTotalContainer\n//     .append('g')\n//       .classed(className(\"node\"), true)\n//     .append('circle')\n//       .attr('r', (d) => leafRadius)\n//       .attr('cx', (d) => 0)\n//       .attr('cy', (d) => 0);\n\n//   const newTotalText = newTotalContainer\n//   .append(\"text\")\n//     .classed(className(\"annotation-text\"), true)\n//     .style('font-size', (d) => (3 * d.height * fontScale) +\"%\")\n//     .attr('x', (d) => 0)\n//     .attr('y', (d) => 0)\n//     .text((d) => !isNaN(d.value) ? d.value : \"0\");\n\n//   aggregations\n//   .select(`g.${className(\"total-container\")}`)\n//   .select('text')\n//   .merge(newTotalText)\n//     .attr(\"display\", (d) => showNodes ? 'none' : null)\n//     .text((d) => !isNaN(d.value) ? d.value : \"0\");\n\n// }\n\nexport default appendCircles;\n","import { zoom, zoomTransform } from \"d3-zoom\";\nimport { event as d3Event } from \"d3-selection\";\nimport { zoomIdentity } from \"d3-zoom\";\n\nconst setupZoom = ({\n  zoomRoot,\n  transformRoot,\n  nodes,\n  showNodes,\n  width,\n  height,\n  packedData\n}) => {\n\n  const state = {\n    zoomTo: null,\n    zoomToTransform: null,\n    // Find the current zoom transform if any\n    transform: zoomTransform(zoomRoot.node())\n  };\n\n  const zoomBehavior = zoom();\n\n  zoomBehavior.on(\"zoom\", () => {\n    const event = d3Event;\n    state.transform = event.transform;\n    zoomToTransform(event.transform)\n  });\n\n  zoomRoot.call(zoomBehavior);\n\n  // Amount of space to leave around a node when zoomed into that node\n  // (as a fraction of the node diameter)\n  const viewPadding = 0.25;\n\n  const { r: rootR, x: rootX, y: rootY } = packedData;\n\n  const scaleExtent = [\n    Math.min(width, height) / (rootR * 2),\n    Math.min(width, height) / (packedData.leaves()[0].r * 2 * (1 + viewPadding))\n  ];\n\n  const translateExtent = [\n    [\n      rootX - width / 2 / scaleExtent[0] * 2,\n      rootY - height / 2 / scaleExtent[0] * 2\n    ],\n    [\n      rootX + width / 2 / scaleExtent[0] * 2,\n      rootY + height / 2 / scaleExtent[0] * 2\n    ]\n  ];\n\n  zoomBehavior.scaleExtent(scaleExtent).translateExtent(translateExtent);\n\n  // Assume everything is hidden by default.\n  //\n  // Note:\n  // This could have been done using inline style.\n  // The odd thing is, when using inline style, apparently each node's style is\n  // recalculated in every frame during zooming regardless of whether or not\n  // the inline style was changed.\n  //\n  // Using a class avoided this issue.\n  nodes.classed('viz-zoomMinutia', true);\n\n  function zoomToTransform(transform) {\n    transformRoot\n      .style(\"transform\", `translate(${ Math.floor(transform.x) }px, ${ Math.floor(transform.y) }px) scale(${ transform.k })`);\n\n    const bound = viewBound(width, height, transform);\n\n    const nodesInView = nodes.filter((d) => boundOverlap(bound, nodeBound(d)));\n\n    nodesInView\n      .call(hideSmall, transform)\n  };\n\n  function zoomTo(datum, animate = true) {\n    const size = datum.r * 2 * (1 + viewPadding);\n    const k = Math.min(width, height) / size;\n    const transform = zoomIdentity\n      .scale(k)\n      .translate(\n          - datum.x + width / 2 / k,\n          - datum.y + height / 2 / k,\n      );\n\n    zoomBehavior.transform(\n      !animate ? zoomRoot : zoomRoot.transition().duration(1000),\n      transform\n    );\n  }\n\n  if (state.transform) {\n    zoomToTransform(state.transform);\n  }\n\n  state.zoomTo = zoomTo;\n  state.zoomToTransform = zoomToTransform;\n\n  return state;\n};\n\nconst hideSmall = (nodes, transform) => {\n  const tooSmall = (d) => d.r * transform.k < 1;\n\n  nodes\n    .filter(\":not(.viz-zoomMinutia)\")\n    .filter((d) => tooSmall(d))\n    .classed(\"viz-zoomMinutia\", true);\n\n  nodes\n    .filter(\".viz-zoomMinutia\")\n    .filter((d) => !tooSmall(d))\n    .classed(\"viz-zoomMinutia\", false)\n};\n\n/**\n * The bound of the view given the original width, height, and transform\n */\nconst viewBound = (width, height, transform) => {\n  var size = Math.min(width, height);\n  var boundWidth = size * Math.max(width / height, 1);\n  var boundHeight = size * Math.max(height / width, 1);\n\n  var bound = [\n    -transform.x / transform.k,\n    -transform.y / transform.k,\n    (-transform.x + boundWidth) / transform.k,\n    (-transform.y + boundHeight) / transform.k\n  ];\n  return bound;\n};\n\nconst nodeBound = (datum) => [\n  datum.x - datum.r,\n  datum.y - datum.r,\n  datum.x + datum.r,\n  datum.y + datum.r\n];\n\nconst boundOverlap = (bound0, bound1) => {\n  return (\n    bound0[0] <= bound1[2] &&\n    bound0[2] >= bound1[0] &&\n    bound0[1] <= bound1[3] &&\n    bound0[3] >= bound1[1]\n  );\n};\n\nexport default setupZoom;\n","import { map, join, path } from \"ramda\";\nimport { select, event as d3Event } from \"d3-selection\";\n\nconst setupTooltip = ({ nodeRoot, tooltip, fields }) => {\n  tooltip\n    .style(\"display\", \"block\")\n    .style(\"position\", \"absolute\")\n    .style(\"transform\", null)\n    .style(\"top\", \"0px\")\n    .style(\"left\", \"0px\");\n\n  const boundingRect = tooltip.node().getBoundingClientRect();\n\n  const offsetLeft = -boundingRect.left + 5;\n  const offsetTop = -boundingRect.top + 5;\n\n  // Measurements need to be taken before hiding the tooltip, otherwise they are\n  // not accurate.\n  tooltip.style(\"display\", \"none\")\n\n  nodeRoot.on(\"mousemove\", () => {\n    const event = d3Event;\n    showTooltip(event, fields, offsetTop, offsetLeft, tooltip);\n\n  });\n};\n\nconst showTooltip = (event, fields, offsetTop, offsetLeft, tooltip) => {\n  const target = select(event.target);\n  const datum = target.datum();\n  const text = content(datum, fields);\n  if (text) {\n    tooltip.node().innerHTML = text;\n    tooltip\n      .style(\"display\", \"block\")\n      .style(\"transform\", `translate3d(${ event.x + offsetLeft + 1 }px, ${ event.y + offsetTop + 1 }px, 0)`)\n  } else {\n    tooltip.style(\"display\", \"none\");\n  }\n  //tooltip.classed(\"searchResult\", datum.data.isSearchResult);\n};\n\nconst content = (datum, fields) => {\n  if (datum.depth > 0 && datum.height > 0) {\n    let cont = `${ datum.data.fieldValue } (${datum.value})`;\n    if(datum.data.CRVIZ._searchResultCount > 0){\n      cont += `<br/><span>${datum.data.CRVIZ._searchResultCount} search results</span>`\n    }\n    return cont;\n  } else if (datum.height === 0) {\n    const pairs = map(\n      (field) => [`<strong>${ field.displayName }</strong>`, path(field.path, datum.data)],\n      fields\n    );\n    return map(join(\": \"), pairs).join(\"<br />\");\n  } else {\n    return null;\n  }\n};\n\nexport default setupTooltip;\n","import { times, concat } from \"ramda\";\nimport { scaleLinear, scalePow } from 'd3-scale';\nimport { hcl } from \"d3-color\";\n\nconst colorScheme = [\n  \"#a6cee3\",\n  \"#3366cc\",\n  \"#b2df8a\",\n  \"#33a02c\",\n  \"#fb9a99\",\n  \"#996699\",\n  \"#fdbf6f\",\n  \"#ff7f00\",\n  \"#cc99ff\",\n  \"#6a3d9a\",\n  \"#ffff99\",\n  \"#b15928\",\n  \"#ffcc99\",\n  \"#333399\"\n];\n\nconst extendColorScheme = (colorScheme, count) => {\n  const extraLayers = Math.floor(count / colorScheme.length);\n\n  if (extraLayers === 0) {\n    return colorScheme;\n  }\n\n  const extraColors = times((i) => {\n    const currentLayer = (i + colorScheme.length) / colorScheme.length;\n\n    const previous = hcl(colorScheme[i % colorScheme.length])\n    const neighbor = hcl(colorScheme[(i + 1) % colorScheme.length])\n\n    const hScale = scaleLinear()\n      .domain([0, extraLayers])\n      .range([previous.h, neighbor.h]);\n\n    const cScale = scalePow()\n      .exponent(5)\n      .domain([0, extraLayers])\n      .range([previous.c, 100]);\n\n    const lScale = scalePow()\n      .exponent(2)\n      .domain([0, extraLayers])\n      .range([previous.l, previous.l / 2]);\n\n    const h = hScale(currentLayer)\n    const c = cScale(currentLayer);\n    const l = lScale(currentLayer);\n\n    const nextColor = hcl(h, c, l);\n    return nextColor.toString();\n  }, count - colorScheme.length);\n\n  return concat(colorScheme, extraColors)\n}\n\nexport { colorScheme, extendColorScheme };\n","import { selectAll, select, event as d3Event } from 'd3-selection';\n\nimport {\n  contains,\n  either,\n  equals,\n  fromPairs,\n  toPairs,\n  identity,\n  map,\n  path,\n  pipe,\n  sortBy,\n  uniq,\n  zip\n} from \"ramda\";\n\nimport className from \"./class-name\";\nimport { colorScheme, extendColorScheme } from './color-scheme';\n\nfunction setupLegend({ legend, data, hierarchyConfig, coloredField, legendConfig }) {\n  if (!coloredField) {\n    legend.style(\"display\", \"none\");\n\n    const state = { nodes: [], annotations: [] }\n\n    function update({ nodes, annotations }) {\n      state.nodes = nodes;\n      nodes.classed('viz-coloredNode', coloredField);\n      if (!coloredField) {\n        nodes.select('circle').attr('class', null);  \n        return;\n      }\n    }\n\n    return { update };\n  } else {\n    legend.style(\"display\", null);\n  }\n\n  const getValue = either(path(coloredField.path), path([\"fieldValue\"]));\n\n  // If coloring groupings, don't color devices with the same value\n  const isColoringGroup = contains(coloredField, hierarchyConfig);\n\n  const values = pipe(\n    map(getValue),\n    uniq,\n    sortBy(identity)\n  )(data);\n\n  const scheme = extendColorScheme(colorScheme, values.length);\n\n  const configs = scheme.map((color, index) => {\n    return {\n      color,\n      disabled: false,\n      className: `legend-color-${index}`\n    }\n  });\n\n  const coloring = zip(values, configs);\n  const colorMap = fromPairs(coloring);\n\n  createStylesheet(coloring);\n\n  const state = { nodes: [] }\n\n  function update({ nodes, annotations }) {\n    state.nodes = nodes;\n    //state.annotations = annotations;\n    nodes.classed('viz-coloredNode', coloredField);\n    if (!coloredField) {\n      nodes.select('circle').attr('class', null);   \n      return;\n    }\n\n    colorNodes({ nodes, colorMap, getValue, coloredField, isColoringGroup });\n    colorAnnotations({ annotations, colorMap, getValue, coloredField, isColoringGroup })\n    updateLegend({ legend, colorMap, toggleValue })\n  }\n\n  function toggleValue(value) {\n    colorMap[value].disabled = !colorMap[value].disabled;\n    update({ nodes: state.nodes });\n  }\n\n  return { update, colorMap };\n}\n\nconst updateLegend = ({ legend, colorMap, toggleValue }) => {\n  const items = legend\n    .selectAll(\"p.viz-legendItem\")\n    .data(toPairs(colorMap), ([value]) => value );\n\n  items.exit().remove();\n\n  const itemsEnter = items.enter().append(\"p\").classed(\"viz-legendItem\", true)\n  itemsEnter.append(\"span\").classed(\"viz-legendColor\", true);\n  itemsEnter.append(\"span\").classed(\"viz-legendLabel\", true);\n\n  items.merge(itemsEnter)\n    .classed(\"viz-legendDisabled\", (d) => d[1].disabled);\n\n  items.merge(itemsEnter)\n    .select(\".viz-legendColor\")\n    .style(\"background-color\", ([value, { color }]) => color);\n\n  items.merge(itemsEnter)\n    .select(\".viz-legendLabel\")\n    .attr('title', ([value]) => value)\n    .text(([value]) => value);\n\n  legend.on('click.toggle', () => {\n    const datum = select(d3Event.target).datum();\n    if (datum) {\n      toggleValue(datum[0]);\n    }\n  })\n}\n\n/**\n * Having inline style trigger an expensive \"recalculate style\" in every frame\n * during zooming (even if the style attribute is empty!).\n *\n * We work around this by creating a style element that contains a class for\n * each item in the legend and assign those classes to each circle.\n*/\nconst createStylesheet = (coloring) => {\n  const style = selectAll('style#coloring').data([coloring]);\n  const styleEnter = style.enter().append('style').attr('id', 'coloring');\n\n  const html = coloring.map(([ value, { color, className } ], index) => {\n    return `\n      .viz-node circle.${className} {\n        fill: ${color} !important\n      }\n    `\n  }).join(\"\\n\");\n\n  style.merge(styleEnter)\n    .html(html)\n}\n\nconst colorNodes = ({ nodes, colorMap, getValue, coloredField, isColoringGroup }) => {\n  nodes\n    .filter((d) => d.height === 0)\n    .select(\"circle\")\n    .attr('class', (d) => {\n      const { disabled, className } = colorMap[getValue(d.data)] || {};\n      return !isColoringGroup && !disabled && className ? className : null\n    });\n\n  nodes\n    .filter((d) => d.height > 0)\n    .classed(\"viz-coloredNode\", (d) => {\n      const { disabled } = colorMap[getValue(d.data)] || {};\n      return !disabled &&\n        equals(d.data.field, coloredField) \n    })\n    .select(\"circle\")\n    .attr('class', (d) => {\n      const { disabled, className } = colorMap[getValue(d.data)] || {};\n      return isColoringGroup\n        && equals(d.data.field, coloredField)\n        && !disabled\n        && className;\n    });\n}\n\nconst colorAnnotations = ({ annotations, colorMap, getValue, coloredField, isColoringGroup }) => {\n  if(annotations){\n    annotations\n      .select(`g.${className(\"total-container\")}`)\n      .attr('class', (d) => {\n        const { disabled, className } = colorMap[getValue(d.data)] || {};\n\n        return isColoringGroup\n          && equals(d.data.field, coloredField)\n          && !disabled\n          && className;\n      });\n  }\n  // nodes\n  //   .filter((d) => d.height > 0)\n  //   .classed(\"viz-coloredNode\", (d) => {\n  //     const { disabled } = colorMap[getValue(d.data)] || {};\n  //     return !disabled &&\n  //       equals(d.data.field, coloredField) \n  //   })\n  //   .select(\"circle\")\n  //   .attr('class', (d) => {\n  //     const { disabled, className } = colorMap[getValue(d.data)] || {};\n  //     return isColoringGroup\n  //       && equals(d.data.field, coloredField)\n  //       && !disabled\n  //       && className;\n  //   });\n}\n\nexport default setupLegend;\n","import { select, selectAll } from \"d3\";\n\nimport { memoizeWith } from \"ramda\";\n\nimport datumKey from \"./datum-key\";\nimport className from \"./class-name\";\n\nconst setupAnnotations = ({packedData, annotationRoot}) =>{\n  //sum up change counts because we only are interested in groups that have changes to display\n  const data = packedData.descendants().filter(d => d.depth > 0 && d.height > 0 \n    && d.data.CRVIZ && (d.data.CRVIZ[\"_addedCount\"] + d.data.CRVIZ[\"_changedCount\"] + d.data.CRVIZ[\"_removedCount\"]) > 0);\n\n  const firstLeaf = packedData.leaves()[0];\n  const leafRadius = firstLeaf.r || 0;\n  const fontScale = ((2*leafRadius)/16) *100;\n  \n  const annotations = annotationRoot\n    .selectAll(`g.${className(\"annotation\")}`)\n    .data(data, datumKey);\n\n  annotations.exit().remove();\n\n  const annotationsEnter = annotations.enter().append(\"g\")\n  .classed(className(\"annotation\"), true);\n\n  //const baseAngle(d) = -60 * (Math.PI/180);\n  \n  annotationsEnter\n    .merge(annotations)\n    .attr('data-key', datumKey)\n    .attr(\"transform\", (d) => `translate(${[d.x, d.y].join(\",\")})`)\n    .order();\n\n  //changed nodes indicator\n  const newChangeIconContainer = annotationsEnter\n    .append('g')\n      .classed(className(\"change-icon-container\"), true);\n  const newChangeIcon = newChangeIconContainer\n  .append('text')\n    .classed('svg-icon', true)\n    .classed('nag', true)\n\t .style('font-size', (d) => (4 * d.height * fontScale) + \"%\")\n    .text('\\uf06a');//font-awesome\n\n  annotations\n  .select(`g.${className(\"change-icon-container\")}`)\n  .select('text.svg-icon')\n  .merge(newChangeIcon)\n    .attr('x', (d) => (getEdgePositionX(d.r, baseAngle(d))))\n    .attr('y', (d) => (getEdgePositionY(d.r, baseAngle(d))))\n    .on(\"click\", (d) => {\n      //Brings up Ring-menu on click\n      const annotation = selectAll(`g.${className(\"annotation\")}[data-key=\"${datumKey(d)}\"]`);\n\n      annotation\n      .select(`g.${className(\"change-icon-container\")}`)\n        .classed(className(\"annotation-hidden\"), true);\n\n      annotation\n      .select(`g.${className(\"change-icon-container\")}`)\n      .select('text.nag')\n        .classed('nag', false);\n\n      annotation\n      .select(`g.${className(\"ring-menu\")}`)\n        .classed(className(\"annotation-hidden\"), false);\n\n    })\n\n\n  //ring menu\n  const newRingMenu = annotationsEnter\n    .append('g')\n      .classed(className(\"ring-menu\"), true)\n      .classed(className(\"annotation-hidden\"), true);\n\n  const newBgCircles = newRingMenu\n    .append('circle')\n      .classed(className('bg-circle'), true)\n      .attr('r', (d) =>  18*d.height*leafRadius)\n\n  annotations\n  .select(`g.${className(\"ring-menu\")}`)\n  .select('circle')\n  .merge(newBgCircles)\n    .attr('cx', (d) => (getEdgePositionX(d.r, baseAngle(d))))\n    .attr('cy', (d) => (getEdgePositionY(d.r, baseAngle(d))));\n\n  const newX = newRingMenu\n  .append('text')\n    .classed('svg-icon', true)\n    .style('font-size', (d) => 3 * d.height * fontScale + \"%\")\n    .text('\\uf00d');\n\n  annotations\n  .select(`g.${className(\"ring-menu\")}`)\n  .select('text.svg-icon')\n  .merge(newX)\n    .attr('x', (d) => getEdgePositionX(d.r, baseAngle(d)))\n    .attr('y', (d) => (getEdgePositionY(d.r, baseAngle(d))))\n    .on(\"click\", (d) => {\n      const annotation = selectAll(`g.${className(\"annotation\")}[data-key=\"${datumKey(d)}\"]`);\n\n      annotation\n      .select(`g.${className(\"change-icon-container\")}`)\n        .classed(className(\"annotation-hidden\"), false);\n\n      annotation\n      .select(`g.${className(\"ring-menu\")}`)\n        .classed(className(\"annotation-hidden\"), true);\n    });\n\n  //Icons inside ring menu  \n  //totals \n  const newTotalContainer = newRingMenu\n    .append('g')\n      .classed(className(\"total-container\"), true);\n  newTotalContainer\n    .append('g')\n      .classed(className(\"node\"), true)\n    .append('circle')\n      .attr('r', (d) => 2 * d.height * leafRadius)\n      .attr('cx', (d) => (getEdgePositionX(d.r, baseAngle(d))) - 0*d.height*leafRadius)\n      .attr('cy', (d) => (getEdgePositionY(d.r, baseAngle(d))) - 10*d.height*leafRadius);\n\n  annotations\n  .select(`g.${className(\"total-container\")}`)\n  .merge(newTotalContainer)\n  .on(\"click\", (d, i, nodes) => {\n      const dk = datumKey(d);\n      const glyph = select(nodes[i])\n        .select(`g.${className(\"node\")}`)\n      const showHide = glyph.classed(className(\"ringMenuExcluded\"));\n\n      const leaves = selectAll(`g.${className(\"node\")}`)\n        .filter((e) =>{\n          const ancestors = e.ancestors();\n          return ancestors.findIndex( a => datumKey(a) === dk) !== -1;\n        })\n        .filter((d, i, nodes) => {\n          const item = select(nodes[i])\n          return !item.classed(className(\"isAdded\")) \n            && !item.classed(className(\"isChanged\")) \n            && !item.classed(className(\"isRemoved\"))\n            && !item.classed(className(\"groupingNode\"));\n        });\n\n      if(!leaves.empty()){\n        glyph.classed(className(\"ringMenuExcluded\"), !showHide);\n        leaves.classed(className(\"ringMenuExcluded\"), !showHide);\n      }\n    }\n  )\n\n  const newTotalText = newTotalContainer\n  .append(\"text\")\n    .classed(className(\"annotation-text\"), true)\n    .style('font-size', (d) => (2 * d.height * fontScale) + \"%\")\n    .attr('x', (d) => (getEdgePositionX(d.r, baseAngle(d))) + 7*d.height*leafRadius)\n    .attr('y', (d) => (getEdgePositionY(d.r, baseAngle(d))) - 10*d.height*leafRadius);\n\n  annotations\n  .select(`g.${className(\"total-container\")}`)\n  .select('text')\n  .merge(newTotalText)\n    .text((d) => !isNaN(d.value) ? d.value : \"0\");\n\n  //added nodes\n  const newAddedContainer = newRingMenu\n    .append('g')\n      .classed(className(\"added-container\"), true);\n  newAddedContainer\n    .append('g')\n      .classed(className(\"isAdded-fixed\"), true)\n    .append('circle')\n      .attr('r', (d) => 2 * d.height * leafRadius)\n      .attr('cx', (d) => (getEdgePositionX(d.r, baseAngle(d))) - 13.5*d.height*leafRadius)\n      .attr('cy', (d) => (getEdgePositionY(d.r, baseAngle(d))));\n\n  annotations\n  .select(`g.${className(\"added-container\")}`)\n  .merge(newAddedContainer)\n  .on(\"click\", (d, i, nodes) => {\n      const dk = datumKey(d);\n      const glyph = select(nodes[i])\n        .select(`g.${className(\"isAdded-fixed\")}`)\n      const showHide = glyph.classed(className(\"ringMenuExcluded\"));\n\n      const childGlyphs = selectAll(`g.${className(\"isAdded-fixed\")}`)\n        .filter((e) =>{\n          if(e){\n            const ancestors = e.ancestors();\n            return ancestors.findIndex( a => datumKey(a) === dk) !== -1;\n          }\n          else \n            return false;\n        });\n\n      const added = selectAll(`g.${className(\"isAdded\")}`)\n        .filter((e) =>{\n          if(e){\n            const ancestors = e.ancestors();\n            return ancestors.findIndex( a => datumKey(a) === dk) !== -1;\n          }\n          else \n            return false;\n        });\n\n      if(!added.empty()){\n        glyph.classed(className(\"ringMenuExcluded\"), !showHide);\n        childGlyphs.classed(className(\"ringMenuExcluded\"), !showHide);\n        added.classed(className(\"ringMenuExcluded\"), !showHide);\n      }\n    }\n  )   \n\n  const newAddedText = newAddedContainer\n  .append(\"text\")\n    .classed(className(\"annotation-text\"), true)\n    .style('font-size', (d) => (2 * d.height * fontScale) + \"%\")\n    .attr('x', (d) => (getEdgePositionX(d.r, baseAngle(d))) - 7.5*d.height*leafRadius)\n    .attr('y', (d) => (getEdgePositionY(d.r, baseAngle(d))));\n\n  annotations\n  .select(`g.${className(\"added-container\")}`)\n  .select('text')\n  .merge(newAddedText)\n    .text((d) => !isNaN(d.data.CRVIZ[\"_addedCount\"]) ? d.data.CRVIZ[\"_addedCount\"] : \"0\");\n\n  //changed nodes\n  const newChangedContainer = newRingMenu\n    .append('g')\n      .classed(className(\"changed-container\"), true);\n  newChangedContainer\n    .append('g')\n      .classed(className(\"isChanged-fixed\"), true)\n    .append('circle')\n      .attr('r', (d) => 2 * d.height * leafRadius)\n      .attr('cx', (d) => (getEdgePositionX(d.r, baseAngle(d))) - 0 * d.height * leafRadius)\n      .attr('cy', (d) => (getEdgePositionY(d.r, baseAngle(d))) + 10 * d.height * leafRadius);\n\n  annotations\n  .select(`g.${className(\"changed-container\")}`)\n  .merge(newChangedContainer)\n  .on(\"click\", (d, i, nodes) => {\n      const dk = datumKey(d);\n      const glyph = select(nodes[i])\n        .select(`g.${className(\"isChanged-fixed\")}`)\n      const showHide = glyph.classed(className(\"ringMenuExcluded\"));\n\n      const childGlyphs = selectAll(`g.${className(\"isChanged-fixed\")}`)\n        .filter((e) =>{\n          if(e){\n            const ancestors = e.ancestors();\n            return ancestors.findIndex( a => datumKey(a) === dk) !== -1;\n          }\n          else \n            return false;\n        });\n\n      const changed = selectAll(`g.${className(\"isChanged\")}`)\n        .filter((e) =>{\n          if(e){\n            const ancestors = e.ancestors();\n            return ancestors.findIndex( a => datumKey(a) === dk) !== -1;\n          }\n          else \n            return false;\n        });\n\n      if(!changed.empty()){\n        glyph.classed(className(\"ringMenuExcluded\"), !showHide);\n        childGlyphs.classed(className(\"ringMenuExcluded\"), !showHide);\n        changed.classed(className(\"ringMenuExcluded\"), !showHide);\n      }\n    }\n  ) \n\n  const newChangedText = newChangedContainer\n  .append(\"text\")\n    .classed(className(\"annotation-text\"), true)\n    .style('font-size', (d) => (2 * d.height * fontScale) + \"%\")\n    .attr('x', (d) => (getEdgePositionX(d.r, baseAngle(d))) + 7 * d.height * leafRadius)\n    .attr('y', (d) => (getEdgePositionY(d.r, baseAngle(d))) + 10 * d.height * leafRadius);\n\n  annotations\n  .select(`g.${className(\"changed-container\")}`)\n  .select('text')\n  .merge(newChangedText)\n    .text((d) => !isNaN(d.data.CRVIZ[\"_changedCount\"]) ?  + d.data.CRVIZ[\"_changedCount\"] : \"0\");\n\n  //removed nodes\n  const newRemovedContainer = newRingMenu\n    .append('g')\n      .classed(className(\"removed-container\"), true);\n  newRemovedContainer\n    .append('g')\n      .classed(className(\"isRemoved-fixed\"), true)\n    .append('circle')\n      .attr('r', (d) => 2 * d.height * leafRadius)\n      .attr('cx', (d) => (getEdgePositionX(d.r, baseAngle(d))) + 7.5*d.height * leafRadius)\n      .attr('cy', (d) => (getEdgePositionY(d.r, baseAngle(d))));\n\n  annotations\n  .select(`g.${className(\"removed-container\")}`)\n  .merge(newRemovedContainer)\n  .on(\"click\", (d, i, nodes) => {\n      const dk = datumKey(d);\n      const glyph = select(nodes[i])\n        .select(`g.${className(\"isRemoved-fixed\")}`)\n      const showHide = glyph.classed(className(\"ringMenuExcluded\"));\n\n      const childGlyphs = selectAll(`g.${className(\"isRemoved-fixed\")}`)\n        .filter((e) =>{\n          if(e){\n            const ancestors = e.ancestors();\n            return ancestors.findIndex( a => datumKey(a) === dk) !== -1;\n          }\n          else \n            return false;\n        });\n\n      const removed = selectAll(`g.${className(\"isRemoved\")}`)\n        .filter((e) =>{\n          if(e){\n            const ancestors = e.ancestors();\n            return ancestors.findIndex( a => datumKey(a) === dk) !== -1;\n          }\n          else \n            return false;\n        });\n\n      if(!removed.empty()){\n        glyph.classed(className(\"ringMenuExcluded\"), !showHide);\n        childGlyphs.classed(className(\"ringMenuExcluded\"), !showHide);\n        removed.classed(className(\"ringMenuExcluded\"), !showHide);\n      }\n    }\n  )    \n\n  const newRemovedText = newRemovedContainer\n  .append(\"text\")\n    .classed(className(\"annotation-text\"), true)\n    .style('font-size', (d) => (2 * d.height * fontScale) + \"%\")\n    .attr('x', (d) => (getEdgePositionX(d.r, baseAngle(d))) + 14*d.height * leafRadius)\n    .attr('y', (d) => (getEdgePositionY(d.r, baseAngle(d))));\n\n  annotations\n  .select(`g.${className(\"removed-container\")}`)\n  .select('text')\n  .merge(newRemovedText)\n    .text((d) => !isNaN(d.data.CRVIZ[\"_removedCount\"]) ? d.data.CRVIZ[\"_removedCount\"] : \"0\");\n\n  return annotations.merge(annotationsEnter);\n}\n\n//memoize is being used here to cache function returns for a specific set of parameters. \n//i.e. we will evaluate once for a radius of 10 and angle of 60\n//afterwards we will use the cached value for those parameters. \nconst memoizeKey = (r, angle) => [r, angle].join(\" \");\n\nconst baseAngle = (d) => {\n    return Math.PI / 2 - Math.acos((d.r -d.labelSize) / d.r);\n}\n\nconst getEdgePositionX = memoizeWith(memoizeKey, (r, angle) => {\n  return r * Math.cos(angle);\n});\n\nconst getEdgePositionY = memoizeWith(memoizeKey, (r, angle) => {\n  return r * Math.sin(angle);\n});\n\nexport default setupAnnotations;","import { select, event as d3Event } from \"d3-selection\";\n\nimport { ResizeSensor } from \"css-element-queries\";\nimport debounce from \"lodash.debounce\";\n\nimport {\n  allPass,\n  eqProps,\n  eqBy,\n  find,\n  map,\n  reduce,\n  reduceWhile,\n  reduced,\n  reverse,\n  tail\n} from \"ramda\";\n\nimport packWithLabel from \"./d3-viz/pack-with-label\";\nimport toHierarchy from \"./d3-viz/to-hierarchy\";\nimport appendCircles from \"./d3-viz/append-circles\";\nimport setupZoom from \"./d3-viz/setup-zoom\";\nimport setupTooltip from \"./d3-viz/setup-tooltip\";\nimport setupLegend from \"./d3-viz/setup-legend\";\nimport setupAnnotations from \"./d3-viz/setup-annotations\";\nimport datumKey from \"./d3-viz/datum-key\";\n\nfunction d3Viz(rootNode) {\n  const root = select(rootNode);\n  // const width = rootNode.clientWidth;\n  // const height = rootNode.clientHeight;\n\n  /**\n   * Stationary div that receive mouse events for zooming.\n   */\n  const zoomRoot = root\n    .append(\"div\")\n    .attr(\"data-node\", \"zoomRoot\")\n    .style(\"position\", \"relative\")\n    .style(\"width\", \"100%\")\n    .style(\"height\", \"100%\");\n\n  root.style(\"position\", \"relative\");\n\n  /**\n   * The container that is scaled and transformed.\n   *\n   * Use a div with CSS 3D transform to get hardware acceleration.\n   * SVG transform are not hardware accelerated.\n   */\n  const transformRoot = zoomRoot\n    .append(\"div\")\n    .attr(\"data-node\", \"transformRoot\")\n    .style(\"position\", \"absolute\")\n    .style(\"top\", 0)\n    .style(\"left\", 0)\n    .style(\"width\", \"100%\")\n    .style(\"height\", \"100%\")\n    .style(\"transform-origin\", \"top left\");\n\n  /**\n   * Label are placed in a separate element so that they are not scaled\n   * together with the circles.\n   */\n  const labelRoot = zoomRoot\n    .append(\"svg\")\n    .style(\"position\", \"absolute\")\n    .style(\"pointer-events\", \"none\") // Let the underlying circles get mouse events.\n    .style(\"top\", 0)\n    .style(\"left\", 0)\n    .style(\"width\", \"100%\")\n    .style(\"height\", \"100%\");\n\n  const svg = transformRoot.append(\"svg\")\n                           .style(\"overflow\", \"visible\")\n                           .attr(\"class\", \"nodeRoot\")\n\n  const tooltip = root.append(\"div\").classed(\"viz-tooltip\", true);\n  const legend = root.append(\"div\").classed(\"viz-legend\", true);\n\n  const nodeRoot = svg.append(\"g\");\n\n  const annotationRoot = svg.append(\"g\").attr(\"class\", \"annotation-root\")\n\n\n  // State\n  let props = {\n    hierarchyConfig: null,\n    data: null,\n    fields: null,\n    width: rootNode.clientWidth,\n    height: rootNode.clientHeight,\n    showNodes: true,\n    coloredField: null,\n    queryString: ''\n  };\n\n  const state = {\n    packedData: null,\n    nodes: null,\n    annotations: null,\n    labels: null,\n    countLabels: null,\n    zoom: null,\n    selectedNode: null,\n    legend: null\n  };\n\n  new ResizeSensor(rootNode, debounce(() => update(props), 100));\n\n  function update(nextProps) {\n    nextProps = {\n      ...nextProps,\n      width: rootNode.clientWidth,\n      height: rootNode.clientHeight,\n      hasSearch: nextProps.hasSearch\n    };\n\n    const dataUpdated = !allEqProps(\n      [\"hierarchyConfig\", \"data\", \"fields\", \"queryString\"],\n      props,\n      nextProps\n    );\n\n    const sizeUpdated = !allEqProps([\"width\", \"height\"], props, nextProps);\n\n    const legendUpdated = !allEqProps([\"coloredField\", \"hierarchyConfig\", \"data\"], props, nextProps);\n\n    props = nextProps;\n\n    if (dataUpdated) {\n      repack(props, state);\n      resetAnnotations(props, state);\n    }\n\n    rerender(props, state);\n\n    if (legendUpdated) {\n      resetLegend(props, state);\n    } else {\n      state.legend && state.legend.update({ nodes: state.nodes })\n    }\n\n    if (sizeUpdated || dataUpdated) {\n      resetZoom(props, state);\n    }\n  }\n\n  const repack = (props, state) => {\n    const hierarchy = makeHierarchy(props.data, props.hierarchyConfig);\n\n    const pack = packWithLabel().size([props.width, props.height]);\n\n    // Pack once without padding to calculate the radius of the leaf node\n    // then repack with new padding, similar to how d3-pack\n    // works when the size is not given.\n    //\n    // This way spacing between leaf nodes is consistent between visualizations.\n    //\n    // Doesn't seem to have a noticable performance impact.\n    const packed = pack(hierarchy);\n    const padding = packed.leaves()[0].r;\n    pack.padding((d) => padding * d.height);\n\n    state.packedData = pack(hierarchy);\n  };\n\n  const rerender = (props, state) => {\n    const [nodes] = appendCircles({\n      nodeRoot: nodeRoot,\n      labelRoot: labelRoot,\n      packedData: state.packedData,\n      showNodes: props.showNodes,\n      hasSearch: props.queryString !== ''\n    });\n\n    setupTooltip({\n      tooltip: tooltip,\n      fields: props.fields,\n      nodeRoot: nodeRoot\n    });\n\n    state.nodes = nodes;\n  };\n\n  const resetLegend = (props, state) => {\n    state.legend = setupLegend({\n      legend: legend,\n      hierarchyConfig: props.hierarchyConfig,\n      data: props.data,\n      coloredField: props.coloredField\n    });\n\n    if(state.legend != null){\n      state.legend.update({ nodes: state.nodes, annotations: state.annotations })\n    }\n  };\n\n  const resetZoom = (props, state) => {\n    state.zoom = setupZoom({\n      zoomRoot: zoomRoot,\n      transformRoot: transformRoot,\n      nodes: state.nodes,\n      width: props.width,\n      height: props.height,\n      packedData: state.packedData\n    });\n\n    let animate = true;\n\n    if (state.selectedNode) {\n      const selected = findAncestor(state.selectedNode, state.packedData);\n      state.selectedNode = selected;\n      animate = false; // smarter animation??\n    } else {\n      state.selectedNode = state.packedData;\n    }\n\n    state.zoom.zoomTo(state.selectedNode, animate);\n\n    nodeRoot.on(\"click.select\", () => {\n      const datum = select(d3Event.target).datum();\n      let zoomToNode = datum;\n      if(datum.height === 0 && datum.parent){\n        zoomToNode = datum.parent;\n      }\n      state.selectedNode = datum;\n      state.zoom.zoomTo(zoomToNode);\n    });\n  };\n\n  const resetAnnotations = (props, state) =>{\n    state.annotations = setupAnnotations({\n      packedData: state.packedData,\n      annotationRoot: annotationRoot,\n    })\n  };\n\n  return {\n    update\n  };\n}\n\nconst allEqProps = (props, o1, o2) => allPass(map(eqProps, props))(o1, o2);\n\nconst makeHierarchy = (data, hierarchyConfig) => {\n  const hierarchy = toHierarchy(data, hierarchyConfig).count();\n\n  const byUnknown = (a, b) => {\n    if (a.data.fieldValue === \"Unknown\") {\n      return b.data.fieldValue === \"Unknown\" ? 0 : 1;\n    } else {\n      return b.data.fieldValue === \"Unknown\" ? -1 : 0;\n    }\n  };\n\n  const bySize = (a, b) => (b.value || 0) - (a.value || 0);\n  const byName = (a, b) =>\n    (a.data.fieldValue || \"\").localeCompare(b.data.fieldValue || \"\");\n\n  return hierarchy.sort(composeComparators([byUnknown, bySize, byName]));\n};\n\n/**\n * Combine a list of comparator function ( (a, b) => Boolean )\n * in order into a single comparator.\n */\nconst composeComparators = (comparators) => (a, b) =>\n  reduceWhile(\n    (result) => result === 0, // keep comparing while a === b\n    (_, comparator) => comparator(a, b),\n    0,\n    comparators\n  );\n\n/**\n * Find the lowest ancestors of a node (or it self) that exists in a tree.\n */\nconst findAncestor = (node, hierarchy) => {\n  const path = reverse(node.ancestors());\n  const findChild = (parent, child) => {\n    return find(eqBy(datumKey, child), parent.children || []);\n  };\n\n  const res = reduce(\n    (last, child) => findChild(last, child) || reduced(last),\n    hierarchy,\n    tail(path)\n  );\n  return res;\n};\n\nexport default d3Viz;\n","import React from \"react\";\nimport ReactDOM from 'react-dom';\n\nimport { connect } from \"react-redux\";\n\nimport { selectDatasetIntersection, selectMergedConfiguration } from \"domain/dataset\";\nimport { getQueryString } from \"epics/index-dataset-epic\";\nimport { selectControls } from \"domain/controls\";\n\nimport d3Viz from './d3-viz';\nimport styles from './Visualization.module.css';\n\nclass Visualization extends React.PureComponent {\n\n  componentDidMount() {\n    const el = ReactDOM.findDOMNode(this);\n    this.viz = d3Viz(el);\n    this.updateFromProps();\n  }\n\n  updateFromProps() {\n    this.viz.update({\n      hierarchyConfig: this.props.controls.hierarchyConfig,\n      fields: this.props.configuration.fields || [],\n      showNodes: this.props.controls.shouldShowNodes,\n      coloredField: this.props.controls.colorBy,\n      data: this.props.dataset || [],\n      queryString: this.props.queryString\n    });\n  }\n\n  componentDidUpdate() {\n    this.updateFromProps();\n  }\n\n  render() {\n    return <div className={ styles.viz }></div>;\n  }\n}\n\nconst mapStateToProps = (state, ownProps) => {\n  return {\n    dataset: selectDatasetIntersection(state, ownProps.startUid, ownProps.endUid),\n    configuration: selectMergedConfiguration(state),\n    controls: selectControls(state),\n    queryString: getQueryString(state)\n  };\n};\n\nexport default connect(mapStateToProps, null)(Visualization);\n","import { createAction } from 'redux-actions';\nimport { ofType } from 'redux-observable';\nimport {  timer, of } from 'rxjs';\nimport { mergeMap, takeUntil, debounceTime } from 'rxjs/operators';\n\nimport { setIsFetching } from \"domain/dataset\";\nimport { fetchDataset } from './fetch-dataset-epic';\n\n// ACTIONS\nconst startRefresh = createAction('START_REFRESH_DATASET');\nconst stopRefresh = createAction('STOP_REFRESH_DATASET');\n\n// EPIC\nconst refreshDatasetEpic = (action$, store) => {\n  return action$.pipe(\n    ofType(startRefresh.toString())\n    ,debounceTime(500)\n    ,mergeMap((action) => {\n      const owner = action.payload.owner\n      const url = action.payload.url;\n      const header = action.payload.header;\n      const interval = action.payload.interval * 1000;\n      return timer(0, interval).pipe(\n          mergeMap(() => {\n            return of(\n              setIsFetching({'owner': owner, 'isFetching': true})\n              ,fetchDataset({'owner': owner, 'url': url, 'header':header})\n            )\n          })\n        ,takeUntil(action$.ofType(stopRefresh.toString()))\n        )\n    })  \n  );\n}\n\nexport default refreshDatasetEpic;\nexport { startRefresh, stopRefresh };","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { isNil, find, propEq } from \"ramda\";\n\nfunction DatasetSelector({ className, selected, datasets, onChange }) {\n  return (\n    <div className={className}>\n      <label className=\"select\">\n      <select\n        onChange={(evt) => onChange(find(eqUrl(evt.target.value), datasets)) }\n        value={isNil(selected) ? \"\" : selected.url}\n      >\n        <option value=\"\">&mdash;None&mdash;</option>\n        {datasets.map((dataset) => {\n          return (\n            <option key={dataset.url} value={dataset.url}>\n              {dataset.name}\n            </option>\n          );\n        })}\n      </select>\n      </label>\n    </div>\n  );\n}\n\nconst eqUrl = propEq(\"url\");\n\nconst PropTypesDataset = PropTypes.shape({\n  name: PropTypes.string.isRequired,\n  url: PropTypes.string.isRequired\n});\n\nDatasetSelector.propTypes = {\n  className: PropTypes.string,\n  selected: PropTypesDataset,\n  datasets: PropTypes.arrayOf(PropTypesDataset).isRequired,\n  onChange: PropTypes.func.isRequired\n};\n\nexport default DatasetSelector;\n","import React from \"react\";\nimport PropTypes from 'prop-types';\n\nimport { isNil } from \"ramda\";\n\nimport { FontAwesomeIcon }from \"@fortawesome/react-fontawesome\";\nimport { faUpload } from \"@fortawesome/free-solid-svg-icons\";\n\nfunction DatasetUpload({ className, selected, onChange, ownerUuid }) {\n  const inputId = \"file-input-\" + ownerUuid;\n  return (\n    <span className={ className }>\n      <input\n        type=\"file\"\n        id={inputId}\n        value=''\n        style={{'display':'none'}}\n        onChange={(evt) => onChange(evt.target.files[0])}\n      />\n\n    <span>\n      { isNil(selected) ? \"No file selected\" : selected }\n    </span>\n\n      <label htmlFor={inputId} className=\"button circular\" title=\"Upload data from file\">\n        <FontAwesomeIcon icon={faUpload} />\n      </label>\n    </span>\n  );\n}\n\nDatasetUpload.propTypes = {\n  ownerUuid: PropTypes.string.isRequired,\n  className: PropTypes.string,\n  selected: PropTypes.string,\n  onChange: PropTypes.func.isRequired\n};\n\nexport default DatasetUpload;\n","import React from \"react\";\nimport PropTypes from 'prop-types';\n\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faDownload } from \"@fortawesome/free-solid-svg-icons\";\n\nfunction DatasetDownload({ className, selected, url, disabled }) {\n  return (\n    <span className={ className }>\n      <a className=\"button circular\" href={ url } download={ selected + \".json\" }\n        title=\"Download\" disabled={disabled} >\n        <FontAwesomeIcon icon={faDownload} />\n      </a>\n    </span>\n  );\n}\n\nDatasetDownload.propTypes = {\n  className: PropTypes.string,\n  selected: PropTypes.string,\n  url: PropTypes.string\n};\n\nexport default DatasetDownload;\n","import React from \"react\";\nimport PropTypes from 'prop-types';\n\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faRedoAlt } from \"@fortawesome/free-solid-svg-icons\";\n\nfunction DatasetRefresh({ className, onClick, disabled }) {\n  return (\n    <span className={ className }>\n      <div className=\"button circular\" disabled={disabled} title=\"Refresh\" onClick={() => onClick()}>\n        <FontAwesomeIcon icon={faRedoAlt} />\n      </div>\n    </span>\n  );\n}\n\nDatasetRefresh.propTypes = {\n  className: PropTypes.string,\n  onClick: PropTypes.func.isRequired\n};\n\nexport default DatasetRefresh;\n","import React from \"react\";\nimport PropTypes from 'prop-types';\n\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faSyncAlt,faStopCircle } from \"@fortawesome/free-solid-svg-icons\";\n\nfunction DatasetTimedRefresh({ className, interval, timerIsRunning, disabled, onIntervalChange, onStartClick, onStopClick }) {\n  return (\n    <span className={ className }>\n      <input type='text' title=\"Refresh interval in seconds\" value={interval} onChange={(evt) => onIntervalChange(evt.target.value)}/>\n      {!timerIsRunning && \n\t      <div className=\"button circular\" disabled={disabled} title=\"Start Refresh Timer\" onClick={() => onStartClick()}>\n\t        <FontAwesomeIcon icon={faSyncAlt} />\n\t      </div>\n  \t  }\n  \t  {timerIsRunning && \n\t      <div className=\"button circular\" disabled={disabled} title=\"Stop Refresh Timer\" onClick={() => onStopClick()}>\n\t        <FontAwesomeIcon icon={faStopCircle} />\n\t      </div>\n  \t  }\n    </span>\n  );\n}\n\nDatasetTimedRefresh.propTypes = {\n  className: PropTypes.string,\n  interval: PropTypes.number,\n  timerIsRunning: PropTypes.bool,\n  onIntervalChange: PropTypes.func.isRequired,\n  onStartClick: PropTypes.func.isRequired,\n  onStopClick: PropTypes.func.isRequired\n};\n\nexport default DatasetTimedRefresh;\n","import clonedeep from \"lodash.clonedeep\";\n\nconst getDataToExport = (datasets, keyFields, ignoredFields, controls) => {\n\tlet exportData = {};\n\n\tif(datasets)\n\t\texportData[\"datasets\"] = sanitizeForExport(datasets);\n\n\tif(keyFields)\n\t\texportData[\"keyFields\"] = keyFields;\n\n\tif(ignoredFields)\n\t\texportData[\"ignoredFields\"] = ignoredFields;\n\n\tif(controls)\n\t\texportData[\"controls\"] = controls;\n\n\treturn exportData;\n}\n\nconst sanitizeForExport = (datasets) =>{\n\tlet result = clonedeep(datasets);\n\tObject.keys(result).forEach((key) => {\n\t\tresult[key].dataset.forEach((item) => {\n\t\t\tdelete item.CRVIZ;\n\t\t});\n\t});\n\treturn result;\n}\n\nexport default getDataToExport;\nexport { getDataToExport };","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\nimport { isNil } from \"ramda\";\nimport Modal from 'react-modal';\n\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { \n  faCheck, faTimes, faCog, faMinusCircle \n} from \"@fortawesome/free-solid-svg-icons\";\n\nimport { fetchDataset, buildAuthHeader } from \"epics/fetch-dataset-epic\";\nimport { startRefresh, stopRefresh } from \"epics/refresh-dataset-epic\";\nimport { uploadDataset } from \"epics/upload-dataset-epic\";\nimport { removeSearchIndex } from \"epics/index-dataset-epic\";\nimport {\n  showNodes, setHierarchyConfig, colorBy, selectControls, setStartDataset,\n  setEndDataset, showBusy\n} from \"domain/controls\"\n\nimport { setError } from \"domain/error\"\nimport { \n  setDataset, selectDataset, selectDatasets, removeDataset, \n  getIsFetching, setIsFetching, getLastUpdated, getKeyFields,\n  getIgnoredFields\n} from \"domain/dataset\";\n\nimport DatasetSelector from \"./DatasetSelector\";\nimport DatasetUpload from \"./DatasetUpload\";\nimport DatasetDownload from \"./DatasetDownload\";\nimport DatasetRefresh from \"./DatasetRefresh\";\nimport DatasetTimedRefresh from \"./DatasetTimedRefresh\";\nimport { getDataToExport } from \"./export\"\n\nimport style from \"./DatasetControls.module.css\";\n\nconst uuidv4 = require('uuid/v4');\n\nconst CUSTOM_DATASET = {\n  name: \"Custom URL\",\n  url: \"custom-url\"\n};\n\nconst UPLOAD_DATASET = {\n  name: \"Upload Dataset\",\n  url: \"upload-dataset\"\n};\n\nconst authTypes = [\n  {'name': '-None-', 'scheme':'None' },\n  {'name': 'Username\\\\Password', 'scheme':'Basic' },\n  {'name': 'Token', 'scheme':'Bearer' },\n];\n\nvar host = window.location.host;\nvar hostname = window.location.hostname;\nvar port = '80';\nconst radix = 10;\nif (host.indexOf(':') > -1) {\n  port = String(parseInt(host.split(\":\")[1], radix)-1);\n}\n\nvar POSEIDON_DATASET = {\n  name: \"Poseidon Network\",\n  url: \"http://\"+hostname+\":5000/v1/network\"\n};\n\nModal.setAppElement('#root');\n\nclass DatasetControls extends React.Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      dataset: null,\n      selected: null,\n      selectedFile: null,\n      showUrlEntry: false,\n      showUpload: false,\n      url: '',\n      authScheme:'',\n      token: '',\n      username: '',\n      password: '',\n      refreshInterval: 0,\n      refreshTimerRunning: false\n    };\n  }\n\n  resetDataset = () => {\n    this.props.setDataset({ dataset: [], owner: this.props.uuid, source: null, name:\"\", shortName:\"\",  configuration: {} });\n    this.setState({\n      selected: null,\n      selectedFile: null\n    });\n  }\n\n  fetchAndSetDataset = (url, dataset, username, password, token) => {\n    this.props.showBusy(true);\n    this.props.setIsFetching({owner: this.props.uuid, isFetching: true});\n    const authHeader = buildAuthHeader(username, password, token);\n    if (toURL(url)) {\n      this.props.fetchDataset({ \n        'owner': this.props.uuid,\n        name:this.props.name,\n        shortName: this.props.shortName,\n        'url': url,\n        'header': authHeader\n      });\n      this.setState({\n        selected: dataset,\n        selectedFile: null,\n      });\n    } else {\n      this.props.setError(new Error(\"Please enter a valid URL.\"));\n    }\n  }\n\n  onSelected = (dataset) => {\n    if (isNil(dataset)) {\n      return this.resetDataset();\n    }\n\n    this.props.removeDataset({owner: this.props.uuid});\n    this.props.removeSearchIndex({owner: this.props.uuid});\n    this.props.stopRefresh();\n\n    const showUrlEntry = dataset === CUSTOM_DATASET;\n    const showUpload = dataset === UPLOAD_DATASET;\n    this.setState({ \n      showUrlEntry: showUrlEntry,\n      showUpload: showUpload,\n      url: '',\n      authScheme:null,\n      token: '',\n      username: '',\n      password: '',\n      selected: dataset,\n      selectedFile: null,\n      refreshInterval: 0,\n      refreshTimerRunning: false,\n     });\n    if(!showUrlEntry && !showUpload)\n    {\n      const url = dataset.url;\n      this.fetchAndSetDataset(url, dataset, null, null, null);\n      this.setStartOrEnd(this.props.uuid);\n    }\n\n  }\n\n  onUpload = (file) => {\n    this.setState({\n      selectedFile: file,\n      refreshInterval: 0,\n      refreshTimerRunning: false,\n    });\n  }\n\n  onUrlChange = (evt) => {\n    this.setState({ url: evt.target.value });\n  }\n\n  onTokenChange = (evt) => {\n    this.setState({ token: evt.target.value });\n  }\n\n  onUsernameChange = (evt) => {\n    this.setState({ username: evt.target.value });\n  }\n\n  onPasswordChange = (evt) => {\n    this.setState({ password: evt.target.value });\n  }\n\n  onUrlOk = () => {\n    this.setState({ showUrlEntry: false });\n    const dataset = CUSTOM_DATASET;\n    if(!isNil(this.state.url))\n    {\n      const url = this.state.url;\n      dataset.url = url;\n      this.fetchAndSetDataset(url, dataset, this.state.username, this.state.password, this.state.token);\n      this.setStartOrEnd(this.props.uuid);\n    }\n  }\n\n  onUrlCancel = () => {\n    this.setState({ \n      showUrlEntry: false,\n      url: '',\n      authScheme:'',\n      token: '',\n      username: '',\n      password: '',\n    });\n  }\n\n  onUploadOk = () =>{\n    if(this.state.selectedFile){\n      this.props.showBusy(true);\n      this.props.uploadDataset({ \n        'owner': this.props.uuid,\n        'name':this.props.name,\n        'shortName': this.props.shortName,\n        'file': this.state.selectedFile,\n        'includeData': true,\n        'includeControls': false,\n      });\n      this.props.stopRefresh();\n      this.setState({ \n        showUpload: false,\n      });\n\n      this.setStartOrEnd(this.props.uuid);\n    }\n  }\n\n  setStartOrEnd = (uuid) =>{\n    if(!this.props.controls.start){\n        this.props.setStartDataset(uuid);\n      }\n      else if(!this.props.controls.end){\n        this.props.setEndDataset(uuid);\n      }\n  }\n\n  onUploadCancel = () => {\n    this.setState({ \n      selectedFile: null,\n      showUpload: false,\n    });\n  }\n\n  getDownloadUrl = () => {\n    const datasets = this.props.fullDatasets;\n    const controls = this.props.controls;\n    const keyFields = this.props.keyFields;\n    const ignoredFields = this.props.ignoredFields;\n    const urlObject = window.URL || window.webkitURL || window;\n    const json = JSON.stringify(getDataToExport(datasets, keyFields, ignoredFields, controls), null, 2);\n    const blob = new Blob([json], {'type': \"application/json\"});\n    const url = urlObject.createObjectURL(blob);;\n    return url;\n  }\n\n  onRefresh = () =>{\n    const url = this.state.selected.url;\n    const dataset = this.state.selected;\n    this.fetchAndSetDataset(url, dataset, this.state.username, this.state.password, this.state.token);\n  }\n\n  onTimedRefreshStart = () =>{\n    this.props.setIsFetching({'owner': this.props.uuid, 'isFetching': true});\n    this.setState({\n      'refreshTimerRunning': true\n    });\n    const authHeader = buildAuthHeader(this.state.username, this.state.password, this.state.token);\n    const url = this.state.selected.url;\n    const interval = this.state.refreshInterval;\n    this.props.startRefresh({'owner': this.props.uuid,'url': url, 'header': authHeader, 'interval': interval});\n  }\n\n  onTimedRefreshStop = () =>{\n    this.setState({\n      'refreshTimerRunning': false\n    });\n    this.props.stopRefresh();\n  }\n\n  removeDatasetEntry = () =>{\n    this.props.removeDatasetEntry(this.props.uuid);\n  }\n\n  onTimedRefreshIntervalChanged = (interval) =>{\n    const numInt = parseInt(interval, 10);\n    if(!isNaN(numInt)){\n      this.setState({\n        refreshInterval: numInt,\n      });\n    }\n    else if(!interval){\n      this.setState({\n        refreshInterval: null,\n      });\n    }\n  }\n\n  render() {\n    if (port === '80') {\n      POSEIDON_DATASET = {name:\"\",url:\"\"};\n    }\n    const canDownload = this.state.selected && !this.state.selectedFile;\n    const canRefresh = this.state.selected && !isNil(this.state.selected.url) && !this.state.selectedFile;\n    let url = null;\n    try{\n      url = new URL(this.props.source);\n    }\n    catch(err){\n      if(err instanceof TypeError){\n        url = null;\n      }\n      else {\n        throw err;\n      }\n    }\n    return (\n      <div className={style.dataControls}>\n        <div key={ this.props.uuid + \"_label\" } className={style.dataControlHeader}>\n          {this.props.name}\n          {this.props.removable && <FontAwesomeIcon icon={faMinusCircle} \n          onClick={ this.removeDatasetEntry } \n          />}\n        </div>\n        <div className={style.selectorContainer}>\n          <span className={style.label}>Dataset</span>\n          <DatasetSelector\n            className={style.selector}\n            selected={this.state.selected}\n            onChange={this.onSelected}\n            datasets={[...this.props.datasets, POSEIDON_DATASET, CUSTOM_DATASET, UPLOAD_DATASET]}\n            source={this.props.source}\n          />\n        </div>\n          <div className={style.datasetSourceContainer}>\n            { this.props.source &&\n              <span>\n               Source:&nbsp; \n               { url && \n                <a href={url}>\n                  {this.props.source}\n                </a>\n               }\n               { !url &&\n                this.props.source\n               }\n              </span>\n            }\n          </div>\n          <div className={style.utilityContainer}>\n          { canDownload &&\n            <DatasetDownload\n              className={style.fileDownload}\n              selected={this.state.selected.name}\n              url={this.getDownloadUrl()}\n              disabled={this.props.isFetching}\n            />\n          }\n          { canRefresh &&\n            <div className={style.urlRefreshContainer}>\n              <DatasetRefresh\n                className={style.urlRefresh}\n                onClick={this.onRefresh}\n                disabled={this.props.isFetching}\n              />\n              <DatasetTimedRefresh\n                className={style.urlRefresh}\n                interval={this.state.refreshInterval}\n                timerIsRunning={this.state.refreshTimerRunning}\n                disabled={this.props.isFetching}\n                onIntervalChange={this.onTimedRefreshIntervalChanged}\n                onStartClick={this.onTimedRefreshStart}\n                onStopClick={this.onTimedRefreshStop}\n              />\n            </div>\n          }\n          </div>\n          <div className={style.urlRefreshTime}>\n            { canRefresh && this.props.isFetching &&\n              <span>\n                <FontAwesomeIcon className=\"fa-spin\" icon={faCog} /> Fetching Data...\n              </span>\n            }\n            { canRefresh && !this.props.isFetching &&\n              <span>\n                Last Updated: { this.props.lastUpdated ? (this.props.lastUpdated.toLocaleDateString() || \"\") + \" \" + (this.props.lastUpdated.toLocaleTimeString() || \"\") : \"Never\" }\n              </span>\n            }\n          </div>\n          <Modal isOpen={ this.state.showUrlEntry } onRequestClose={this.onUrlCancel} contentLabel=\"Enter a Url\">\n            <div className={ style.modal }>\n              <div className={ style.modalMain }>\n                <span>\n                  <label> URL </label>\n                  <input type=\"text\" value={this.state.url} onChange={ this.onUrlChange }/>\n                </span>\n                <span>\n                  <label> AuthType </label>\n                  <label className=\"select\">\n                    <select\n                      onChange={(evt) => this.setState({ authScheme: evt.target.value })}\n                      value={isNil(this.state.authScheme) ? '' : this.state.authScheme}\n                    >\n                      {authTypes.map((at) => {\n                        return (\n                          <option key={at.scheme} value={at.scheme}>\n                            {at.name}\n                          </option>\n                        );\n                      })}\n                    </select>\n                  </label>\n                </span>\n                { this.state.authScheme === 'Bearer' &&\n                  <span>\n                    <label> Token </label>\n                    <input type=\"text\" value={this.state.Token} onChange={ this.onTokenChange }/>\n                  </span> \n                }\n                { this.state.authScheme === 'Basic' &&\n                  <div>\n                    <span>\n                      <label> Username </label>\n                      <input type=\"text\" value={this.state.userName} onChange={ this.onUsernameChange }/>\n                    </span>\n                    <span>\n                      <label> Password </label>\n                      <input type=\"password\" value={this.state.password} onChange={ this.onPasswordChange }/>\n                    </span>\n                  </div>\n                }\n                <div>\n                  <span className={ style.centerSpan }>\n                    <div className=\"button circular\" title=\"Ok\" onClick={this.onUrlOk}>\n                        <FontAwesomeIcon icon={faCheck} />\n                    </div>\n                    <div className=\"button circular\" title=\"Cancel\" onClick={this.onUrlCancel}>\n                        <FontAwesomeIcon icon={faTimes} />\n                    </div>\n                  </span>\n                </div>\n              </div>\n            </div>\n          </Modal>\n          <Modal isOpen={ this.state.showUpload } onRequestClose={this.onUploadCancel} contentLabel=\"Upload a File\">\n            <div className={ style.modal }>\n              <div className={ style.modalMain }>\n                  <div className={style.uploadContainer}>\n                    <span className={style.label}>Upload</span>\n                    <DatasetUpload\n                      ownerUuid={this.props.uuid}\n                      className={style.fileUpload}\n                      selected={this.state.selectedFile ? this.state.selectedFile.name : null}\n                      onChange={this.onUpload}\n                    />\n                  </div>\n                  <span className={ style.centerSpan }>\n                    <div className=\"button circular\" title=\"Ok\" onClick={this.onUploadOk}>\n                        <FontAwesomeIcon icon={faCheck} />\n                    </div>\n                    <div className=\"button circular\" title=\"Cancel\" onClick={this.onUploadCancel}>\n                        <FontAwesomeIcon icon={faTimes} />\n                    </div>\n                  </span>\n              </div>\n            </div>\n          </Modal>\n      </div>\n    );\n  }\n}\n\nconst toURL = (url) => {\n  try {\n    return new URL(url)\n  } catch(error) {\n    if (error instanceof TypeError) {\n      return null;\n    } else {\n      throw error;\n    }\n  }\n}\n\nDatasetControls.defaultProps = {\n  uuid: uuidv4(),\n  datasets: [],\n  dataset: null,\n  hierarchyConfig: [],\n  configHasChanged: false,\n  isFetching: false,\n  lastUpdated: new Date(),\n  \n};\n\nDatasetControls.propTypes = {\n  uuid: PropTypes.string,\n  datasets: PropTypes.array,\n  dataset: PropTypes.array,\n  fetchDataset: PropTypes.func.isRequired,\n  uploadDataset: PropTypes.func.isRequired,\n  setDataset: PropTypes.func.isRequired,\n  setStartDataset: PropTypes.func.isRequired,\n  setEndDataset: PropTypes.func.isRequired,\n  removeDataset: PropTypes.func.isRequired,\n  removeSearchIndex: PropTypes.func.isRequired,\n  getIsFetching: PropTypes.func.isRequired,\n  setIsFetching: PropTypes.func.isRequired,\n  showNodes: PropTypes.func.isRequired,\n  setHierarchyConfig: PropTypes.func.isRequired, \n  colorBy: PropTypes.func.isRequired,\n  startRefresh: PropTypes.func.isRequired,\n  stopRefresh: PropTypes.func.isRequired,\n  removeDatasetEntry: PropTypes.func.isRequired,\n  isFetching: PropTypes.bool,\n  lastUpdated: PropTypes.instanceOf(Date),\n  setError: PropTypes.func.isRequired,\n  hierarchyConfig: PropTypes.array,\n  configHasChanged: PropTypes.bool,\n  fullDatasets: PropTypes.object,\n  controls: PropTypes.object,\n  keyFields: PropTypes.array,\n  ignoredFields: PropTypes.array,\n  showBusy: PropTypes.func.isRequired,\n};\n\nconst mapStateToProps = (state, ownProps) => {\n  const owner = ownProps.uuid;\n  const fullDatasets = selectDatasets(state)\n  return {\n    dataset: (owner in fullDatasets) ? fullDatasets[owner].dataset : [],\n    source: (owner in fullDatasets) ? fullDatasets[owner].source : null,\n    isFetching: getIsFetching(state, owner),\n    lastUpdated: getLastUpdated(state, owner),\n    fullDatasets: fullDatasets,\n    controls: selectControls(state),\n    keyFields: getKeyFields(state),\n    ignoredFields: getIgnoredFields(state)\n  };\n}\n\nconst mapDispatchToProps = {\n  fetchDataset,\n  uploadDataset,\n  setDataset,\n  setStartDataset,\n  setEndDataset,\n  selectDataset,\n  removeDataset,\n  removeSearchIndex,\n  getIsFetching,\n  setIsFetching,\n  showNodes,\n  setHierarchyConfig, \n  colorBy,\n  startRefresh,\n  stopRefresh,\n  setError,\n  showBusy\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(DatasetControls);\n","// @flow weak\n\nimport React, { Fragment } from \"react\";\nimport PropTypes from \"prop-types\";\n\n// *******************************************************\n// RAIL\n// *******************************************************\nconst railOuterStyle = {\n  position: \"absolute\",\n  width: \"100%\",\n  height: 42,\n  transform: \"translate(0%, -50%)\",\n  borderRadius: 7,\n  cursor: \"pointer\"\n  // border: '1px solid white',\n};\n\nconst railInnerStyle = {\n  position: \"absolute\",\n  width: \"100%\",\n  height: 14,\n  transform: \"translate(0%, -50%)\",\n  borderRadius: 7,\n  pointerEvents: \"none\",\n  backgroundColor: \"rgb(155,155,155)\"\n};\n\nexport function SliderRail({ getRailProps }) {\n  return (\n    <Fragment>\n      <div style={railOuterStyle} {...getRailProps()} />\n      <div style={railInnerStyle} />\n    </Fragment>\n  );\n}\n\nSliderRail.propTypes = {\n  getRailProps: PropTypes.func.isRequired\n};\n\n// *******************************************************\n// HANDLE COMPONENT\n// *******************************************************\nexport function Handle({\n  domain: [min, max],\n  handle: { id, value, percent },\n  disabled,\n  getHandleProps\n}) {\n  return (\n    <Fragment>\n      <div\n        style={{\n          left: `${percent}%`,\n          position: \"absolute\",\n          transform: \"translate(-50%, -50%)\",\n          WebkitTapHighlightColor: \"rgba(0,0,0,0)\",\n          zIndex: 5,\n          width: 28,\n          height: 42,\n          cursor: \"pointer\",\n          // border: '1px solid white',\n          backgroundColor: \"none\"\n        }}\n        {...getHandleProps(id)}\n      />\n      <div\n        role=\"slider\"\n        aria-valuemin={min}\n        aria-valuemax={max}\n        aria-valuenow={value}\n        style={{\n          left: `${percent}%`,\n          position: \"absolute\",\n          transform: \"translate(-50%, -50%)\",\n          zIndex: 2,\n          width: 24,\n          height: 24,\n          borderRadius: \"50%\",\n          boxShadow: \"1px 1px 1px 1px rgba(0, 0, 0, 0.3)\",\n          backgroundColor: disabled ? \"#666\" : \"#0277BD\"\n        }}\n      />\n    </Fragment>\n  );\n}\n\nHandle.propTypes = {\n  domain: PropTypes.array.isRequired,\n  handle: PropTypes.shape({\n    id: PropTypes.string.isRequired,\n    value: PropTypes.number.isRequired,\n    percent: PropTypes.number.isRequired\n  }).isRequired,\n  getHandleProps: PropTypes.func.isRequired,\n  disabled: PropTypes.bool\n};\n\nHandle.defaultProps = {\n  disabled: false\n};\n\n// *******************************************************\n// KEYBOARD HANDLE COMPONENT\n// Uses a button to allow keyboard events\n// *******************************************************\nexport function KeyboardHandle({\n  domain: [min, max],\n  handle: { id, value, percent },\n  disabled,\n  getHandleProps\n}) {\n  return (\n    <button\n      role=\"slider\"\n      aria-valuemin={min}\n      aria-valuemax={max}\n      aria-valuenow={value}\n      style={{\n        left: `${percent}%`,\n        position: \"absolute\",\n        transform: \"translate(-50%, -50%)\",\n        zIndex: 2,\n        width: 24,\n        height: 24,\n        borderRadius: \"50%\",\n        boxShadow: \"1px 1px 1px 1px rgba(0, 0, 0, 0.3)\",\n        backgroundColor: disabled ? \"#666\" : \"#0277BD\"\n      }}\n      {...getHandleProps(id)}\n    />\n  );\n}\n\nKeyboardHandle.propTypes = {\n  domain: PropTypes.array.isRequired,\n  handle: PropTypes.shape({\n    id: PropTypes.string.isRequired,\n    value: PropTypes.number.isRequired,\n    percent: PropTypes.number.isRequired\n  }).isRequired,\n  getHandleProps: PropTypes.func.isRequired,\n  disabled: PropTypes.bool\n};\n\nKeyboardHandle.defaultProps = {\n  disabled: false\n};\n\n// *******************************************************\n// TRACK COMPONENT\n// *******************************************************\nexport function Track({ source, target, getTrackProps, disabled }) {\n  return (\n    <div\n      style={{\n        position: \"absolute\",\n        transform: \"translate(0%, -50%)\",\n        height: 14,\n        zIndex: 1,\n        backgroundColor: disabled ? \"#999\" : \"#014065\",\n        borderRadius: 7,\n        cursor: \"pointer\",\n        left: `${source.percent}%`,\n        width: `${target.percent - source.percent}%`\n      }}\n      {...getTrackProps()}\n    />\n  );\n}\n\nTrack.propTypes = {\n  source: PropTypes.shape({\n    id: PropTypes.string.isRequired,\n    value: PropTypes.number.isRequired,\n    percent: PropTypes.number.isRequired\n  }).isRequired,\n  target: PropTypes.shape({\n    id: PropTypes.string.isRequired,\n    value: PropTypes.number.isRequired,\n    percent: PropTypes.number.isRequired\n  }).isRequired,\n  getTrackProps: PropTypes.func.isRequired,\n  disabled: PropTypes.bool\n};\n\nTrack.defaultProps = {\n  disabled: false\n};\n\n// *******************************************************\n// TICK COMPONENT\n// *******************************************************\nexport function Tick({ tick, count, format }) {\n  return (\n    <div>\n      <div\n        style={{\n          position: \"absolute\",\n          marginTop: 14,\n          width: 1,\n          height: 5,\n          backgroundColor: \"rgb(200,200,200)\",\n          left: `${tick.percent}%`\n        }}\n      />\n      <div\n        style={{\n          position: \"absolute\",\n          marginTop: 22,\n          fontSize: 10,\n          textAlign: \"center\",\n          marginLeft: `${-(100 / count) / 2}%`,\n          width: `${100 / count}%`,\n          left: `${tick.percent}%`\n        }}\n      >\n        {format(tick.value)}\n      </div>\n    </div>\n  );\n}\n\nTick.propTypes = {\n  tick: PropTypes.shape({\n    id: PropTypes.string.isRequired,\n    value: PropTypes.number.isRequired,\n    percent: PropTypes.number.isRequired\n  }).isRequired,\n  count: PropTypes.number.isRequired,\n  format: PropTypes.func.isRequired\n};\n\nTick.defaultProps = {\n  format: d => d\n};\n","import React from 'react';\n//import PropTypes from 'prop-types';\n\nimport { connect } from 'react-redux';\n\nimport { Slider, Rail, Handles, Tracks, Ticks } from \"react-compound-slider\";\n\nimport { SliderRail, Handle, Track, Tick } from \"features/slider-utils/slider-components\"; \n\nclass DatasetSlider extends React.Component {\n    state = {\n      start: null,\n      end: null,\n      labelMode: \"long\",   // mid, long\n    }\n    \n    onDragEnter = (e) => {\n      e.preventDefault();\n    }\n\n    onDragOver = (e) => {\n      e.preventDefault();\n    }\n    \n    onDragStart = (e) => {\n      const slider  = e.target.dataset.slider;\n      e.dataTransfer.setData(\"text/plain\", slider);\n    }\n    \n    onDrop = (e) => {\n      e.preventDefault();\n      const source = e.dataTransfer.getData(\"text/plain\");\n      const slot = Number(e.target.dataset.slot);\n      const points = this.props.points;\n      if(isNaN(slot)) return;\n\n      if (source === \"min\") {\n        this.props.setStartUuid(points[slot]);\n      } else if (source === \"max\") {\n        this.props.setEndUuid(points[slot]);     }\n    }\n\n    onSlotClick = (e) => {\n      const slot = Number(e.target.dataset.slot);\n\n      if (isNaN(slot)) return;\n      \n      const points = this.props.points;\n      if(points.indexOf(this.props.startUuid) === -1){\n        this.props.setStartUuid(points[slot]);\n      }\n      else if (points.indexOf(this.props.endUuid) === -1){\n        this.props.setEndUuid(points[slot]);\n      }\n    }\n\n    onHandleClick = (e) => {\n    }\n\n    onUpdate = (e) =>{\n\n    }\n\n    onChange = (e) =>{\n      const start = e.length > 1 ? this.props.points[e[0]] : null;\n      const end = e.length > 1 ? this.props.points[e[1]] : this.props.points[e[0]];\n      \n      if(start){\n        this.props.setStartUuid(start.owner);\n      }\n      if(end){\n        this.props.setEndUuid(end.owner);\n      }\n    }\n    \n    formatTicks = (t) => {\n      if(this.props.points && this.props.points[t]){\n        return this.props.points[t].shortName;\n      }\n      else {\n        return \"\";\n      }\n    };\n   \n    render() {\n      const points = this.props.points;\n      const startUuid = this.props.startUuid;\n      const endUuid = this.props.endUuid;\n\n      const sliderStyle = {\n        position: \"relative\",\n        width: \"100%\"\n      };\n\n      const domain = [0, Math.max(points.length -1, 0.1) ];\n      \n      const startIdx = points.findIndex( p => p.owner === startUuid);\n      const endIdx = points.findIndex( p => p.owner === endUuid);\n      const defaultValues = [startIdx, endIdx];\n\n      // if(startIdx >= 0){\n      //   defaultValues.push(startIdx);\n      // }\n      // if(endIdx >= 0 && endIdx > startIdx){\n      //   defaultValues.push(endIdx);\n      // }\n     \n      return (\n       <div style={{ margin: \"10%\", height: 60 }}>\n        <Slider\n          mode={1}\n          step={1}\n          domain={domain}\n          rootStyle={sliderStyle}\n          onUpdate={this.onUpdate}\n          onChange={this.onChange}\n          values={defaultValues}\n        >\n          <Rail>\n            {({ getRailProps }) => <SliderRail getRailProps={getRailProps} />}\n          </Rail>\n          <Handles>\n            {({ handles, getHandleProps }) => (\n              <div className=\"slider-handles\">\n                {handles.map(handle => (\n                  <Handle\n                    key={handle.id}\n                    handle={handle}\n                    domain={domain}\n                    getHandleProps={getHandleProps}\n                  />\n                ))}\n              </div>\n            )}\n          </Handles>\n          <Tracks left={false} right={false}>\n            {({ tracks, getTrackProps }) => (\n              <div className=\"slider-tracks\">\n                {tracks.map(({ id, source, target }) => (\n                  <Track\n                    key={id}\n                    source={source}\n                    target={target}\n                    getTrackProps={getTrackProps}\n                  />\n                ))}\n              </div>\n            )}\n          </Tracks>\n          <Ticks count={points.length}>\n            {({ ticks }) => (\n              <div className=\"slider-ticks\">\n                {ticks.map(tick => (\n                  <Tick key={tick.id} tick={tick} count={ticks.length} format={this.formatTicks} />\n                ))}\n              </div>\n            )}\n          </Ticks>\n        </Slider>\n      </div>\n      );\n    }\n}      \n\n\n\n// const mapStateToProps = (state, ownProps) => {\n\n// }\n\n// const mapDispatchToProps = {\n /*<div>\n          <div>\n            <div className={style.sliderContainer}>\n             \n             <div className={style.sliderScale}>\n                 {scale}\n              </div>\n        \n              <div className={style.slider}>\n                  {slider}\n              </div>\n             \n              <div className={style.sliderSelectedScale}>\n                  {currentScale}\n              </div>\n             \n            </div>\n          </div>\n        </div>*/\n// };\n\nexport default connect(null, null)(DatasetSlider);","import React, { Component } from \"react\";\nimport { connect } from 'react-redux';\nimport classNames from 'classnames';\nimport Modal from 'react-modal';\n\nimport { RingLoader } from 'react-spinners';\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { \n  faCheck, faDizzy, faPlus, faHome, faAngleDoubleDown, faAngleDoubleUp,\n  faFileExport, faFileImport, faTimes\n} from \"@fortawesome/free-solid-svg-icons\";\n\nimport { \n  selectDatasets, getLastUpdated, removeDataset,getKeyFields, getIgnoredFields\n} from 'domain/dataset';\nimport { \n  setHierarchyConfig, showNodes, colorBy, selectControls, setStartDataset, setEndDataset,\n  showBusy\n} from 'domain/controls';\nimport { getError, clearError } from \"domain/error\";\nimport { removeSearchIndex } from \"epics/index-dataset-epic\";\nimport { uploadDataset } from \"epics/upload-dataset-epic\";\n\nimport Header from 'features/header/Header';\nimport HierarchySelector from 'features/hierarchy-selector/HierarchySelector';\nimport ComparisonSelector from 'features/comparison-selector/ComparisonSelector';\nimport MiscControls from 'features/misc-controls/MiscControls';\nimport SearchControls from 'features/search/SearchControls';\nimport Visualization from 'features/visualization/Visualization';\nimport DatasetControls from 'features/dataset-controls/DatasetControls';\nimport DatasetSlider from 'features/dataset-controls/DatasetSlider';\nimport DatasetUpload from 'features/dataset-controls/DatasetUpload';\nimport { getDataToExport } from \"features/dataset-controls/export\"\n\nimport style from './App.module.css';\n\nimport datasets from './datasets';\n\nconst uuidv4 = require('uuid/v4');\n\nModal.setAppElement('#root');\nconst IMPORT = \"import\";\nconst EXPORT = \"export\";\nconst DATA = \"data\";\nconst CONTROLS = \"controls\";\nconst defaultOptions = {\n      action: \"\",\n      data: true,\n      controls: true\n    }\nclass App extends Component {\n\n  state = {\n    showData: true,\n    showGrouping: false,\n    showFiltering: false,\n    uuids: [{'owner': uuidv4(), 'name': 'Series 0', 'shortName': 's0'}],\n    datasetAdded: false,\n    startUuid: null,\n    endUuid: null,\n    showOptions: false,\n    options:{\n      action: \"\",\n      data: true,\n      controls: true\n    },\n    selectedFile: null,\n    exportName: \"dataset.json\",\n  }\n\n  componentWillReceiveProps = (nextProps) =>{\n    const datasetAdded = this.state.datasetAdded && (nextProps.uuids.length !== this.state.uuids.length)\n    const uniqueUuids = this.getUniqueDatasetList(datasetAdded, this.state.uuids, nextProps.uuids);\n    const startUuid = nextProps.startUuid && uniqueUuids.findIndex(u => u.owner === nextProps.startUuid) !== -1 ? nextProps.startUuid : this.state.startUuid;\n    const endUuid = nextProps.endUuid && uniqueUuids.findIndex(u => u.owner === nextProps.endUuid) !== -1 ? nextProps.endUuid : this.state.endUuid;\n    this.setState({\n      uuids: uniqueUuids,\n      startUuid: startUuid,\n      endUuid: endUuid,\n      datasetAdded: datasetAdded,\n    });\n  }\n\n  getUniqueDatasetList = (datasetAdded, uuidsFromState, uuidsFromProps) => {\n    let result = [];\n\n    if(datasetAdded || uuidsFromProps.length === 0){\n      const uniqueOwners = new Set();\n      uuidsFromProps.concat(uuidsFromState).forEach((u) => {\n        if(!uniqueOwners.has(u.owner)){\n          uniqueOwners.add(u.owner);\n          result.push(u);\n        }\n      });\n    }\n    else {\n      result = uuidsFromProps;\n    }\n\n    return result;\n  }\n\n  toggleShowData = () =>{\n    this.setState({\n      showData: !this.state.showData,\n      showComparison: false,\n      showGrouping: false,\n      showFiltering: false,\n    });\n  }\n\n  toggleShowComparison = () =>{\n    this.setState({\n      showData: false,\n      showComparison: !this.state.showComparison,\n      showGrouping: false,\n      showFiltering: false\n    });\n  }\n\n  toggleShowGrouping = () =>{\n    this.setState({\n      showData: false,\n      showComparison: false,\n      showGrouping: !this.state.showGrouping,\n      showFiltering: false\n    });\n  }\n\n  toggleShowFiltering = () =>{\n    this.setState({\n      showData: false,\n      showComparison: false,\n      showGrouping: false,\n      showFiltering: !this.state.showFiltering\n    });\n  }\n\n  onErrorClose = () => {\n    this.props.clearError();\n  }\n\n  resetControls = () => {\n    this.props.colorBy(null);\n    this.props.setHierarchyConfig([]);\n    this.props.showNodes(true);\n  }\n\n  showImportOptions = () => {\n    this.showOptions(IMPORT);\n  }\n\n  showExportOptions = () => {\n    this.showOptions(EXPORT);\n  }\n\n  showOptions = (action) => {\n    this.setOptions(\"action\", action);\n    this.setState({showOptions: true})\n  }\n\n  processOptions = () => {\n    if(this.state.options.action === IMPORT)\n    {\n      this.props.showBusy(true);\n      if(this.state.selectedFile){\n        this.props.uploadDataset({\n          'owner': uuidv4(),\n          'file': this.state.selectedFile,\n          'includeData': this.state.options.data,\n          'includeControls': this.state.options.controls,\n        })\n      }\n      this.setState({showOptions: false })\n    }\n  }\n\n  onUpload = (file) => {\n    this.setState({\n      selectedFile: file,\n    });\n  }\n\n  getDownloadUrl = () => {\n    const datasets = this.state.options.data && this.props.fullDatasets;\n    const controls = this.state.options.controls && this.props.controls;\n    const keyFields = this.state.options.data && this.props.keyFields;\n    const ignoredFields = this.state.options.data && this.props.ignoredFields;\n    const exportData = getDataToExport(datasets, keyFields, ignoredFields, controls)\n    const urlObject = window.URL || window.webkitURL || window;\n    const json = JSON.stringify(exportData, null, 2);\n    const blob = new Blob([json], {'type': \"application/json\"});\n    const url = urlObject.createObjectURL(blob);;\n    return url;\n  }\n\n  exportNameChange = (name) => {\n    this.setState({\n      exportName: name,\n    });\n  }\n\n  cancelOptions = () => {\n    this.setState({\n      showOptions: false,\n      options: defaultOptions\n    })\n  }\n\n  setOptions = (key, value) => {\n    const options = this.state.options;\n    options[key] = value;\n    this.setState({options: options});\n  }\n\n  addDatasetEntry = () => {\n    const uuids = this.state.uuids;\n    const newItem = { 'owner': uuidv4(), 'name': 'Series ' + uuids.length, 'shortName': 's' + uuids.length };\n    uuids.push(newItem);\n    this.setState({\n      uuids: uuids,\n      datasetAdded: true\n    });\n  }\n\n  removeDatasetEntry = (uuid) =>{\n    const uuids = this.state.uuids;\n    if(uuids.includes(uuid)){\n      const newUuids = uuids.splice(uuids.indexOf(uuid), 1);\n      this.setState({uuids: newUuids})\n    }\n    this.props.removeSearchIndex({'owner': uuid});\n    this.props.removeDataset({'owner': uuid});\n  }\n\n  setStartUuid = (uuid) =>{\n    this.setState({startUuid: uuid});\n    this.props.setStartDataset(uuid);\n  }\n\n  setEndUuid = (uuid) =>{\n    this.setState({endUuid: uuid});\n    this.props.setEndDataset(uuid);\n  }\n\n  render() {\n    const { datasetCount, darkTheme, error, lastUpdated} = this.props;\n    const hasDataset = datasetCount > 0;\n\n    const uuids = this.state.uuids;\n    const startUuid = this.state.startUuid;\n    const endUuid = this.state.endUuid;\n    const showData = this.state.showData;\n    const showComparison = this.state.showComparison;\n    const showGrouping = this.state.showGrouping;\n    const showOptions = this.state.showOptions;\n    const options = this.state.options;\n\n    return (\n      <div className={\n          classNames({\n            [style.appContainer]: true,\n            'darkTheme': darkTheme\n          })\n      }>\n        <input name=\"hideControls\" id=\"hideControls\" type=\"checkbox\" />\n        <label htmlFor=\"hideControls\" className={ style.hideControls }>\n          { /* <FontAwesomeIcon icon={faChevron} /> */ }\n          <span>&lt;&lt;</span>\n        </label>\n        <div className={ style.controls }>\n          <Header />\n          <div className={ classNames({ [style.centerSpan]: true }) }>\n            <div className=\"button circular\" title=\"Reset Controls\" size=\"3x\" onClick={this.resetControls}>\n              <FontAwesomeIcon icon={faHome} />\n            </div>\n          </div>\n          <div className={style.accordionHeader} onClick={this.toggleShowData}>\n            Data  {!showData && <FontAwesomeIcon icon={faAngleDoubleDown} />}{showData && <FontAwesomeIcon onClick={this.toggleShowData} icon={faAngleDoubleUp} />}\n          </div>\n          <div className={ classNames({ [style.section]: true, [style.hidden]: !showData })}>\n            {uuids.map((uuid) => {\n              return(\n                <div  key={ uuid.owner + \"_container\" } >\n                  <DatasetControls \n                    uuid={ uuid.owner }\n                    name={ uuid.name }\n                    shortName={ uuid.shortName }\n                    removeDatasetEntry={ this.removeDatasetEntry }\n                    removable={uuids.length > 1}\n                    datasets={ datasets }/>\n                </div>\n              )\n            })}\n            <span className={ style.centerSpan }>\n              <div className=\"button circular\" title=\"Add Dataset\" onClick={this.addDatasetEntry}>\n                <FontAwesomeIcon icon={faPlus} />\n              </div>\n            </span>\n          </div>\n\n          { hasDataset &&\n            <div className={ classNames({ [style.section]: true, [style.hidden]: !showData }) }>\n              <SearchControls />\n            </div>\n          }\n\n          <div className={style.accordionHeader} onClick={this.toggleShowGrouping}>\n            Grouping  {!showGrouping && <FontAwesomeIcon icon={faAngleDoubleDown} />}{showGrouping && <FontAwesomeIcon  onClick={this.toggleShowGrouping} icon={faAngleDoubleUp} />}\n          </div>\n          { hasDataset &&\n            <div className={ classNames({ [style.section]: true, [style.hierarchySection]: true, [style.hidden]: !showGrouping }) }>\n              <HierarchySelector />\n            </div>\n          }\n\n          { hasDataset &&\n            <div className={ classNames({ [style.section]: true, [style.hidden]: !showGrouping }) }>\n              <MiscControls />\n            </div>\n          }\n          { !hasDataset && \n            <div className={ classNames({ [style.section]: true, [style.dimSection]:true, [style.hierarchySection]: true, [style.hidden]: !showGrouping }) }>\n              Please select a dataset to continue\n            </div>\n          }\n\n          <div className={style.accordionHeader} onClick={this.toggleShowComparison}>\n            Comparison  {!showComparison && <FontAwesomeIcon icon={faAngleDoubleDown} />}{showComparison && <FontAwesomeIcon  onClick={this.toggleShowComparison} icon={faAngleDoubleUp} />}\n          </div>\n          { datasetCount >= 2 &&\n            <div className={ classNames({ [style.section]: true, [style.hierarchySection]: true, [style.hidden]: !showComparison }) }>\n              <ComparisonSelector startUid={startUuid} endUid={endUuid} />\n            </div>\n          }\n          { datasetCount < 2 && \n            <div className={ classNames({ [style.section]: true, [style.dimSection]:true, [style.hierarchySection]: true, [style.hidden]: !showComparison }) }>\n              Please select at least 2 datasets to continue\n            </div>\n          }\n          \n          <div className={style.footerContainer}>\n            <span className={ style.centerSpan }>\n                <div className=\"button circular\" title=\"Import Dataset\" onClick={this.showImportOptions}>\n                  <FontAwesomeIcon icon={faFileImport} />\n                </div>\n                <div className=\"button circular\" disabled={!hasDataset} title=\"Export Dataset\" onClick={this.showExportOptions}>\n                  <FontAwesomeIcon icon={faFileExport} />\n                </div>\n            </span>\n          </div>\n        </div>\n        { datasetCount === 0 && lastUpdated !== null &&\n          <div  className={ style.emptyDataset }>\n            <span>\n              Current dataset is empty\n            </span>\n          </div>\n        }\n\n        <div className={ style.canvas }>\n          <Visualization startUid={startUuid} endUid={endUuid} />\n        </div>\n        <div className={classNames({ [style.key]: true, [style.hidden]: datasetCount < 2 }) }>\n          <svg width=\"100%\" height=\"60\">\n            <g>\n              <g className=\"viz-isAdded-fixed\">\n                <circle cx=\"15\" cy=\"15\" r=\"10\"/>\n              </g>\n              <text x=\"30\" y=\"15\">Added</text>\n            </g>\n            <g>\n              <g className=\"viz-isChanged-fixed\">\n                <circle cx=\"100\" cy=\"15\" r=\"10\"/>\n              </g>\n              <text x=\"115\" y=\"15\">Changed</text>\n            </g>\n            <g>\n              <g className=\"viz-isRemoved-fixed\">\n                <circle cx=\"200\" cy=\"15\" r=\"10\"/>\n              </g>\n              <text x=\"215\" y=\"15\">Removed</text>\n            </g>\n          </svg>\n        </div>\n        <div className={ classNames({ [style.sliderContainer]: true, [style.hidden]: datasetCount < 2 }) } >\n          <DatasetSlider points={uuids} startUuid={startUuid} endUuid={endUuid} \n            setStartUuid={this.setStartUuid} setEndUuid={this.setEndUuid} />\n        </div>\n        <Modal isOpen={ error !== null } onRequestClose={this.onErrorClose} contentLabel=\"An Error has occurred\">\n            <div className={ style.modal }>\n              <div className={ style.modalMain }>\n                <span className={ style.justifySpan }>\n                   <div className={ style.icon } title=\"Error\">\n                        <FontAwesomeIcon icon={faDizzy} size=\"7x\" color=\"#cc0000\"/>\n                    </div>\n                    <div>\n                      { error ? error.message : \"\"}\n                    </div>\n                </span>\n                <div>\n                  <span className={ style.centerSpan }>\n                    <div className=\"button circular\" title=\"Ok\" onClick={this.onErrorClose}>\n                        <FontAwesomeIcon icon={faCheck} />\n                    </div>\n                  </span>\n                </div>\n              </div>\n            </div>\n        </Modal>\n        <Modal isOpen={ showOptions } onRequestClose={this.cancelOptions} contentLabel=\"An Error has occurred\">\n          <div className={ style.modal }>\n            <div className={ style.modalMain }>\n              {options.action === IMPORT &&\n                <div className={style.uploadContainer}>\n                  <span className={style.label}>Upload</span>\n                  <DatasetUpload\n                    ownerUuid={uuidv4()}\n                    className={style.fileUpload}\n                    selected={this.state.selectedFile ? this.state.selectedFile.name : null}\n                    onChange={this.onUpload}\n                  />\n                </div>\n                }\n                {options.action === EXPORT &&\n                <div className={style.uploadContainer}>\n                  <span className={style.label}>Export As</span>\n                  <input\n                    type=\"text\"\n                    id=\"export-as\"\n                    value={this.state.exportName}\n                    onChange={(evt) => this.exportNameChange(evt.target.value)}\n                  />\n                </div>\n                }\n              <div className={style.container}>\n                <div className={`${style.checkboxContainer} input-group`}>\n                  <div className={ style.switch }>\n                    <input\n                      type=\"checkbox\"\n                      id=\"data-check\"\n                      checked={options.data}\n                      onChange={(evt) => this.setOptions(DATA, evt.target.checked)}\n                    />\n                    <label htmlFor=\"data-check\" className={ style.switchLabel }>\n                    </label>\n                  </div>\n                  <label >Data</label>\n                </div>\n                <div className={`${style.checkboxContainer} input-group`}>\n                  <div className={ style.switch }>\n                    <input\n                      type=\"checkbox\"\n                      id=\"controls-check\"\n                      checked={options.controls}\n                      onChange={(evt) => this.setOptions(CONTROLS, evt.target.checked)}\n                    />\n                    <label htmlFor=\"controls-check\" className={ style.switchLabel }>\n                    </label>\n                  </div>\n                  <label >Controls</label>\n                </div>\n              </div>\n              <div>\n                <span className={ style.centerSpan }>\n                  {options.action === IMPORT &&\n                    <div className=\"button circular\" title=\"Ok\" \n                         disabled={options.action === IMPORT && !this.state.selectedFile} \n                         onClick={this.processOptions}>\n                        <FontAwesomeIcon icon={faCheck} />\n                    </div>\n                  }\n                  {options.action === EXPORT &&\n                    <a className=\"button circular\" href={ this.getDownloadUrl() } download={ this.state.exportName }\n                      title=\"Download\" disabled={!hasDataset} onClick={this.cancelOptions} >\n                      <FontAwesomeIcon icon={faCheck} />\n                    </a>\n                  }\n                  <div className=\"button circular\" title=\"Cancel\" onClick={this.cancelOptions}>\n                      <FontAwesomeIcon icon={faTimes} />\n                  </div>\n                </span>\n              </div>\n            </div>\n          </div>\n        </Modal>\n        <div className={style.activityIndicatorContainer}>\n          <RingLoader\n            sizeUnit={\"px\"}\n            size={150}\n            color={'#0277BD'}\n            loading={this.props.shouldShowBusy}\n          />\n        </div>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  const datasets = selectDatasets(state);\n  const uuids = Object.keys(datasets).map(key => ({ 'owner': key, 'name': datasets[key].name, 'shortName': datasets[key].shortName })) \n                || [{ 'owner': uuidv4(), 'name': \"Series 0\", 'shortName': \"s0\" }];\n  const datasetCount = uuids.length;\n  const controls = selectControls(state);\n\n  return {\n    datasetCount: datasetCount,\n    darkTheme: controls.darkTheme,\n    error: getError(state),\n    lastUpdated: getLastUpdated(state, uuids[0]),\n    uuids: uuids,\n    startUuid: controls.start,\n    endUuid: controls.end,\n    fullDatasets: datasets,\n    controls: controls,\n    keyFields: getKeyFields(state),\n    ignoredFields: getIgnoredFields(state),\n    shouldShowBusy: controls.showBusy,\n  }\n}\n\nconst mapDispatchToProps = {\n  clearError,\n  setHierarchyConfig, \n  showNodes, \n  colorBy, \n  removeDataset,\n  removeSearchIndex,\n  setStartDataset,\n  setEndDataset,\n  uploadDataset,\n  showBusy,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App);\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import { createAction, handleActions } from \"redux-actions\";\nimport compileExpression from \"filtrex\";\n\nconst defaultState = {\n  filterString: \"\",\n  filter: null,\n  isValid: false\n};\n\n// ACTIONS\nconst setFilter = createAction(\"SET_FILTER\");\nconst clearFilter = createAction(\"CLEAR_FILTER\");\n\n// REDUCERS\nconst reducer = handleActions(\n  {\n    [setFilter]: (state, { payload }) => {\n\n\t  \tconst filterString = payload;\n\t  \tlet filter = null;\n\t  \tlet isValid = false;\n\t  \ttry\n\t  \t{\n\t  \t\tfilter = compileExpression(filterString);\n\t  \t\tisValid = true;\n\n\t  \t}\n\t  \tcatch(error)\n\t  \t{\n\t  \t\tfilter = null;\n\t  \t\tisValid = false;\n\n\t  \t}\n\t  \treturn { ...state, filterString, filter, isValid };\n\n    },\n    [clearFilter]: (state) => {\n     \tconst filterString = \"\";\n\t  \tlet filter = null;\n\t  \tlet isValid = false;\n      return { ...state, filterString, filter, isValid };\n    }\n  },\n  defaultState\n);\n\n// SELECTORS\nconst getFilter = (state) => state.filter.filter;\nconst filterIsValid = (state) => state.filter.isValid;\n\nexport default reducer;\n\nexport { setFilter, getFilter, clearFilter, filterIsValid};","import { combineReducers } from \"redux\";\nimport { searchReducer as search } from 'epics/index-dataset-epic'\nimport dataset from \"./dataset\";\nimport controls from \"./controls\";\nimport error from \"./error\";\nimport filter from \"./filter\";\n\nexport default combineReducers({\n  dataset,\n  search,\n  controls,\n  error,\n  filter\n});\n","import { createAction } from \"redux-actions\";\nimport { of, empty } from \"rxjs\";\nimport { mergeMap, map, tap, catchError } from 'rxjs/operators';\n\nimport { setError } from \"domain/error\"\nimport { getFilter } from \"domain/filter\"\nimport { setFilteredDataset } from \"domain/dataset\"\n\nconst filterDataset = createAction(\"FILTER_DATASET\");\n\nconst filterDatasetEpic = (action$, store) => {\n  return action$\n    .ofType(filterDataset.toString()).pipe(\n      mergeMap(({ payload}) => {\n        const filter = getFilter(store.value);\n\n        if(filter === null)\n          return empty();\n\n        return of(payload).pipe(\n            tap(applyFilter(payload, filter))\n            ,map((payload) =>\n              setFilteredDataset({\n                owner: payload.owner,\n                filtered: payload.filtered\n              })\n            )\n            ,catchError((error) => {\n               const newErr = new Error(\"Error filtering dataset: \" + error.message);\n               return of(setError(newErr));\n            })\n          );\n      })\n    );\n};\n\nconst applyFilter = (data, filter) => {\n  data.filtered = null;\n  const dataset = data.dataset;\n\n  if(filter !== null){\n    data.filtered = dataset.filter((item) => filter(item));\n  }\n\n  return data;\n};\n\nexport default filterDatasetEpic;\n\nexport { filterDataset };","import { combineEpics } from 'redux-observable';\nimport fetchDatasetEpic from './fetch-dataset-epic';\nimport uploadDatasetEpic from './upload-dataset-epic';\nimport loadDatasetEpic from './load-dataset-epic';\nimport searchDatasetEpic from './search-dataset-epic';\nimport indexDatasetEpic from './index-dataset-epic';\nimport refreshDatasetEpic from './refresh-dataset-epic';\nimport filterDatasetEpic from './filter-dataset-epic';\nimport diffDatasetEpic from './diff-dataset-epic';\n\nconst rootEpic = combineEpics(\n  loadDatasetEpic,\n  fetchDatasetEpic,\n  uploadDatasetEpic,\n  searchDatasetEpic,\n  indexDatasetEpic,\n  refreshDatasetEpic,\n  filterDatasetEpic,\n  diffDatasetEpic\n);\n\nexport default rootEpic;\n","import { createStore, applyMiddleware, compose } from \"redux\";\n\nimport { createEpicMiddleware } from 'redux-observable';\nimport rootReducer from './domain/root-reducer';\nimport rootEpic from './epics/root-epic';\n\n// Replace redux compose with redux-devtools compose if it exists\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\n\nconst configureStore = (initialState = {}) => {\n  const middleware = createEpicMiddleware()\n\n  const store = createStore(rootReducer,\n    initialState,\n    composeEnhancers(\n      applyMiddleware(middleware)\n    )\n  );\n\n  middleware.run(rootEpic);\n\n  return store;\n};\n\nexport default configureStore;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { Provider } from \"react-redux\";\n\nimport \"index.css\";\nimport App from \"./App\";\nimport registerServiceWorker from \"./registerServiceWorker\";\n\nimport configureStore from \"./configure-store\";\n\nconst store = configureStore();\n\nReactDOM.render(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.getElementById(\"root\")\n);\n\nregisterServiceWorker();\n\nif (module.hot) {\n  module.hot.accept(\"./App\", () => {\n    ReactDOM.render(\n      <Provider store={store}>\n        <App />\n      </Provider>,\n      document.getElementById(\"root\")\n    );\n  });\n}\n","import { createAction, handleActions } from \"redux-actions\";\n\nconst defaultState = {\n  error: null\n};\n\n// ACTIONS\nconst setError = createAction(\"SET_ERROR\");\nconst clearError = createAction(\"CLEAR_ERROR\");\n\n// REDUCERS\nconst reducer = handleActions(\n  {\n    [setError]: (state, { payload }) => {\n      if( payload instanceof Error )\n      {\n      \tconst error = payload;\n      \treturn { ...state, error };\n      }\n      return { ...state };\n    },\n    [clearError]: (state) => {\n      const error = null;\n      return { ...state, error };\n    }\n  },\n  defaultState\n);\n\n// SELECTORS\nconst getError = (state) => state.error.error;\n\n\nexport default reducer;\n\nexport { setError, getError, clearError};\n","import { ofType } from 'redux-observable';\nimport { isNil, isEmpty } from \"ramda\";\nimport { of } from \"rxjs\";\nimport { mergeMap, map } from 'rxjs/operators';\n\nimport { configurationFor } from \"domain/dataset\";\n\nconst lunr = require(\"lunr\");\n\nconst BUILD_INDICES = \"BUILD_INDICES\";\nconst BUILD_INDICES_SUCCESS = \"BUILD_INDICES_SUCCESS\";\nconst REMOVE_SEARCH_INDEX = \"REMOVE_SEARCH_INDEX\";\n//const BUILD_INDEX_FAILURE = \"BUILD_INDEX_FAILURE\";\nconst SET_SEARCH_RESULTS = \"SET_SEARCH_RESULTS\";\n\nconst buildIndices = (payload) => ({'type': BUILD_INDICES, 'payload': payload })\nconst buildIndicesSuccess = (payload) => ({'type': BUILD_INDICES_SUCCESS, 'payload': payload})\nconst removeSearchIndex = (payload) => ({'type': REMOVE_SEARCH_INDEX, 'payload': payload});\nconst setSearchResults = (payload) => ({'type': SET_SEARCH_RESULTS, 'payload': payload })\n\nconst getSearchResults = (state) => state.search.searchResults || [];\nconst getQueryString = (state) => state.search.queryString;\nconst getSearchIndex = (state, owner) => state.search.searchIndices[owner] || null;\nconst getSearchIndices = (state) => state.search.searchIndices || [];\n\nconst indexDatasetEpic = (action$, store) => {\n  return action$.pipe(\n      ofType(BUILD_INDICES)\n      ,mergeMap(({ payload }) => {\n        return of(payload).pipe(\n            map(generateIndex)\n            ,map((payload) =>\n              buildIndicesSuccess(payload)\n            )\n          );\n      })\n    );\n};\n\nconst searchReducer = (state = { searchIndices: {}, queryString: '', searchResults: null }, action) => {\n  switch (action.type) {\n    case BUILD_INDICES_SUCCESS:\n      action.payload.forEach((item) => {\n        state.searchIndices[item.owner] = item.index;\n      })\n      return {...state };\n    case \n    SET_SEARCH_RESULTS:\n      const searchResults = action.payload.results;\n      const queryString = action.payload.queryString;\n      return { ...state, searchResults, queryString};\n    case \n    REMOVE_SEARCH_INDEX:\n      const rsowner = action.payload.owner;\n      if(state.searchIndices.hasOwnProperty(rsowner))\n        delete state.searchIndices[rsowner];\n\n      return { ...state }\n    default:\n      return state;\n  }\n}\n\nconst flattenDataset = (ds, cfg) => {\n  var flattened = [];\n\n  if(isNil(cfg))\n    return flattened;\n\n  for(var key in ds){\n    var item = {'CRVIZ_SEARCH_KEY':ds[key].CRVIZ[\"_SEARCH_KEY\"]};\n    for(var f in cfg.fields){\n      var field = cfg.fields[f];\n\n      var name = field.displayName.toLowerCase();\n      item[name] = getValueByPath(ds[key], field.path);\n    }\n    flattened.push(item);\n  }\n  return flattened;\n}\n\nconst generateIndex = (payload) => {\n  let indices = [];\n  Object.keys(payload.datasets).forEach((owner) => {\n    const dataset = payload.datasets[owner].dataset;\n    const configuration =  !isNil(payload.datasets[owner].configuration) && !isEmpty(payload.datasets[owner].configuration) \n                        ? payload.datasets[owner].configuration : configurationFor(dataset);\n    var flat = flattenDataset(dataset, configuration);\n    const idx = lunr(function () {\n      this.ref('CRVIZ_SEARCH_KEY');\n      if(configuration && configuration.fields){\n        const filteredFields = configuration.fields.filter(f => !f.displayName.includes(\"/\"))\n        filteredFields.map((field) => { return this.field(field.displayName.toLowerCase()); })\n      }\n      flat.map((item) => { return this.add(item); })\n    });\n\n    indices.push({ owner: owner, index: idx })\n  })\n  \n  return indices;\n};\n\nconst getValueByPath = (object, path) => {\n  if(object && path.length > 0){\n    let current = object[path[0]];\n    for(var i = 1; i < path.length; i++){\n      current = current[path[i]]\n    }\n    return current;\n  }\n  else{\n    return null;\n  }\n}\n\nexport default indexDatasetEpic;\n\nexport { buildIndices, searchReducer,  getSearchIndex, removeSearchIndex, getSearchIndices, setSearchResults, getSearchResults, getQueryString };\n","import { createAction, handleActions } from \"redux-actions\";\nimport {\n  chain,\n  concat,\n  find,\n  fromPairs,\n  identity,\n  is,\n  map,\n  merge,\n  path,\n  pipe,\n  propEq,\n  sortBy,\n  toPairs,\n  uniq,\n  //memoizeWith,\n} from \"ramda\";\n\nconst defaultState = {\n  datasets: {},\n  diffs:[],\n  keyFields: [],\n  ignoredFields: []\n};\nconst defaultItemState = {\n  owner: \"\",\n  source: null,\n  name: \"\",\n  shortName: \"\",\n  dataset: [],\n  keyCount: 0,\n  uniqueKeyCount: 0,\n  filtered: null,\n  values: {},\n  configuration: {\n    fields: [],\n    keyFields: [],\n    hashFields: []\n  },\n  isFetching: false,\n  lastUpdated: null,\n};\n\nconst getHashFields = (allFields, ignoredFields) => {\n  if(!ignoredFields || ignoredFields.length === 0){\n    return allFields;\n  }\n\n  return allFields.filter(f => !ignoredFields.includes(f));\n}\n\nconst addHashKey = (keys, obj) => {\n  const hashKey = keys.reduce( (h, k) => h + path(k.path, obj) + \":\", \"\");\n  obj.CRVIZ[\"_HASH_KEY\"] = hashKey;\n}\n\nconst addHashWithoutIgnored = (fields, obj) => {\n  const hash = fields.reduce( (h, f) => h + path(f.path, obj) + \"|\", \"\");\n  obj.CRVIZ[\"_HASH_WITHOUT_IGNORED\"] = hash;\n}\n\nconst addSearchKey = (keys, obj) => {\n  const searchKey = keys.reduce( (h, k) => h + path(k.path, obj) + \":\", \"\");\n  obj.CRVIZ[\"_SEARCH_KEY\"] = searchKey;\n}\n\nconst applyHashes = (dataset, configuration) => {\n  const keys = [];\n  dataset.forEach((i) => {\n    if(!('CRVIZ' in i)){\n      i['CRVIZ'] = {};\n    }\n    if(!configuration.hashFields){\n      configuration.hashFields = getHashFields(configuration.fields, configuration.ignoredFields || []);\n    }\n\n    addHashKey(Array.isArray(configuration.keyFields) && configuration.keyFields.length > 0 ? configuration.keyFields : configuration.hashFields, i);\n    addHashWithoutIgnored(configuration.hashFields, i);\n    addSearchKey(configuration.fields, i);\n    keys.push(i.CRVIZ._HASH_KEY);\n  });\n  const uniqueKeys = Array.from(new Set(keys));\n  return {keyCount: keys.length, uniqueKeyCount:uniqueKeys.length}\n};\n\n/**\n * Return a string that uniquely identify the field\n */\nconst getFieldId = (field) => {\n  if(field.path.length >= 1 && field.path[0])\n    return field.path.join(\".\")\n  else\n    return \" \";\n}\n\n/**\n * Returns an array of paths to literal values and arrays in a POJO.\n *\n * Example:\n * pathsIn({ a: 'A', b: { c: 'C', d: [1, 2] } }) //=> [['a'], ['b', 'c'], ['b', 'd']]\n */\nconst pathsIn = (obj) =>\n  chain(\n    ([key, value]) =>\n      is(Object, value) ? map(concat([key]), pathsIn(value)) : [[key]],\n    toPairs(obj)\n  );\n\n/**\n * Return all fields for an object\n */\nconst fieldsFor = (obj, overrides = []) => {\n  const paths = pathsIn(obj).filter(p => p[0] !== 'CRVIZ');\n  return map((path) => {\n    const override = find(propEq('path', path), overrides) || {};\n    return merge(\n      {\n        path: path,\n        displayName: path.join('.'),\n        groupable: true\n      },\n      override\n    )\n  }, paths);\n\n  // var fields = difference(pathsIn(obj), map(prop('path'), overrides));\n  // return [\n  //   ...overrid,\n  //   ...map(\n  //     (path) => ({\n  //       path: path,\n  //       displayName: path.join(\".\"),\n  //       groupable: true\n  //     }),\n  //     unspecified\n  //   )\n  // ];\n};\n\n/**\n * Returns a configuration with any missing items populated\n */\nconst configurationFor = (dataset, keyFields, ignoredFields, configuration = {}) => {\n  const fields = fieldsFor(dataset[0] || {}, configuration.fields);\n  const hashFields = getHashFields(fields, ignoredFields);\n  return {\n    ...configuration,\n    fields: fieldsFor(dataset[0] || {}, configuration.fields),\n    keyFields: keyFields,\n    hashFields: hashFields\n  };\n};\n\n\nconst valuesFor = (dataset, configuration) => {\n  return fromPairs(map((field) => {\n    const values = pipe(\n      map(path(field.path)),\n      uniq,\n      sortBy(identity)\n    )(dataset);\n\n    return [getFieldId(field), values];\n  }, configuration.fields));\n};\n\nconst configureDataset = (dataset, source, name, shortName, initialConfig, keyFields, ignoredFields) => {\n  const configuration = configurationFor(\n    dataset || [],\n    keyFields,\n    ignoredFields,\n    initialConfig || {}\n  );\n  const { keyCount, uniqueKeyCount } = applyHashes(dataset, configuration);\n\n  const values = valuesFor(dataset, configuration);\n  const isFetching = false;\n  const lastUpdated = new Date();\n  return {\n    dataset: dataset,\n    source: source,\n    name: name,\n    shortName: shortName,\n    keyCount: keyCount,\n    uniqueKeyCount: uniqueKeyCount,\n    filtered: null,\n    values: values,\n    configuration: configuration,\n    isFetching: isFetching,\n    lastUpdated: lastUpdated\n  }\n}\n\n// ACTIONS\n\n/**\n * Payload: {\n *   dataset: [], // Array of devices\n *   configuration: {} // Configuration\n * }\n*/\nconst setDatasets = createAction(\"SET_DATASETS\");\nconst setDataset = createAction(\"SET_DATASET\");\nconst setFilteredDataset = createAction(\"SET_FILTERED_DATASET\");\nconst setDatasetDiff = createAction(\"SET_DATASET_DIFF\");\nconst removeDataset = createAction(\"REMOVE_DATASET\");\nconst removeFilteredDataset = createAction(\"REMOVE_FILTERED_DATASET\");\nconst removeDatasetDiff = createAction(\"REMOVE_DATASET_DIFF\");\nconst setIsFetching = createAction(\"SET_IS_FETCHING\");\nconst setKeyFields = createAction(\"SET_KEY_FIELDS\");\nconst setIgnoredFields = createAction(\"SET_IGNORED_FIELDS\");\n\n// REDUCERS\nconst reducer = handleActions(\n  {\n    [setDatasets]: (state, { payload }) => {\n      const datasets = payload.datasets;\n      Object.keys(datasets).forEach((key) => {\n        state.datasets[key] = datasets[key];\n      })\n      \n      return { ...state};\n    },\n    [setDataset]: (state, { payload }) => {\n      const dataset = payload.dataset;\n      const owner = payload.owner;\n      const source = payload.source;\n      const name = payload.name;\n      const shortName = payload.shortName;\n      const initialConfig = payload.configuration;\n      const keyFields = getKeyFields(state);\n      const ignoredFields = getIgnoredFields(state);\n      state.datasets[owner] = configureDataset(dataset, source, name, shortName, initialConfig, keyFields, ignoredFields);\n      return { ...state};\n    },\n    [setFilteredDataset]: (state, { payload }) => {\n      const filtered = payload.filtered;\n      const owner = payload.owner;\n\n      state.datasets[owner].filtered = filtered;\n      return { ...state};\n    },\n    [setDatasetDiff]: (state, { payload }) => {\n      const start = payload.start;\n      const end = payload.end;\n      const differences = payload.differences\n      const newDiff = {\n        'start': start,\n        'end': end,\n        'differences': differences\n      }\n\n      const idx = state.diffs.findIndex(d => d.start === start && d.end === end);\n\n      if(idx === -1){\n        state.diffs.push(newDiff);\n      } else {\n        state.diffs[idx] = newDiff;\n      }\n      return { ...state};\n    },\n    [removeDataset]: (state, { payload }) => {\n      const owner = payload.owner;\n      if(state.datasets.hasOwnProperty(owner))\n        delete state.datasets[owner];\n\n      return { ...state }\n    },\n    [removeFilteredDataset]: (state, { payload }) => {\n      const owner = payload.owner;\n      if(state.datasets.hasOwnProperty(owner))\n        state.datasets[owner].filtered = null;\n\n      return { ...state }\n    },\n    [removeDatasetDiff]: (state, { payload }) => {\n      const start = payload.start;\n      const end = payload.end;\n      const idx = state.diffs.findIndex(d => d.start === start && d.end === end);\n\n      if(idx !== -1){\n        state.diffs.splice(idx, 1);\n      }\n\n      return { ...state }\n    },\n    [setIsFetching]: (state, { payload }) => {\n      const owner = payload.owner;\n      const isFetching = !!payload.isFetching;\n      if(state.datasets.hasOwnProperty(owner))\n        state.datasets[owner].isFetching = isFetching;\n      return { ...state, isFetching};\n    },\n    [setKeyFields]: (state, { payload }) => { \n      const keyFields = payload ? payload : state.keyFields;\n      const datasets = _selectDatasets(state);\n      if(datasets){\n        Object.keys(datasets).forEach((key) => {\n          const ds = datasets[key];\n          ds.configuration.keyFields = keyFields;\n          const { keyCount, uniqueKeyCount } = applyHashes(ds.dataset, ds.configuration);\n          ds.keyCount = keyCount;\n          ds.uniqueKeyCount = uniqueKeyCount;\n        });\n      }\n\n      return {...state, keyFields: keyFields };\n    },\n    [setIgnoredFields]: (state, { payload }) => {\n      const ignoredFields = payload ? payload : state.ignoredFields;\n      const datasets = _selectDatasets(state);\n\n      if(datasets && ignoredFields){\n        const allFields = _selectMergedConfiguration(state).fields;\n        const hashFields = getHashFields(allFields, ignoredFields);\n\n        Object.keys(datasets).forEach((key) => {\n          const ds = datasets[key];    \n          ds.configuration.hashFields = hashFields\n          const { keyCount, uniqueKeyCount } = applyHashes(ds.dataset, ds.configuration);\n          ds.keyCount = keyCount;\n          ds.uniqueKeyCount = uniqueKeyCount;\n        });\n      }\n\n      return { ...state, ignoredFields: ignoredFields };\n    }\n  },\n  defaultState\n);\n\n//methods where we need to deal with state both inside and outside of the reducer\n//outside of the reducer state represents the entire state tree, but inside of the\n//reducer the provided state is only the state for the reducer's subset of the \n//state tree.  to avoid duplication of code these methods will be called be used\n//internally from the reducer.  and methods that recieve the full state tree will \n//pare the tree down to just the relevant attributes. in these cases the\n//variable \"dataset\" will represent the segment of the state tree owned by the datset reducer.\nconst _selectDatasets = (dataset) => {\n  return dataset.datasets || {};\n}\nconst _selectMergedConfiguration = (dataset) => {\n  let fields = [];\n  const ds = dataset.datasets;\n  for (var key in ds){\n    for (var f of ds[key].configuration.fields){ \n      // eslint-disable-next-line no-loop-func\n      if(!fields.some(field => field.displayName === f.displayName)){\n        fields.push(f);\n      }\n    }\n  }\n\n  return { fields: fields };\n}\n\n// SELECTORS\nconst selectDatasets = (state) => {\n  return _selectDatasets(state.dataset);\n}\nconst selectDataset = (state, owner) => state.dataset && state.dataset.datasets[owner] && state.dataset.datasets[owner].dataset ? state.dataset.datasets[owner].dataset : defaultItemState.dataset;\nconst selectFilteredDataset = (state, owner) => state.dataset && state.dataset.datasets[owner] && state.dataset.datasets[owner].filtered ? state.dataset.datasets[owner].filtered : defaultItemState.filtered;\nconst selectDatasetDiff = (state, start, end) => {\n  let diff = null;\n  const idx = state.dataset.diffs.findIndex(d => d.start === start && d.end === end);\n  if(idx !== -1){\n    diff = state.dataset.diffs[idx].differences;;\n  }\n  return diff;\n}\nconst selectConfiguration = (state, owner) => state.dataset && state.dataset.datasets[owner] && state.dataset.datasets[owner].configuration ? state.dataset.datasets[owner].configuration : defaultItemState.configuration;\nconst selectMergedConfiguration = (state) => {\n  return _selectMergedConfiguration(state.dataset)\n}\nconst selectValues = (state, owner) => state.dataset && state.dataset.datasets[owner] && state.dataset.datasets[owner].values ? state.dataset.datasets[owner].values : defaultItemState.values;\nconst selectMergedValues = (state) => {\n  let vals = {};\n  const ds = state.dataset.datasets;\n  for (var key in ds){\n    for (var v in ds[key].values){\n      if(vals.hasOwnProperty(v)){\n        const valSet = new Set([...vals[v], ...ds[key].values[v]]);\n        vals[v] = [...valSet];\n      }\n      else {\n        vals[v] = ds[key].values[v];\n      }\n    }\n  }\n\n  return vals;\n}\nconst getIsFetching = (state, owner) => state.dataset.datasets[owner] && state.dataset.datasets[owner].isFetching ? state.dataset.datasets[owner].isFetching : defaultItemState.isFetching;\nconst getLastUpdated = (state, owner) => state.dataset.datasets[owner] && state.dataset.datasets[owner].lastUpdated ? state.dataset.datasets[owner].lastUpdated : defaultItemState.lastUpdated;\nconst getKeyFields = (state) => state.dataset && state.dataset.keyFields ? state.dataset.keyFields : [];\nconst getIgnoredFields = (state) => state.dataset && state.dataset.ignoredFields ? state.dataset.ignoredFields : [];\n\n// const memoizeKey = (state, startOwner, endOwner) => {\n//   const startUpdated = state.dataset && state.dataset.datasets[startOwner] ? state.dataset.datasets[startOwner].lastUpdated : \"NotUpdated\";\n//   const endUpdated = state.dataset && state.dataset.datasets[endOwner] ? state.dataset.datasets[endOwner].lastUpdated : \"NotUpdated\";\n//   return startOwner+\":\"+startUpdated+\"-\"+endOwner+\":\"+endUpdated\n// };\n\nconst selectDatasetIntersection = (state, startOwner, endOwner) => {\n  let ds = [];\n  const start = selectDataset(state, startOwner);\n  const end = selectDataset(state, endOwner);\n  \n  if(start.length > 0 && end.length === 0){\n    start.forEach((s) => {\n      s.CRVIZ._isRemoved = false;\n      s.CRVIZ._isChanged = false;\n      s.CRVIZ._isAdded = false;\n    });\n    ds = start;\n  } else if(start.length === 0 && end.length > 0){\n    end.forEach((e) => {\n      e.CRVIZ._isRemoved = false;\n      e.CRVIZ._isChanged = false;\n      e.CRVIZ._isAdded = false;\n    });\n    ds = end;\n  } else if(start.length > 0 && end.length > 0) {\n    start.forEach((s) => {\n      s.CRVIZ._isRemoved = false;\n      s.CRVIZ._isChanged = false;\n      s.CRVIZ._isAdded = false;\n\n      const idx = end.findIndex(e => e.CRVIZ._HASH_KEY === s.CRVIZ._HASH_KEY);\n      if(idx === -1){\n        s.CRVIZ._isRemoved = true;\n      } else {\n        s.CRVIZ._isRemoved = false;\n      }\n      s.CRVIZ._isChanged = false;\n      s.CRVIZ._isAdded = false;\n      ds.push(s);\n    });\n    end.forEach((e) => {\n      e.CRVIZ._isRemoved = false;\n      e.CRVIZ._isChanged = false;\n      e.CRVIZ._isAdded = false;\n      const idx = ds.findIndex(i => i.CRVIZ._HASH_KEY === e.CRVIZ._HASH_KEY);\n      if(idx === -1){\n        e.CRVIZ._isAdded = true;\n        ds.push(e);\n      } else if(ds[idx].CRVIZ._HASH_WITHOUT_IGNORED !== e.CRVIZ._HASH_WITHOUT_IGNORED){\n        ds[idx].CRVIZ._isChanged = true;\n      }\n    })\n  }\n  return ds;\n};\n\n\nexport default reducer;\n\nexport { setDatasets, setDataset, selectDataset, selectDatasets, removeDataset, setFilteredDataset, selectFilteredDataset, removeFilteredDataset, selectConfiguration, selectMergedConfiguration,\n  selectValues, selectMergedValues, getFieldId, configurationFor, setIsFetching, getIsFetching, setKeyFields, getKeyFields, setIgnoredFields, getIgnoredFields, getHashFields, getLastUpdated, \n  valuesFor, setDatasetDiff, removeDatasetDiff, selectDatasetDiff, selectDatasetIntersection, applyHashes, configureDataset };\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"appContainer\":\"App_appContainer__3jRx1\",\"controls\":\"App_controls__14oJX\",\"section\":\"App_section__1OL6S\",\"footerContainer\":\"App_footerContainer__3ckfD\",\"dimSection\":\"App_dimSection__2KXnV\",\"hierarchySection\":\"App_hierarchySection__20JSE\",\"canvas\":\"App_canvas__1KgDx\",\"sliderContainer\":\"App_sliderContainer__14eTy\",\"hideControls\":\"App_hideControls__3-JKB\",\"modal\":\"App_modal__Ayqb5\",\"modalMain\":\"App_modalMain__2seCW\",\"justifySpan\":\"App_justifySpan__39F6d\",\"icon\":\"App_icon__NYH35\",\"centerSpan\":\"App_centerSpan__-rZ5_\",\"accordionHeader\":\"App_accordionHeader__3Xi4Q\",\"hidden\":\"App_hidden__3ofBD\",\"emptyDataset\":\"App_emptyDataset__29FeM\",\"label\":\"App_label__v_mMj\",\"selectorContainer\":\"App_selectorContainer__39_GX\",\"selector\":\"App_selector__2sCEs\",\"checkboxContainer\":\"App_checkboxContainer__1fO1K\",\"switch\":\"App_switch__2FvpM\",\"switchLabel\":\"App_switchLabel__2JZ5u\",\"switch-inner\":\"App_switch-inner__ANiwX\",\"uploadContainer\":\"App_uploadContainer__342xp\",\"fileUpload\":\"App_fileUpload__3f4jm\",\"activityIndicatorContainer\":\"App_activityIndicatorContainer__NjOjQ\",\"key\":\"App_key__3Uk0T\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"checkboxContainer\":\"MiscControls_checkboxContainer__3kBR3\",\"colorBy\":\"MiscControls_colorBy__2SU5V\",\"fieldSelect\":\"MiscControls_fieldSelect__38svo\",\"switch\":\"MiscControls_switch__3UP8J\",\"switchLabel\":\"MiscControls_switchLabel__3eKc8\",\"switch-inner\":\"MiscControls_switch-inner__3WhMh\",\"selectorContainer\":\"MiscControls_selectorContainer__3qDfQ\",\"selector\":\"MiscControls_selector__1nfTG\"};","import { createAction } from 'redux-actions';\nimport { ofType } from 'redux-observable';\nimport { of } from 'rxjs';\nimport { ajax  as rxAjax } from 'rxjs/ajax';\nimport { catchError, debounceTime, mergeMap, map } from 'rxjs/operators';\n\nimport { setError } from \"domain/error\";\nimport { loadDataset } from './load-dataset-epic';\n\n// ACTIONS\nconst fetchDataset = createAction('FETCH_DATASET');\n\n// EPIC\nconst fetchDatasetEpic = (action$, store, ajax = rxAjax) => {\n  return action$.pipe(\n    ofType(fetchDataset.toString())\n    ,debounceTime(500)\n    ,mergeMap((action) => {\n      const owner = action.payload.owner;\n      const name = action.payload.name;\n      const shortName = action.payload.shortName;\n      const url = action.payload.url;\n      const header = action.payload.header;\n      return ajax({ 'url': url, 'headers':header, 'crossDomain': true, 'responseType': 'json' }).pipe(\n        map((result) => { \n          return { 'owner': owner, 'name': name, 'shortName': shortName, 'source': url, 'content': result.response };\n        })\n        ,map(loadDataset)\n        // I believe this was done oddly and debounce should have been used\n        // to ensure that file input was only processed once, instead of using take until\n        // which seems to be stopping the epic the second time the action passes through the stream\n        // it seems like this change doesn't change functionality and makes unit testing easier\n        // I intend to do more thorough user testing later\n        //.takeUntil(action$.ofType(fetchDataset.toString()))\n        \n      );\n    })\n    ,catchError((error) => {\n      const newErr = new Error(\"Error fetching dataset: \" + error.message);\n      return of(setError(newErr));\n    })\n  );\n}\n\nconst getScheme = (username, password, token) =>{\n   let scheme = 'None';\n    if(token) {\n      scheme = 'Bearer'\n    } else if (username && password) {\n      scheme = 'Basic'\n    }\n    return scheme;\n}\n\nconst buildAuthHeader = (username, password, token) => {\n  let header = null;\n  var scheme = getScheme(username, password, token);\n\n  switch (scheme){\n    case 'Basic':\n       var basic = \"Basic \" + new Buffer(`${username}:${password}`).toString(\"base64\");\n       header = {'Authorization' : basic};\n      break;\n    case 'Bearer':\n      var bearer = `Bearer ${token}`;\n      header = {'Authorization' : bearer};\n      break;\n    default:\n      header = null;\n      break;\n  }\n  \n  return header;\n}\n\nexport default fetchDatasetEpic;\nexport { fetchDataset, buildAuthHeader };\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"listContainer\":\"SelectedFieldList_listContainer__1A-lJ\",\"isDropDisabled\":\"SelectedFieldList_isDropDisabled__2vQFW\",\"droppable\":\"SelectedFieldList_droppable__2zu_b\",\"draggable\":\"SelectedFieldList_draggable__2Cp8c\",\"field\":\"SelectedFieldList_field__ZLF6f\",\"groupBy\":\"SelectedFieldList_groupBy__2sKtj\",\"animated\":\"SelectedFieldList_animated__39CvG\",\"groupByEnter\":\"SelectedFieldList_groupByEnter__1cLtw\",\"fieldName\":\"SelectedFieldList_fieldName__2G9oT\",\"dropTarget\":\"SelectedFieldList_dropTarget__1J9ME\",\"isDraggingOver\":\"SelectedFieldList_isDraggingOver__1k_Dr\",\"dragHandle\":\"SelectedFieldList_dragHandle__2NjEJ\"};","import { createAction } from \"redux-actions\";\nimport { ofType } from 'redux-observable';\nimport { of } from \"rxjs\";\nimport { map, mergeMap, catchError } from 'rxjs/operators';\nimport { isNil, is } from \"ramda\";\n\nimport { buildIndices } from './index-dataset-epic';\n\nimport { setError } from \"domain/error\"\nimport { setDatasets, setKeyFields, setIgnoredFields, configureDataset } from \"domain/dataset\";\nimport { setControls, showBusy } from \"domain/controls\";\n\nconst loadDataset = createAction(\"LOAD_DATASET\");\n\nconst loadDatasetEpic = (action$, store) => {\n  return action$.pipe(\n    ofType(loadDataset.toString())\n    ,mergeMap(({ payload }) => {\n      return of(payload).pipe(\n        map(formatPayload)\n        ,mergeMap((payload) => {\n          return of(\n            setDatasets(payload)\n            ,setKeyFields(payload.keyFields)\n            ,setIgnoredFields(payload.ignoredFields)\n            ,setControls(payload.controls)\n            ,buildIndices(payload)\n            ,showBusy(false)\n          )\n        })\n        ,catchError((error) => {\n          if (is(ValidationError, error)) {\n            return of(setError(error));\n          } else {\n            /* istanbul ignore next */\n            throw error;\n          }\n        })\n      );\n    })\n  );\n}; \n\n// doesn't really care if it's not CSV; if it *is* CSV, convert to JSON.\n// Otherwise, just pass it along.\nconst CSVconvert = (data) => {\n  const owner = data.owner;\n  const source = data.source;\n\n  var lines = data.file.trim().split(/[\\r\\n]+/g);\n  if (lines.length < 2) { // bail if there's not even linebreaks\n    return data;\n  }\n\n  function finddelim(hdr) {\n    var delims = [',','|','\\t',';']\n    var delim = 0\n    var max = -1\n    for (var i=0; i < hdr.length; i++) {\n      if (max < hdr.split(delims[i]).length-1) {\n        max = hdr.split(delims[i]).length-1\n        delim = i\n      }\n    }\n    return delims[delim];\n  }\n\n  var delimiter = finddelim(lines[0])\n  var jsonstring = '['\n  var colnames = lines[0].split(delimiter)\n  for (var i=1; i < lines.length; i++) {\n    var entry = lines[i].split(delimiter)\n    if (entry.length !== colnames.length) { // malformed CSV, or not even CSV.\n      return data;\n    }\n    jsonstring += \"{ \"\n    for (var j=0; j < colnames.length; j++) {\n      jsonstring += '\"'+colnames[j]+'\": \"'+entry[j]+'\"';\n      if (j < colnames.length-1 ) {\n        jsonstring += \", \"\n      } else {\n        jsonstring += \" }\"\n        if (i < lines.length-1) {\n          jsonstring += \",\\n\"\n        }\n      }\n    }\n  }\n  jsonstring += ']'\n  return { 'owner': owner, 'source': source, 'file': jsonstring };\n}\n\n//if we have a naked array or an object not containing a dataset instead of an object containing a dataset\n//transfer the array into an object's dataset to maintain a consistent\n//schema with what is used elsewhere see https://github.com/CyberReboot/CRviz/issues/33\nconst formatPayload = (data) => {\n  const owner = data.owner;\n  const initialName = data.name;\n  const initialShortName = data.shortName;\n  const source = data.source;\n  const content = data.content;\n  const datasets = content.datasets;\n  const keyFields = content.keyFields || null;\n  const ignoredFields = content.ignoredFields || null;\n  const controls = content.controls || {};\n  const includeData = ('includeData' in data) ? data.includeData : true;\n  const includeControls = ('includeControls' in data) ? data.includeControls : false;\n\n  var final = {};\n\n  if(datasets){\n    final =  datasets;\n  } else if(!isNil(content.dataset) && is(Array, content.dataset)){\n    final[owner] = { 'dataset': content.dataset };\n    if(content.configuration){\n      final[owner].configuration = content.configuration;\n    }\n  } else if(isNil(content.dataset) && is(Array, content)) {\n    final[owner] = { 'dataset': content };\n  } else if(isNil(content.dataset)) {\n    let obj = {};\n    Object.entries(content).forEach( (entry) =>{\n      let key = entry[0];\n      let value = entry[1]\n      obj[key] = value;\n      })\n    final[owner] = { 'dataset': [obj] };\n  } else {\n    throw ValidationError('Data in invalid format');\n  }\n  const keys = Object.keys(final);\n  keys.forEach((owner, idx) =>{\n    const dataset = final[owner].dataset;\n    const name = dataset.name || initialName || \"Series \" + idx;\n    const shortName = dataset.shortName || initialShortName || name.substr(0, 1) + idx;\n    const initialConfig = final[owner].configuration;\n    final[owner] =  configureDataset(dataset, source, name, shortName, initialConfig, keyFields, ignoredFields);\n  })\n\n  data = { \n          'datasets': includeData ? final : {},\n          'keyFields': includeData ? keyFields : [],\n          'ignoredFields': includeData ? ignoredFields : [],\n          'controls': includeControls ? controls : {}\n        };\n  return data;\n};\n\nfunction ValidationError(message) {\n  this.name = 'ValidationError';\n  this.message = message;\n}\n\nValidationError.prototype = Object.create(Error.prototype);\n\nexport default loadDatasetEpic;\n\nexport { loadDataset, CSVconvert };\n"],"sourceRoot":""}